!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("vtk.js/Sources/macro"),require("react"),require("vtk.js/Sources/Rendering/Core/Coordinate"),require("vtk.js/Sources/Common/Core/Math"),require("vtk.js/Sources/Rendering/Core/InteractorStyle/Constants"),require("cornerstone-core"),require("vtk.js/Sources/Rendering/Core/ImageMapper"),require("vtk.js/Sources/Common/Core/MatrixBuilder"),require("vtk.js/Sources/Rendering/Misc/GenericRenderWindow"),require("vtk.js/Sources/Widgets/Core/WidgetManager"),require("vtk.js/Sources/Interaction/Style/InteractorStyleImage"),require("vtk.js/Sources/Interaction/Style/InteractorStyleTrackballCamera"),require("cornerstone-tools"),require("vtk.js/Sources/Rendering/Core/Mapper"),require("vtk.js/Sources/Rendering/Core/Actor"),require("vtk.js/Sources/Filters/General/PaintFilter"),require("vtk.js/Sources/Widgets/Widgets3D/PaintWidget"),require("vtk.js/Sources/Widgets/Core/WidgetManager/Constants"),require("vtk.js/Sources/Common/DataModel/ImageData"),require("vtk.js/Sources/Common/Core/DataArray"),require("vtk.js/Sources/Common/DataModel/BoundingBox"),require("vtk.js/Sources/Filters/Sources/LineSource"),require("vtk.js/Sources/Rendering/Core/Renderer"),require("vtk.js/Sources/Interaction/Widgets/OrientationMarkerWidget"),require("vtk.js/Sources/Interaction/Style/InteractorStyleManipulator"),require("vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballRotateManipulator"),require("vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballPanManipulator"),require("vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballZoomManipulator"),require("vtk.js/Sources/Interaction/Manipulators/MouseRangeManipulator"),require("vtk.js/Sources/Rendering/Core/Volume"),require("vtk.js/Sources/Rendering/Core/VolumeMapper"),require("vtk.js/Sources/Rendering/Core/ColorTransferFunction"),require("vtk.js/Sources/Common/DataModel/PiecewiseFunction"),require("vtk.js/Sources/Filters/Core/Cutter"),require("vtk.js/Sources/Common/DataModel/Plane"),require("vtk.js/Sources/Rendering/Core/Property"),require("vtk.js/Sources/Rendering/Core/AnnotatedCubeActor"),require("vtk.js/Sources/Widgets/Manipulators/PlaneManipulator"),require("vtk.js/Sources/Rendering/OpenGL/HardwareSelector"),require("vtk.js/Sources/Filters/General/TubeFilter"),require("vtk.js/Sources/Common/Core/CellArray"),require("vtk.js/Sources/Common/DataModel/PolyData"),require("vtk.js/Sources/Common/Core/Points"),require("vtk.js/Sources/Rendering/Core/PointPicker")):"function"==typeof define&&define.amd?define(["vtk.js/Sources/macro","react","vtk.js/Sources/Rendering/Core/Coordinate","vtk.js/Sources/Common/Core/Math","vtk.js/Sources/Rendering/Core/InteractorStyle/Constants","cornerstone-core","vtk.js/Sources/Rendering/Core/ImageMapper","vtk.js/Sources/Common/Core/MatrixBuilder","vtk.js/Sources/Rendering/Misc/GenericRenderWindow","vtk.js/Sources/Widgets/Core/WidgetManager","vtk.js/Sources/Interaction/Style/InteractorStyleImage","vtk.js/Sources/Interaction/Style/InteractorStyleTrackballCamera","cornerstone-tools","vtk.js/Sources/Rendering/Core/Mapper","vtk.js/Sources/Rendering/Core/Actor","vtk.js/Sources/Filters/General/PaintFilter","vtk.js/Sources/Widgets/Widgets3D/PaintWidget","vtk.js/Sources/Widgets/Core/WidgetManager/Constants","vtk.js/Sources/Common/DataModel/ImageData","vtk.js/Sources/Common/Core/DataArray","vtk.js/Sources/Common/DataModel/BoundingBox","vtk.js/Sources/Filters/Sources/LineSource","vtk.js/Sources/Rendering/Core/Renderer","vtk.js/Sources/Interaction/Widgets/OrientationMarkerWidget","vtk.js/Sources/Interaction/Style/InteractorStyleManipulator","vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballRotateManipulator","vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballPanManipulator","vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballZoomManipulator","vtk.js/Sources/Interaction/Manipulators/MouseRangeManipulator","vtk.js/Sources/Rendering/Core/Volume","vtk.js/Sources/Rendering/Core/VolumeMapper","vtk.js/Sources/Rendering/Core/ColorTransferFunction","vtk.js/Sources/Common/DataModel/PiecewiseFunction","vtk.js/Sources/Filters/Core/Cutter","vtk.js/Sources/Common/DataModel/Plane","vtk.js/Sources/Rendering/Core/Property","vtk.js/Sources/Rendering/Core/AnnotatedCubeActor","vtk.js/Sources/Widgets/Manipulators/PlaneManipulator","vtk.js/Sources/Rendering/OpenGL/HardwareSelector","vtk.js/Sources/Filters/General/TubeFilter","vtk.js/Sources/Common/Core/CellArray","vtk.js/Sources/Common/DataModel/PolyData","vtk.js/Sources/Common/Core/Points","vtk.js/Sources/Rendering/Core/PointPicker"],t):"object"==typeof exports?exports.VTKViewport=t(require("vtk.js/Sources/macro"),require("react"),require("vtk.js/Sources/Rendering/Core/Coordinate"),require("vtk.js/Sources/Common/Core/Math"),require("vtk.js/Sources/Rendering/Core/InteractorStyle/Constants"),require("cornerstone-core"),require("vtk.js/Sources/Rendering/Core/ImageMapper"),require("vtk.js/Sources/Common/Core/MatrixBuilder"),require("vtk.js/Sources/Rendering/Misc/GenericRenderWindow"),require("vtk.js/Sources/Widgets/Core/WidgetManager"),require("vtk.js/Sources/Interaction/Style/InteractorStyleImage"),require("vtk.js/Sources/Interaction/Style/InteractorStyleTrackballCamera"),require("cornerstone-tools"),require("vtk.js/Sources/Rendering/Core/Mapper"),require("vtk.js/Sources/Rendering/Core/Actor"),require("vtk.js/Sources/Filters/General/PaintFilter"),require("vtk.js/Sources/Widgets/Widgets3D/PaintWidget"),require("vtk.js/Sources/Widgets/Core/WidgetManager/Constants"),require("vtk.js/Sources/Common/DataModel/ImageData"),require("vtk.js/Sources/Common/Core/DataArray"),require("vtk.js/Sources/Common/DataModel/BoundingBox"),require("vtk.js/Sources/Filters/Sources/LineSource"),require("vtk.js/Sources/Rendering/Core/Renderer"),require("vtk.js/Sources/Interaction/Widgets/OrientationMarkerWidget"),require("vtk.js/Sources/Interaction/Style/InteractorStyleManipulator"),require("vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballRotateManipulator"),require("vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballPanManipulator"),require("vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballZoomManipulator"),require("vtk.js/Sources/Interaction/Manipulators/MouseRangeManipulator"),require("vtk.js/Sources/Rendering/Core/Volume"),require("vtk.js/Sources/Rendering/Core/VolumeMapper"),require("vtk.js/Sources/Rendering/Core/ColorTransferFunction"),require("vtk.js/Sources/Common/DataModel/PiecewiseFunction"),require("vtk.js/Sources/Filters/Core/Cutter"),require("vtk.js/Sources/Common/DataModel/Plane"),require("vtk.js/Sources/Rendering/Core/Property"),require("vtk.js/Sources/Rendering/Core/AnnotatedCubeActor"),require("vtk.js/Sources/Widgets/Manipulators/PlaneManipulator"),require("vtk.js/Sources/Rendering/OpenGL/HardwareSelector"),require("vtk.js/Sources/Filters/General/TubeFilter"),require("vtk.js/Sources/Common/Core/CellArray"),require("vtk.js/Sources/Common/DataModel/PolyData"),require("vtk.js/Sources/Common/Core/Points"),require("vtk.js/Sources/Rendering/Core/PointPicker")):e.VTKViewport=t(e["vtk.js/Sources/macro"],e.react,e["vtk.js/Sources/Rendering/Core/Coordinate"],e["vtk.js/Sources/Common/Core/Math"],e["vtk.js/Sources/Rendering/Core/InteractorStyle/Constants"],e.cornerstone,e["vtk.js/Sources/Rendering/Core/ImageMapper"],e["vtk.js/Sources/Common/Core/MatrixBuilder"],e["vtk.js/Sources/Rendering/Misc/GenericRenderWindow"],e["vtk.js/Sources/Widgets/Core/WidgetManager"],e["vtk.js/Sources/Interaction/Style/InteractorStyleImage"],e["vtk.js/Sources/Interaction/Style/InteractorStyleTrackballCamera"],e.cornerstoneTools,e["vtk.js/Sources/Rendering/Core/Mapper"],e["vtk.js/Sources/Rendering/Core/Actor"],e["vtk.js/Sources/Filters/General/PaintFilter"],e["vtk.js/Sources/Widgets/Widgets3D/PaintWidget"],e["vtk.js/Sources/Widgets/Core/WidgetManager/Constants"],e["vtk.js/Sources/Common/DataModel/ImageData"],e["vtk.js/Sources/Common/Core/DataArray"],e["vtk.js/Sources/Common/DataModel/BoundingBox"],e["vtk.js/Sources/Filters/Sources/LineSource"],e["vtk.js/Sources/Rendering/Core/Renderer"],e["vtk.js/Sources/Interaction/Widgets/OrientationMarkerWidget"],e["vtk.js/Sources/Interaction/Style/InteractorStyleManipulator"],e["vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballRotateManipulator"],e["vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballPanManipulator"],e["vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballZoomManipulator"],e["vtk.js/Sources/Interaction/Manipulators/MouseRangeManipulator"],e["vtk.js/Sources/Rendering/Core/Volume"],e["vtk.js/Sources/Rendering/Core/VolumeMapper"],e["vtk.js/Sources/Rendering/Core/ColorTransferFunction"],e["vtk.js/Sources/Common/DataModel/PiecewiseFunction"],e["vtk.js/Sources/Filters/Core/Cutter"],e["vtk.js/Sources/Common/DataModel/Plane"],e["vtk.js/Sources/Rendering/Core/Property"],e["vtk.js/Sources/Rendering/Core/AnnotatedCubeActor"],e["vtk.js/Sources/Widgets/Manipulators/PlaneManipulator"],e["vtk.js/Sources/Rendering/OpenGL/HardwareSelector"],e["vtk.js/Sources/Filters/General/TubeFilter"],e["vtk.js/Sources/Common/Core/CellArray"],e["vtk.js/Sources/Common/DataModel/PolyData"],e["vtk.js/Sources/Common/Core/Points"],e["vtk.js/Sources/Rendering/Core/PointPicker"])}(this,(function(e,t,n,r,a,i,o,s,c,u,d,l,h,g,p,f,v,m,w,y,b,M,S,C,k,x,I,R,W,P,T,D,A,E,O,j,q,L,V,F,U,N,B,G){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=74)}([function(e,t,n){e.exports=n(62)()},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){var r=n(57),a=n(58),i=n(59);e.exports=function(e){return r(e)||a(e)||i()}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t){e.exports=a},function(e,t,n){var r=n(54),a=n(55),i=n(56);e.exports=function(e,t){return r(e)||a(e,t)||i()}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t){e.exports=i},function(e,t,n){var r=n(60),a=n(19);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?a(e):t}},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){var r=n(61);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t){e.exports=o},function(e,t){e.exports=s},function(e,t){e.exports=c},function(e,t){e.exports=u},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},function(e,t){e.exports=d},function(e,t){e.exports=l},function(e,t){e.exports=h},function(e,t){e.exports=g},function(e,t){e.exports=p},function(e,t){e.exports=f},function(e,t){e.exports=v},function(e,t){e.exports=m},function(e,t){e.exports=w},function(e,t){e.exports=y},function(e,t){e.exports=b},function(e,t){e.exports=M},function(e,t){e.exports=S},function(e,t){e.exports=C},function(e,t){e.exports=k},function(e,t){e.exports=x},function(e,t){e.exports=I},function(e,t){e.exports=R},function(e,t){e.exports=W},function(e,t){e.exports=P},function(e,t){e.exports=T},function(e,t){e.exports=D},function(e,t){e.exports=A},function(e,t){e.exports=E},function(e,t){e.exports=O},function(e,t){e.exports=j},function(e,t){e.exports=q},function(e,t){e.exports=L},function(e,t){e.exports=V},,,,,function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}},function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=r=function(e){return n(e)}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},r(t)}e.exports=r},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t,n){"use strict";var r=n(63);function a(){}function i(){}i.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,i,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){var r=n(65);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(67)(r,a);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(66)(!1)).push([e.i,":root {\n  --viewport-tag-padding: 20px;\n}\n\n.ViewportOverlay {\n  color: #9ccef9;\n}\n\n.ViewportOverlay .overlay-element {\n  position: absolute;\n  font-weight: 400;\n  text-shadow: 1px 1px black;\n  pointer-events: none;\n}\n\n.ViewportOverlay .top-left {\n  top: var(--viewport-tag-padding);\n  left: var(--viewport-tag-padding);\n}\n\n.ViewportOverlay .top-center {\n  top: 1px;\n  width: 100%;\n  text-align: center;\n}\n\n.ViewportOverlay .top-right {\n  top: var(--viewport-tag-padding);\n  right: var(--viewport-tag-padding);\n  text-align: right;\n}\n\n.ViewportOverlay .bottom-left {\n  bottom: var(--viewport-tag-padding);\n  left: var(--viewport-tag-padding);\n}\n\n.ViewportOverlay .bottom-right {\n  bottom: var(--viewport-tag-padding);\n  right: var(--viewport-tag-padding);\n  text-align: right;\n}\n\n.ViewportOverlay .bottom-center {\n  bottom: 1px;\n  width: 100%;\n  text-align: center;\n}\n\n.ViewportOverlay .center-left {\n  left: 1px;\n  top: 50%;\n  text-align: left;\n}\n\n.ViewportOverlay .center-right {\n  right: 1px;\n  top: 50%;\n  text-align: right;\n}\n\n.ViewportOverlay svg {\n  color: #9ccef9;\n  fill: #9ccef9;\n  stroke: #9ccef9;\n  background-color: transparent;\n  margin: 2px;\n  width: 18px;\n  height: 18px;\n}\n",""])},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var a=(o=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(c," */")),i=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot).concat(e," */")}));return[n].concat(i).concat([a]).join("\n")}var o,s,c;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(n,"}"):n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},a=0;a<this.length;a++){var i=this[a][0];null!=i&&(r[i]=!0)}for(var o=0;o<e.length;o++){var s=e[o];null!=s[0]&&r[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="(".concat(s[2],") and (").concat(n,")")),t.push(s))}},t}},function(e,t,n){var r,a,i={},o=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===a&&(a=r.apply(this,arguments)),a}),s=function(e,t){return t?t.querySelector(e):document.querySelector(e)},c=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var r=s.call(this,e,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}}(),u=null,d=0,l=[],h=n(68);function g(e,t){for(var n=0;n<e.length;n++){var r=e[n],a=i[r.id];if(a){a.refs++;for(var o=0;o<a.parts.length;o++)a.parts[o](r.parts[o]);for(;o<r.parts.length;o++)a.parts.push(y(r.parts[o],t))}else{var s=[];for(o=0;o<r.parts.length;o++)s.push(y(r.parts[o],t));i[r.id]={id:r.id,refs:1,parts:s}}}}function p(e,t){for(var n=[],r={},a=0;a<e.length;a++){var i=e[a],o=t.base?i[0]+t.base:i[0],s={css:i[1],media:i[2],sourceMap:i[3]};r[o]?r[o].parts.push(s):n.push(r[o]={id:o,parts:[s]})}return n}function f(e,t){var n=c(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=l[l.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),l.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var a=c(e.insertAt.before,n);n.insertBefore(t,a)}}function v(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=l.indexOf(e);t>=0&&l.splice(t,1)}function m(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var r=function(){0;return n.nc}();r&&(e.attrs.nonce=r)}return w(t,e.attrs),f(e,t),t}function w(e,t){Object.keys(t).forEach((function(n){e.setAttribute(n,t[n])}))}function y(e,t){var n,r,a,i;if(t.transform&&e.css){if(!(i="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=i}if(t.singleton){var o=d++;n=u||(u=m(t)),r=S.bind(null,n,o,!1),a=S.bind(null,n,o,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",w(t,e.attrs),f(e,t),t}(t),r=k.bind(null,n,t),a=function(){v(n),n.href&&URL.revokeObjectURL(n.href)}):(n=m(t),r=C.bind(null,n),a=function(){v(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else a()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=o()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=p(e,t);return g(n,t),function(e){for(var r=[],a=0;a<n.length;a++){var o=n[a];(s=i[o.id]).refs--,r.push(s)}e&&g(p(e,t),t);for(a=0;a<r.length;a++){var s;if(0===(s=r[a]).refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete i[s.id]}}}};var b,M=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function S(e,t,n,r){var a=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=M(t,a);else{var i=document.createTextNode(a),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function C(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function k(e,t,n){var r=n.css,a=n.sourceMap,i=void 0===t.convertToAbsoluteUrls&&a;(t.convertToAbsoluteUrls||i)&&(r=h(r)),a&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */");var o=new Blob([r],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(o),s&&URL.revokeObjectURL(s)}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,r=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var a,i=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?e:(a=0===i.indexOf("//")?i:0===i.indexOf("/")?n+i:r+i.replace(/^\.\//,""),"url("+JSON.stringify(a)+")")}))}},function(e,t){e.exports=F},function(e,t){e.exports=U},function(e,t){e.exports=N},function(e,t){e.exports=B},function(e,t){e.exports=G},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"create",(function(){return ce})),n.d(r,"clone",(function(){return ue})),n.d(r,"copy",(function(){return de})),n.d(r,"fromValues",(function(){return le})),n.d(r,"set",(function(){return he})),n.d(r,"identity",(function(){return ge})),n.d(r,"transpose",(function(){return pe})),n.d(r,"invert",(function(){return fe})),n.d(r,"adjoint",(function(){return ve})),n.d(r,"determinant",(function(){return me})),n.d(r,"multiply",(function(){return we})),n.d(r,"translate",(function(){return ye})),n.d(r,"scale",(function(){return be})),n.d(r,"rotate",(function(){return Me})),n.d(r,"rotateX",(function(){return Se})),n.d(r,"rotateY",(function(){return Ce})),n.d(r,"rotateZ",(function(){return ke})),n.d(r,"fromTranslation",(function(){return xe})),n.d(r,"fromScaling",(function(){return Ie})),n.d(r,"fromRotation",(function(){return Re})),n.d(r,"fromXRotation",(function(){return We})),n.d(r,"fromYRotation",(function(){return Pe})),n.d(r,"fromZRotation",(function(){return Te})),n.d(r,"fromRotationTranslation",(function(){return De})),n.d(r,"fromQuat2",(function(){return Ae})),n.d(r,"getTranslation",(function(){return Ee})),n.d(r,"getScaling",(function(){return Oe})),n.d(r,"getRotation",(function(){return je})),n.d(r,"fromRotationTranslationScale",(function(){return qe})),n.d(r,"fromRotationTranslationScaleOrigin",(function(){return Le})),n.d(r,"fromQuat",(function(){return Ve})),n.d(r,"frustum",(function(){return Fe})),n.d(r,"perspective",(function(){return Ue})),n.d(r,"perspectiveFromFieldOfView",(function(){return Ne})),n.d(r,"ortho",(function(){return Be})),n.d(r,"lookAt",(function(){return Ge})),n.d(r,"targetTo",(function(){return He})),n.d(r,"str",(function(){return _e})),n.d(r,"frob",(function(){return ze})),n.d(r,"add",(function(){return Ye})),n.d(r,"subtract",(function(){return Qe})),n.d(r,"multiplyScalar",(function(){return Ke})),n.d(r,"multiplyScalarAndAdd",(function(){return Xe})),n.d(r,"exactEquals",(function(){return Ze})),n.d(r,"equals",(function(){return Je})),n.d(r,"mul",(function(){return $e})),n.d(r,"sub",(function(){return et}));var a={};n.r(a),n.d(a,"create",(function(){return tt})),n.d(a,"clone",(function(){return nt})),n.d(a,"length",(function(){return rt})),n.d(a,"fromValues",(function(){return at})),n.d(a,"copy",(function(){return it})),n.d(a,"set",(function(){return ot})),n.d(a,"add",(function(){return st})),n.d(a,"subtract",(function(){return ct})),n.d(a,"multiply",(function(){return ut})),n.d(a,"divide",(function(){return dt})),n.d(a,"ceil",(function(){return lt})),n.d(a,"floor",(function(){return ht})),n.d(a,"min",(function(){return gt})),n.d(a,"max",(function(){return pt})),n.d(a,"round",(function(){return ft})),n.d(a,"scale",(function(){return vt})),n.d(a,"scaleAndAdd",(function(){return mt})),n.d(a,"distance",(function(){return wt})),n.d(a,"squaredDistance",(function(){return yt})),n.d(a,"squaredLength",(function(){return bt})),n.d(a,"negate",(function(){return Mt})),n.d(a,"inverse",(function(){return St})),n.d(a,"normalize",(function(){return Ct})),n.d(a,"dot",(function(){return kt})),n.d(a,"cross",(function(){return xt})),n.d(a,"lerp",(function(){return It})),n.d(a,"hermite",(function(){return Rt})),n.d(a,"bezier",(function(){return Wt})),n.d(a,"random",(function(){return Pt})),n.d(a,"transformMat4",(function(){return Tt})),n.d(a,"transformMat3",(function(){return Dt})),n.d(a,"transformQuat",(function(){return At})),n.d(a,"rotateX",(function(){return Et})),n.d(a,"rotateY",(function(){return Ot})),n.d(a,"rotateZ",(function(){return jt})),n.d(a,"angle",(function(){return qt})),n.d(a,"zero",(function(){return Lt})),n.d(a,"str",(function(){return Vt})),n.d(a,"exactEquals",(function(){return Ft})),n.d(a,"equals",(function(){return Ut})),n.d(a,"sub",(function(){return Bt})),n.d(a,"mul",(function(){return Gt})),n.d(a,"div",(function(){return Ht})),n.d(a,"dist",(function(){return _t})),n.d(a,"sqrDist",(function(){return zt})),n.d(a,"len",(function(){return Yt})),n.d(a,"sqrLen",(function(){return Qt})),n.d(a,"forEach",(function(){return Kt}));var i={};n.r(i),n.d(i,"create",(function(){return Jt})),n.d(i,"identity",(function(){return $t})),n.d(i,"setAxisAngle",(function(){return en})),n.d(i,"getAxisAngle",(function(){return tn})),n.d(i,"getAngle",(function(){return nn})),n.d(i,"multiply",(function(){return rn})),n.d(i,"rotateX",(function(){return an})),n.d(i,"rotateY",(function(){return on})),n.d(i,"rotateZ",(function(){return sn})),n.d(i,"calculateW",(function(){return cn})),n.d(i,"exp",(function(){return un})),n.d(i,"ln",(function(){return dn})),n.d(i,"pow",(function(){return ln})),n.d(i,"slerp",(function(){return hn})),n.d(i,"random",(function(){return gn})),n.d(i,"invert",(function(){return pn})),n.d(i,"conjugate",(function(){return fn})),n.d(i,"fromMat3",(function(){return vn})),n.d(i,"fromEuler",(function(){return mn})),n.d(i,"str",(function(){return wn})),n.d(i,"clone",(function(){return In})),n.d(i,"fromValues",(function(){return Rn})),n.d(i,"copy",(function(){return Wn})),n.d(i,"set",(function(){return Pn})),n.d(i,"add",(function(){return Tn})),n.d(i,"mul",(function(){return Dn})),n.d(i,"scale",(function(){return An})),n.d(i,"dot",(function(){return En})),n.d(i,"lerp",(function(){return On})),n.d(i,"length",(function(){return jn})),n.d(i,"len",(function(){return qn})),n.d(i,"squaredLength",(function(){return Ln})),n.d(i,"sqrLen",(function(){return Vn})),n.d(i,"normalize",(function(){return Fn})),n.d(i,"exactEquals",(function(){return Un})),n.d(i,"equals",(function(){return Nn})),n.d(i,"rotationTo",(function(){return Bn})),n.d(i,"sqlerp",(function(){return Gn})),n.d(i,"setAxes",(function(){return Hn}));var o={};n.r(o),n.d(o,"create",(function(){return _n})),n.d(o,"clone",(function(){return zn})),n.d(o,"fromValues",(function(){return Yn})),n.d(o,"copy",(function(){return Qn})),n.d(o,"set",(function(){return Kn})),n.d(o,"add",(function(){return Xn})),n.d(o,"subtract",(function(){return Zn})),n.d(o,"multiply",(function(){return Jn})),n.d(o,"divide",(function(){return $n})),n.d(o,"ceil",(function(){return er})),n.d(o,"floor",(function(){return tr})),n.d(o,"min",(function(){return nr})),n.d(o,"max",(function(){return rr})),n.d(o,"round",(function(){return ar})),n.d(o,"scale",(function(){return ir})),n.d(o,"scaleAndAdd",(function(){return or})),n.d(o,"distance",(function(){return sr})),n.d(o,"squaredDistance",(function(){return cr})),n.d(o,"length",(function(){return ur})),n.d(o,"squaredLength",(function(){return dr})),n.d(o,"negate",(function(){return lr})),n.d(o,"inverse",(function(){return hr})),n.d(o,"normalize",(function(){return gr})),n.d(o,"dot",(function(){return pr})),n.d(o,"cross",(function(){return fr})),n.d(o,"lerp",(function(){return vr})),n.d(o,"random",(function(){return mr})),n.d(o,"transformMat2",(function(){return wr})),n.d(o,"transformMat2d",(function(){return yr})),n.d(o,"transformMat3",(function(){return br})),n.d(o,"transformMat4",(function(){return Mr})),n.d(o,"rotate",(function(){return Sr})),n.d(o,"angle",(function(){return Cr})),n.d(o,"zero",(function(){return kr})),n.d(o,"str",(function(){return xr})),n.d(o,"exactEquals",(function(){return Ir})),n.d(o,"equals",(function(){return Rr})),n.d(o,"len",(function(){return Wr})),n.d(o,"sub",(function(){return Pr})),n.d(o,"mul",(function(){return Tr})),n.d(o,"div",(function(){return Dr})),n.d(o,"dist",(function(){return Ar})),n.d(o,"sqrDist",(function(){return Er})),n.d(o,"sqrLen",(function(){return Or})),n.d(o,"forEach",(function(){return jr}));var s=n(20),c=n.n(s),u=n(8),d=n.n(u),l=n(3),h=n.n(l),g=n(9),p=n.n(g),f=n(10),v=n.n(f),m=n(12),w=n.n(m),y=n(13),b=n.n(y),M=n(19),S=n.n(M),C=n(14),k=n.n(C),x=n(4),I=n.n(x),R=n(2),W=n.n(R),P=n(0),T=n.n(P),D=n(23),A=n.n(D),E=n(17),O=n.n(E),j=n(33),q=n.n(j),L=n(18),V=n.n(L),F=n(1),U=n.n(F),N=n(6),B=n.n(N),G=n(16),H=n.n(G),_=n(35),z=n.n(_),Y=n(36),Q=n.n(Y),K=n(37),X=n.n(K),Z=n(38),J=n.n(Z),$=n(39),ee=n.n($),te=n(5),ne=n.n(te),re=n(7),ae=n.n(re),ie=1e-6,oe="undefined"!=typeof Float32Array?Float32Array:Array,se=Math.random;Math.PI;function ce(){var e=new oe(16);return oe!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function ue(e){var t=new oe(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function de(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function le(e,t,n,r,a,i,o,s,c,u,d,l,h,g,p,f){var v=new oe(16);return v[0]=e,v[1]=t,v[2]=n,v[3]=r,v[4]=a,v[5]=i,v[6]=o,v[7]=s,v[8]=c,v[9]=u,v[10]=d,v[11]=l,v[12]=h,v[13]=g,v[14]=p,v[15]=f,v}function he(e,t,n,r,a,i,o,s,c,u,d,l,h,g,p,f,v){return e[0]=t,e[1]=n,e[2]=r,e[3]=a,e[4]=i,e[5]=o,e[6]=s,e[7]=c,e[8]=u,e[9]=d,e[10]=l,e[11]=h,e[12]=g,e[13]=p,e[14]=f,e[15]=v,e}function ge(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function pe(e,t){if(e===t){var n=t[1],r=t[2],a=t[3],i=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=i,e[11]=t[14],e[12]=a,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function fe(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=t[4],s=t[5],c=t[6],u=t[7],d=t[8],l=t[9],h=t[10],g=t[11],p=t[12],f=t[13],v=t[14],m=t[15],w=n*s-r*o,y=n*c-a*o,b=n*u-i*o,M=r*c-a*s,S=r*u-i*s,C=a*u-i*c,k=d*f-l*p,x=d*v-h*p,I=d*m-g*p,R=l*v-h*f,W=l*m-g*f,P=h*m-g*v,T=w*P-y*W+b*R+M*I-S*x+C*k;return T?(T=1/T,e[0]=(s*P-c*W+u*R)*T,e[1]=(a*W-r*P-i*R)*T,e[2]=(f*C-v*S+m*M)*T,e[3]=(h*S-l*C-g*M)*T,e[4]=(c*I-o*P-u*x)*T,e[5]=(n*P-a*I+i*x)*T,e[6]=(v*b-p*C-m*y)*T,e[7]=(d*C-h*b+g*y)*T,e[8]=(o*W-s*I+u*k)*T,e[9]=(r*I-n*W-i*k)*T,e[10]=(p*S-f*b+m*w)*T,e[11]=(l*b-d*S-g*w)*T,e[12]=(s*x-o*R-c*k)*T,e[13]=(n*R-r*x+a*k)*T,e[14]=(f*y-p*M-v*w)*T,e[15]=(d*M-l*y+h*w)*T,e):null}function ve(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=t[4],s=t[5],c=t[6],u=t[7],d=t[8],l=t[9],h=t[10],g=t[11],p=t[12],f=t[13],v=t[14],m=t[15];return e[0]=s*(h*m-g*v)-l*(c*m-u*v)+f*(c*g-u*h),e[1]=-(r*(h*m-g*v)-l*(a*m-i*v)+f*(a*g-i*h)),e[2]=r*(c*m-u*v)-s*(a*m-i*v)+f*(a*u-i*c),e[3]=-(r*(c*g-u*h)-s*(a*g-i*h)+l*(a*u-i*c)),e[4]=-(o*(h*m-g*v)-d*(c*m-u*v)+p*(c*g-u*h)),e[5]=n*(h*m-g*v)-d*(a*m-i*v)+p*(a*g-i*h),e[6]=-(n*(c*m-u*v)-o*(a*m-i*v)+p*(a*u-i*c)),e[7]=n*(c*g-u*h)-o*(a*g-i*h)+d*(a*u-i*c),e[8]=o*(l*m-g*f)-d*(s*m-u*f)+p*(s*g-u*l),e[9]=-(n*(l*m-g*f)-d*(r*m-i*f)+p*(r*g-i*l)),e[10]=n*(s*m-u*f)-o*(r*m-i*f)+p*(r*u-i*s),e[11]=-(n*(s*g-u*l)-o*(r*g-i*l)+d*(r*u-i*s)),e[12]=-(o*(l*v-h*f)-d*(s*v-c*f)+p*(s*h-c*l)),e[13]=n*(l*v-h*f)-d*(r*v-a*f)+p*(r*h-a*l),e[14]=-(n*(s*v-c*f)-o*(r*v-a*f)+p*(r*c-a*s)),e[15]=n*(s*h-c*l)-o*(r*h-a*l)+d*(r*c-a*s),e}function me(e){var t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],o=e[5],s=e[6],c=e[7],u=e[8],d=e[9],l=e[10],h=e[11],g=e[12],p=e[13],f=e[14],v=e[15];return(t*o-n*i)*(l*v-h*f)-(t*s-r*i)*(d*v-h*p)+(t*c-a*i)*(d*f-l*p)+(n*s-r*o)*(u*v-h*g)-(n*c-a*o)*(u*f-l*g)+(r*c-a*s)*(u*p-d*g)}function we(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],s=t[4],c=t[5],u=t[6],d=t[7],l=t[8],h=t[9],g=t[10],p=t[11],f=t[12],v=t[13],m=t[14],w=t[15],y=n[0],b=n[1],M=n[2],S=n[3];return e[0]=y*r+b*s+M*l+S*f,e[1]=y*a+b*c+M*h+S*v,e[2]=y*i+b*u+M*g+S*m,e[3]=y*o+b*d+M*p+S*w,y=n[4],b=n[5],M=n[6],S=n[7],e[4]=y*r+b*s+M*l+S*f,e[5]=y*a+b*c+M*h+S*v,e[6]=y*i+b*u+M*g+S*m,e[7]=y*o+b*d+M*p+S*w,y=n[8],b=n[9],M=n[10],S=n[11],e[8]=y*r+b*s+M*l+S*f,e[9]=y*a+b*c+M*h+S*v,e[10]=y*i+b*u+M*g+S*m,e[11]=y*o+b*d+M*p+S*w,y=n[12],b=n[13],M=n[14],S=n[15],e[12]=y*r+b*s+M*l+S*f,e[13]=y*a+b*c+M*h+S*v,e[14]=y*i+b*u+M*g+S*m,e[15]=y*o+b*d+M*p+S*w,e}function ye(e,t,n){var r,a,i,o,s,c,u,d,l,h,g,p,f=n[0],v=n[1],m=n[2];return t===e?(e[12]=t[0]*f+t[4]*v+t[8]*m+t[12],e[13]=t[1]*f+t[5]*v+t[9]*m+t[13],e[14]=t[2]*f+t[6]*v+t[10]*m+t[14],e[15]=t[3]*f+t[7]*v+t[11]*m+t[15]):(r=t[0],a=t[1],i=t[2],o=t[3],s=t[4],c=t[5],u=t[6],d=t[7],l=t[8],h=t[9],g=t[10],p=t[11],e[0]=r,e[1]=a,e[2]=i,e[3]=o,e[4]=s,e[5]=c,e[6]=u,e[7]=d,e[8]=l,e[9]=h,e[10]=g,e[11]=p,e[12]=r*f+s*v+l*m+t[12],e[13]=a*f+c*v+h*m+t[13],e[14]=i*f+u*v+g*m+t[14],e[15]=o*f+d*v+p*m+t[15]),e}function be(e,t,n){var r=n[0],a=n[1],i=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Me(e,t,n,r){var a,i,o,s,c,u,d,l,h,g,p,f,v,m,w,y,b,M,S,C,k,x,I,R,W=r[0],P=r[1],T=r[2],D=Math.hypot(W,P,T);return D<ie?null:(W*=D=1/D,P*=D,T*=D,a=Math.sin(n),o=1-(i=Math.cos(n)),s=t[0],c=t[1],u=t[2],d=t[3],l=t[4],h=t[5],g=t[6],p=t[7],f=t[8],v=t[9],m=t[10],w=t[11],y=W*W*o+i,b=P*W*o+T*a,M=T*W*o-P*a,S=W*P*o-T*a,C=P*P*o+i,k=T*P*o+W*a,x=W*T*o+P*a,I=P*T*o-W*a,R=T*T*o+i,e[0]=s*y+l*b+f*M,e[1]=c*y+h*b+v*M,e[2]=u*y+g*b+m*M,e[3]=d*y+p*b+w*M,e[4]=s*S+l*C+f*k,e[5]=c*S+h*C+v*k,e[6]=u*S+g*C+m*k,e[7]=d*S+p*C+w*k,e[8]=s*x+l*I+f*R,e[9]=c*x+h*I+v*R,e[10]=u*x+g*I+m*R,e[11]=d*x+p*I+w*R,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Se(e,t,n){var r=Math.sin(n),a=Math.cos(n),i=t[4],o=t[5],s=t[6],c=t[7],u=t[8],d=t[9],l=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*a+u*r,e[5]=o*a+d*r,e[6]=s*a+l*r,e[7]=c*a+h*r,e[8]=u*a-i*r,e[9]=d*a-o*r,e[10]=l*a-s*r,e[11]=h*a-c*r,e}function Ce(e,t,n){var r=Math.sin(n),a=Math.cos(n),i=t[0],o=t[1],s=t[2],c=t[3],u=t[8],d=t[9],l=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*a-u*r,e[1]=o*a-d*r,e[2]=s*a-l*r,e[3]=c*a-h*r,e[8]=i*r+u*a,e[9]=o*r+d*a,e[10]=s*r+l*a,e[11]=c*r+h*a,e}function ke(e,t,n){var r=Math.sin(n),a=Math.cos(n),i=t[0],o=t[1],s=t[2],c=t[3],u=t[4],d=t[5],l=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*a+u*r,e[1]=o*a+d*r,e[2]=s*a+l*r,e[3]=c*a+h*r,e[4]=u*a-i*r,e[5]=d*a-o*r,e[6]=l*a-s*r,e[7]=h*a-c*r,e}function xe(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Ie(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Re(e,t,n){var r,a,i,o=n[0],s=n[1],c=n[2],u=Math.hypot(o,s,c);return u<ie?null:(o*=u=1/u,s*=u,c*=u,r=Math.sin(t),i=1-(a=Math.cos(t)),e[0]=o*o*i+a,e[1]=s*o*i+c*r,e[2]=c*o*i-s*r,e[3]=0,e[4]=o*s*i-c*r,e[5]=s*s*i+a,e[6]=c*s*i+o*r,e[7]=0,e[8]=o*c*i+s*r,e[9]=s*c*i-o*r,e[10]=c*c*i+a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function We(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Pe(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Te(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function De(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],s=r+r,c=a+a,u=i+i,d=r*s,l=r*c,h=r*u,g=a*c,p=a*u,f=i*u,v=o*s,m=o*c,w=o*u;return e[0]=1-(g+f),e[1]=l+w,e[2]=h-m,e[3]=0,e[4]=l-w,e[5]=1-(d+f),e[6]=p+v,e[7]=0,e[8]=h+m,e[9]=p-v,e[10]=1-(d+g),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function Ae(e,t){var n=new oe(3),r=-t[0],a=-t[1],i=-t[2],o=t[3],s=t[4],c=t[5],u=t[6],d=t[7],l=r*r+a*a+i*i+o*o;return l>0?(n[0]=2*(s*o+d*r+c*i-u*a)/l,n[1]=2*(c*o+d*a+u*r-s*i)/l,n[2]=2*(u*o+d*i+s*a-c*r)/l):(n[0]=2*(s*o+d*r+c*i-u*a),n[1]=2*(c*o+d*a+u*r-s*i),n[2]=2*(u*o+d*i+s*a-c*r)),De(e,t,n),e}function Ee(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Oe(e,t){var n=t[0],r=t[1],a=t[2],i=t[4],o=t[5],s=t[6],c=t[8],u=t[9],d=t[10];return e[0]=Math.hypot(n,r,a),e[1]=Math.hypot(i,o,s),e[2]=Math.hypot(c,u,d),e}function je(e,t){var n=new oe(3);Oe(n,t);var r=1/n[0],a=1/n[1],i=1/n[2],o=t[0]*r,s=t[1]*a,c=t[2]*i,u=t[4]*r,d=t[5]*a,l=t[6]*i,h=t[8]*r,g=t[9]*a,p=t[10]*i,f=o+d+p,v=0;return f>0?(v=2*Math.sqrt(f+1),e[3]=.25*v,e[0]=(l-g)/v,e[1]=(h-c)/v,e[2]=(s-u)/v):o>d&&o>p?(v=2*Math.sqrt(1+o-d-p),e[3]=(l-g)/v,e[0]=.25*v,e[1]=(s+u)/v,e[2]=(h+c)/v):d>p?(v=2*Math.sqrt(1+d-o-p),e[3]=(h-c)/v,e[0]=(s+u)/v,e[1]=.25*v,e[2]=(l+g)/v):(v=2*Math.sqrt(1+p-o-d),e[3]=(s-u)/v,e[0]=(h+c)/v,e[1]=(l+g)/v,e[2]=.25*v),e}function qe(e,t,n,r){var a=t[0],i=t[1],o=t[2],s=t[3],c=a+a,u=i+i,d=o+o,l=a*c,h=a*u,g=a*d,p=i*u,f=i*d,v=o*d,m=s*c,w=s*u,y=s*d,b=r[0],M=r[1],S=r[2];return e[0]=(1-(p+v))*b,e[1]=(h+y)*b,e[2]=(g-w)*b,e[3]=0,e[4]=(h-y)*M,e[5]=(1-(l+v))*M,e[6]=(f+m)*M,e[7]=0,e[8]=(g+w)*S,e[9]=(f-m)*S,e[10]=(1-(l+p))*S,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function Le(e,t,n,r,a){var i=t[0],o=t[1],s=t[2],c=t[3],u=i+i,d=o+o,l=s+s,h=i*u,g=i*d,p=i*l,f=o*d,v=o*l,m=s*l,w=c*u,y=c*d,b=c*l,M=r[0],S=r[1],C=r[2],k=a[0],x=a[1],I=a[2],R=(1-(f+m))*M,W=(g+b)*M,P=(p-y)*M,T=(g-b)*S,D=(1-(h+m))*S,A=(v+w)*S,E=(p+y)*C,O=(v-w)*C,j=(1-(h+f))*C;return e[0]=R,e[1]=W,e[2]=P,e[3]=0,e[4]=T,e[5]=D,e[6]=A,e[7]=0,e[8]=E,e[9]=O,e[10]=j,e[11]=0,e[12]=n[0]+k-(R*k+T*x+E*I),e[13]=n[1]+x-(W*k+D*x+O*I),e[14]=n[2]+I-(P*k+A*x+j*I),e[15]=1,e}function Ve(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=n+n,s=r+r,c=a+a,u=n*o,d=r*o,l=r*s,h=a*o,g=a*s,p=a*c,f=i*o,v=i*s,m=i*c;return e[0]=1-l-p,e[1]=d+m,e[2]=h-v,e[3]=0,e[4]=d-m,e[5]=1-u-p,e[6]=g+f,e[7]=0,e[8]=h+v,e[9]=g-f,e[10]=1-u-l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Fe(e,t,n,r,a,i,o){var s=1/(n-t),c=1/(a-r),u=1/(i-o);return e[0]=2*i*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*i*c,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(a+r)*c,e[10]=(o+i)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*i*2*u,e[15]=0,e}function Ue(e,t,n,r,a){var i,o=1/Math.tan(t/2);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=a&&a!==1/0?(i=1/(r-a),e[10]=(a+r)*i,e[14]=2*a*r*i):(e[10]=-1,e[14]=-2*r),e}function Ne(e,t,n,r){var a=Math.tan(t.upDegrees*Math.PI/180),i=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),c=2/(o+s),u=2/(a+i);return e[0]=c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-(o-s)*c*.5,e[9]=(a-i)*u*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}function Be(e,t,n,r,a,i,o){var s=1/(t-n),c=1/(r-a),u=1/(i-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+n)*s,e[13]=(a+r)*c,e[14]=(o+i)*u,e[15]=1,e}function Ge(e,t,n,r){var a,i,o,s,c,u,d,l,h,g,p=t[0],f=t[1],v=t[2],m=r[0],w=r[1],y=r[2],b=n[0],M=n[1],S=n[2];return Math.abs(p-b)<ie&&Math.abs(f-M)<ie&&Math.abs(v-S)<ie?ge(e):(d=p-b,l=f-M,h=v-S,a=w*(h*=g=1/Math.hypot(d,l,h))-y*(l*=g),i=y*(d*=g)-m*h,o=m*l-w*d,(g=Math.hypot(a,i,o))?(a*=g=1/g,i*=g,o*=g):(a=0,i=0,o=0),s=l*o-h*i,c=h*a-d*o,u=d*i-l*a,(g=Math.hypot(s,c,u))?(s*=g=1/g,c*=g,u*=g):(s=0,c=0,u=0),e[0]=a,e[1]=s,e[2]=d,e[3]=0,e[4]=i,e[5]=c,e[6]=l,e[7]=0,e[8]=o,e[9]=u,e[10]=h,e[11]=0,e[12]=-(a*p+i*f+o*v),e[13]=-(s*p+c*f+u*v),e[14]=-(d*p+l*f+h*v),e[15]=1,e)}function He(e,t,n,r){var a=t[0],i=t[1],o=t[2],s=r[0],c=r[1],u=r[2],d=a-n[0],l=i-n[1],h=o-n[2],g=d*d+l*l+h*h;g>0&&(d*=g=1/Math.sqrt(g),l*=g,h*=g);var p=c*h-u*l,f=u*d-s*h,v=s*l-c*d;return(g=p*p+f*f+v*v)>0&&(p*=g=1/Math.sqrt(g),f*=g,v*=g),e[0]=p,e[1]=f,e[2]=v,e[3]=0,e[4]=l*v-h*f,e[5]=h*p-d*v,e[6]=d*f-l*p,e[7]=0,e[8]=d,e[9]=l,e[10]=h,e[11]=0,e[12]=a,e[13]=i,e[14]=o,e[15]=1,e}function _e(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function ze(e){return Math.hypot(e[0],e[1],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Ye(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function Qe(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function Ke(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function Xe(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e}function Ze(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Je(e,t){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],s=e[5],c=e[6],u=e[7],d=e[8],l=e[9],h=e[10],g=e[11],p=e[12],f=e[13],v=e[14],m=e[15],w=t[0],y=t[1],b=t[2],M=t[3],S=t[4],C=t[5],k=t[6],x=t[7],I=t[8],R=t[9],W=t[10],P=t[11],T=t[12],D=t[13],A=t[14],E=t[15];return Math.abs(n-w)<=ie*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(r-y)<=ie*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(a-b)<=ie*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(i-M)<=ie*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(o-S)<=ie*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(s-C)<=ie*Math.max(1,Math.abs(s),Math.abs(C))&&Math.abs(c-k)<=ie*Math.max(1,Math.abs(c),Math.abs(k))&&Math.abs(u-x)<=ie*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(d-I)<=ie*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(l-R)<=ie*Math.max(1,Math.abs(l),Math.abs(R))&&Math.abs(h-W)<=ie*Math.max(1,Math.abs(h),Math.abs(W))&&Math.abs(g-P)<=ie*Math.max(1,Math.abs(g),Math.abs(P))&&Math.abs(p-T)<=ie*Math.max(1,Math.abs(p),Math.abs(T))&&Math.abs(f-D)<=ie*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(v-A)<=ie*Math.max(1,Math.abs(v),Math.abs(A))&&Math.abs(m-E)<=ie*Math.max(1,Math.abs(m),Math.abs(E))}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var $e=we,et=Qe;function tt(){var e=new oe(3);return oe!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function nt(e){var t=new oe(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function rt(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function at(e,t,n){var r=new oe(3);return r[0]=e,r[1]=t,r[2]=n,r}function it(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function ot(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function st(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function ct(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function ut(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function dt(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function lt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function ht(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function gt(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function pt(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function ft(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function vt(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function mt(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}function wt(e,t){var n=t[0]-e[0],r=t[1]-e[1],a=t[2]-e[2];return Math.hypot(n,r,a)}function yt(e,t){var n=t[0]-e[0],r=t[1]-e[1],a=t[2]-e[2];return n*n+r*r+a*a}function bt(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function Mt(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function St(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function Ct(e,t){var n=t[0],r=t[1],a=t[2],i=n*n+r*r+a*a;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function kt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function xt(e,t,n){var r=t[0],a=t[1],i=t[2],o=n[0],s=n[1],c=n[2];return e[0]=a*c-i*s,e[1]=i*o-r*c,e[2]=r*s-a*o,e}function It(e,t,n,r){var a=t[0],i=t[1],o=t[2];return e[0]=a+r*(n[0]-a),e[1]=i+r*(n[1]-i),e[2]=o+r*(n[2]-o),e}function Rt(e,t,n,r,a,i){var o=i*i,s=o*(2*i-3)+1,c=o*(i-2)+i,u=o*(i-1),d=o*(3-2*i);return e[0]=t[0]*s+n[0]*c+r[0]*u+a[0]*d,e[1]=t[1]*s+n[1]*c+r[1]*u+a[1]*d,e[2]=t[2]*s+n[2]*c+r[2]*u+a[2]*d,e}function Wt(e,t,n,r,a,i){var o=1-i,s=o*o,c=i*i,u=s*o,d=3*i*s,l=3*c*o,h=c*i;return e[0]=t[0]*u+n[0]*d+r[0]*l+a[0]*h,e[1]=t[1]*u+n[1]*d+r[1]*l+a[1]*h,e[2]=t[2]*u+n[2]*d+r[2]*l+a[2]*h,e}function Pt(e,t){t=t||1;var n=2*se()*Math.PI,r=2*se()-1,a=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*a,e[1]=Math.sin(n)*a,e[2]=r*t,e}function Tt(e,t,n){var r=t[0],a=t[1],i=t[2],o=n[3]*r+n[7]*a+n[11]*i+n[15];return o=o||1,e[0]=(n[0]*r+n[4]*a+n[8]*i+n[12])/o,e[1]=(n[1]*r+n[5]*a+n[9]*i+n[13])/o,e[2]=(n[2]*r+n[6]*a+n[10]*i+n[14])/o,e}function Dt(e,t,n){var r=t[0],a=t[1],i=t[2];return e[0]=r*n[0]+a*n[3]+i*n[6],e[1]=r*n[1]+a*n[4]+i*n[7],e[2]=r*n[2]+a*n[5]+i*n[8],e}function At(e,t,n){var r=n[0],a=n[1],i=n[2],o=n[3],s=t[0],c=t[1],u=t[2],d=a*u-i*c,l=i*s-r*u,h=r*c-a*s,g=a*h-i*l,p=i*d-r*h,f=r*l-a*d,v=2*o;return d*=v,l*=v,h*=v,g*=2,p*=2,f*=2,e[0]=s+d+g,e[1]=c+l+p,e[2]=u+h+f,e}function Et(e,t,n,r){var a=[],i=[];return a[0]=t[0]-n[0],a[1]=t[1]-n[1],a[2]=t[2]-n[2],i[0]=a[0],i[1]=a[1]*Math.cos(r)-a[2]*Math.sin(r),i[2]=a[1]*Math.sin(r)+a[2]*Math.cos(r),e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function Ot(e,t,n,r){var a=[],i=[];return a[0]=t[0]-n[0],a[1]=t[1]-n[1],a[2]=t[2]-n[2],i[0]=a[2]*Math.sin(r)+a[0]*Math.cos(r),i[1]=a[1],i[2]=a[2]*Math.cos(r)-a[0]*Math.sin(r),e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function jt(e,t,n,r){var a=[],i=[];return a[0]=t[0]-n[0],a[1]=t[1]-n[1],a[2]=t[2]-n[2],i[0]=a[0]*Math.cos(r)-a[1]*Math.sin(r),i[1]=a[0]*Math.sin(r)+a[1]*Math.cos(r),i[2]=a[2],e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function qt(e,t){var n=at(e[0],e[1],e[2]),r=at(t[0],t[1],t[2]);Ct(n,n),Ct(r,r);var a=kt(n,r);return a>1?0:a<-1?Math.PI:Math.acos(a)}function Lt(e){return e[0]=0,e[1]=0,e[2]=0,e}function Vt(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Ft(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Ut(e,t){var n=e[0],r=e[1],a=e[2],i=t[0],o=t[1],s=t[2];return Math.abs(n-i)<=ie*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=ie*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(a-s)<=ie*Math.max(1,Math.abs(a),Math.abs(s))}var Nt,Bt=ct,Gt=ut,Ht=dt,_t=wt,zt=yt,Yt=rt,Qt=bt,Kt=(Nt=tt(),function(e,t,n,r,a,i){var o,s;for(t||(t=3),n||(n=0),s=r?Math.min(r*t+n,e.length):e.length,o=n;o<s;o+=t)Nt[0]=e[o],Nt[1]=e[o+1],Nt[2]=e[o+2],a(Nt,Nt,i),e[o]=Nt[0],e[o+1]=Nt[1],e[o+2]=Nt[2];return e});function Xt(e){var t=e[0],n=e[1],r=e[2],a=e[3];return Math.hypot(t,n,r,a)}function Zt(e){var t=e[0],n=e[1],r=e[2],a=e[3];return t*t+n*n+r*r+a*a}!function(){var e,t=(e=new oe(4),oe!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e)}();function Jt(){var e=new oe(4);return oe!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function $t(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function en(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function tn(e,t){var n=2*Math.acos(t[3]),r=Math.sin(n/2);return r>ie?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n}function nn(e,t){var n=En(e,t);return Math.acos(2*n*n-1)}function rn(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],s=n[0],c=n[1],u=n[2],d=n[3];return e[0]=r*d+o*s+a*u-i*c,e[1]=a*d+o*c+i*s-r*u,e[2]=i*d+o*u+r*c-a*s,e[3]=o*d-r*s-a*c-i*u,e}function an(e,t,n){n*=.5;var r=t[0],a=t[1],i=t[2],o=t[3],s=Math.sin(n),c=Math.cos(n);return e[0]=r*c+o*s,e[1]=a*c+i*s,e[2]=i*c-a*s,e[3]=o*c-r*s,e}function on(e,t,n){n*=.5;var r=t[0],a=t[1],i=t[2],o=t[3],s=Math.sin(n),c=Math.cos(n);return e[0]=r*c-i*s,e[1]=a*c+o*s,e[2]=i*c+r*s,e[3]=o*c-a*s,e}function sn(e,t,n){n*=.5;var r=t[0],a=t[1],i=t[2],o=t[3],s=Math.sin(n),c=Math.cos(n);return e[0]=r*c+a*s,e[1]=a*c-r*s,e[2]=i*c+o*s,e[3]=o*c-i*s,e}function cn(e,t){var n=t[0],r=t[1],a=t[2];return e[0]=n,e[1]=r,e[2]=a,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-a*a)),e}function un(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=Math.sqrt(n*n+r*r+a*a),s=Math.exp(i),c=o>0?s*Math.sin(o)/o:0;return e[0]=n*c,e[1]=r*c,e[2]=a*c,e[3]=s*Math.cos(o),e}function dn(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=Math.sqrt(n*n+r*r+a*a),s=o>0?Math.atan2(o,i)/o:0;return e[0]=n*s,e[1]=r*s,e[2]=a*s,e[3]=.5*Math.log(n*n+r*r+a*a+i*i),e}function ln(e,t,n){return dn(e,t),An(e,e,n),un(e,e),e}function hn(e,t,n,r){var a,i,o,s,c,u=t[0],d=t[1],l=t[2],h=t[3],g=n[0],p=n[1],f=n[2],v=n[3];return(i=u*g+d*p+l*f+h*v)<0&&(i=-i,g=-g,p=-p,f=-f,v=-v),1-i>ie?(a=Math.acos(i),o=Math.sin(a),s=Math.sin((1-r)*a)/o,c=Math.sin(r*a)/o):(s=1-r,c=r),e[0]=s*u+c*g,e[1]=s*d+c*p,e[2]=s*l+c*f,e[3]=s*h+c*v,e}function gn(e){var t=se(),n=se(),r=se(),a=Math.sqrt(1-t),i=Math.sqrt(t);return e[0]=a*Math.sin(2*Math.PI*n),e[1]=a*Math.cos(2*Math.PI*n),e[2]=i*Math.sin(2*Math.PI*r),e[3]=i*Math.cos(2*Math.PI*r),e}function pn(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=n*n+r*r+a*a+i*i,s=o?1/o:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-a*s,e[3]=i*s,e}function fn(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function vn(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var a=0;t[4]>t[0]&&(a=1),t[8]>t[3*a+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;n=Math.sqrt(t[3*a+a]-t[3*i+i]-t[3*o+o]+1),e[a]=.5*n,n=.5/n,e[3]=(t[3*i+o]-t[3*o+i])*n,e[i]=(t[3*i+a]+t[3*a+i])*n,e[o]=(t[3*o+a]+t[3*a+o])*n}return e}function mn(e,t,n,r){var a=.5*Math.PI/180;t*=a,n*=a,r*=a;var i=Math.sin(t),o=Math.cos(t),s=Math.sin(n),c=Math.cos(n),u=Math.sin(r),d=Math.cos(r);return e[0]=i*c*d-o*s*u,e[1]=o*s*d+i*c*u,e[2]=o*c*u-i*s*d,e[3]=o*c*d+i*s*u,e}function wn(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var yn,bn,Mn,Sn,Cn,kn,xn,In=function(e){var t=new oe(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},Rn=function(e,t,n,r){var a=new oe(4);return a[0]=e,a[1]=t,a[2]=n,a[3]=r,a},Wn=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},Pn=function(e,t,n,r,a){return e[0]=t,e[1]=n,e[2]=r,e[3]=a,e},Tn=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},Dn=rn,An=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},En=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},On=function(e,t,n,r){var a=t[0],i=t[1],o=t[2],s=t[3];return e[0]=a+r*(n[0]-a),e[1]=i+r*(n[1]-i),e[2]=o+r*(n[2]-o),e[3]=s+r*(n[3]-s),e},jn=Xt,qn=jn,Ln=Zt,Vn=Ln,Fn=function(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=n*n+r*r+a*a+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=n*o,e[1]=r*o,e[2]=a*o,e[3]=i*o,e},Un=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},Nn=function(e,t){var n=e[0],r=e[1],a=e[2],i=e[3],o=t[0],s=t[1],c=t[2],u=t[3];return Math.abs(n-o)<=ie*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=ie*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-c)<=ie*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(i-u)<=ie*Math.max(1,Math.abs(i),Math.abs(u))},Bn=(yn=tt(),bn=at(1,0,0),Mn=at(0,1,0),function(e,t,n){var r=kt(t,n);return r<-.999999?(xt(yn,bn,t),Yt(yn)<1e-6&&xt(yn,Mn,t),Ct(yn,yn),en(e,yn,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(xt(yn,t,n),e[0]=yn[0],e[1]=yn[1],e[2]=yn[2],e[3]=1+r,Fn(e,e))}),Gn=(Sn=Jt(),Cn=Jt(),function(e,t,n,r,a,i){return hn(Sn,t,a,i),hn(Cn,n,r,i),hn(e,Sn,Cn,2*i*(1-i)),e}),Hn=(kn=new oe(9),oe!=Float32Array&&(kn[1]=0,kn[2]=0,kn[3]=0,kn[5]=0,kn[6]=0,kn[7]=0),kn[0]=1,kn[4]=1,kn[8]=1,xn=kn,function(e,t,n,r){return xn[0]=n[0],xn[3]=n[1],xn[6]=n[2],xn[1]=r[0],xn[4]=r[1],xn[7]=r[2],xn[2]=-t[0],xn[5]=-t[1],xn[8]=-t[2],Fn(e,vn(e,xn))});function _n(){var e=new oe(2);return oe!=Float32Array&&(e[0]=0,e[1]=0),e}function zn(e){var t=new oe(2);return t[0]=e[0],t[1]=e[1],t}function Yn(e,t){var n=new oe(2);return n[0]=e,n[1]=t,n}function Qn(e,t){return e[0]=t[0],e[1]=t[1],e}function Kn(e,t,n){return e[0]=t,e[1]=n,e}function Xn(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function Zn(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function Jn(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}function $n(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}function er(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function tr(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function nr(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}function rr(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}function ar(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function ir(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function or(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e}function sr(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.hypot(n,r)}function cr(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function ur(e){var t=e[0],n=e[1];return Math.hypot(t,n)}function dr(e){var t=e[0],n=e[1];return t*t+n*n}function lr(e,t){return e[0]=-t[0],e[1]=-t[1],e}function hr(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function gr(e,t){var n=t[0],r=t[1],a=n*n+r*r;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e}function pr(e,t){return e[0]*t[0]+e[1]*t[1]}function fr(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e}function vr(e,t,n,r){var a=t[0],i=t[1];return e[0]=a+r*(n[0]-a),e[1]=i+r*(n[1]-i),e}function mr(e,t){t=t||1;var n=2*se()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e}function wr(e,t,n){var r=t[0],a=t[1];return e[0]=n[0]*r+n[2]*a,e[1]=n[1]*r+n[3]*a,e}function yr(e,t,n){var r=t[0],a=t[1];return e[0]=n[0]*r+n[2]*a+n[4],e[1]=n[1]*r+n[3]*a+n[5],e}function br(e,t,n){var r=t[0],a=t[1];return e[0]=n[0]*r+n[3]*a+n[6],e[1]=n[1]*r+n[4]*a+n[7],e}function Mr(e,t,n){var r=t[0],a=t[1];return e[0]=n[0]*r+n[4]*a+n[12],e[1]=n[1]*r+n[5]*a+n[13],e}function Sr(e,t,n,r){var a=t[0]-n[0],i=t[1]-n[1],o=Math.sin(r),s=Math.cos(r);return e[0]=a*s-i*o+n[0],e[1]=a*o+i*s+n[1],e}function Cr(e,t){var n=e[0],r=e[1],a=t[0],i=t[1],o=n*n+r*r;o>0&&(o=1/Math.sqrt(o));var s=a*a+i*i;s>0&&(s=1/Math.sqrt(s));var c=(n*a+r*i)*o*s;return c>1?0:c<-1?Math.PI:Math.acos(c)}function kr(e){return e[0]=0,e[1]=0,e}function xr(e){return"vec2("+e[0]+", "+e[1]+")"}function Ir(e,t){return e[0]===t[0]&&e[1]===t[1]}function Rr(e,t){var n=e[0],r=e[1],a=t[0],i=t[1];return Math.abs(n-a)<=ie*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-i)<=ie*Math.max(1,Math.abs(r),Math.abs(i))}var Wr=ur,Pr=Zn,Tr=Jn,Dr=$n,Ar=sr,Er=cr,Or=dr,jr=function(){var e=_n();return function(t,n,r,a,i,o){var s,c;for(n||(n=2),r||(r=0),c=a?Math.min(a*n+r,t.length):t.length,s=r;s<c;s+=n)e[0]=t[s],e[1]=t[s+1],i(e,e,o),t[s]=e[0],t[s+1]=e[1];return t}}();function qr(e){return e*Math.PI/180}var Lr={VIEWPORT_ROTATED:"viewportRotated"};function Vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vr(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ur(e){if("number"!=typeof e||e!==Number(e)||!Number.isFinite(e))throw"Invalid number ".concat(e)}var Nr=function e(t){var n=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;p()(this,e),I()(this,"_state",null),I()(this,"eventWindow",void 0),I()(this,"getEventWindow",(function(){return n.eventWindow})),I()(this,"_rotate",(function(e,t,o,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;Ur(o),Ur(s),Ur(c);var u=[];a.cross(u,e,t),a.normalize(u,u);var d=e,l=[],h=[],g=r.create();if(r.rotate(g,g,qr(s),d),r.rotate(g,g,qr(o),u),a.transformMat4(l,t,g),a.transformMat4(h,e,g),0!==c){var p=i.create();i.setAxisAngle(p,l,qr(-c)),i.normalize(p,p),a.transformQuat(h,h,p)}n._state.cache.sliceNormal=l,n._state.cache.viewUp=h;var f=new CustomEvent(Lr.VIEWPORT_ROTATED,{detail:{sliceNormal:l,sliceViewUp:h,dThetaX:o,dThetaY:s,dThetaZ:c},bubbles:!0,cancelable:!0});n.eventWindow.dispatchEvent(f)})),I()(this,"rotateAbsolute",(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;n._rotate(n._state.viewUp,n._state.sliceNormal,e,t,r)})),I()(this,"rotateRelative",(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;n._rotate(n._state.cache.viewUp,n._state.cache.sliceNormal,e,t,r)})),I()(this,"setOrientation",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,1,0];n._state.sliceNormal=h()(e),n._state.viewUp=h()(t),n._state.cache.sliceNormal=h()(e),n._state.cache.viewUp=h()(t)})),I()(this,"getViewUp",(function(){return n._state.viewUp})),I()(this,"getSliceNormal",(function(){return n._state.sliceNormal})),I()(this,"getCurrentViewUp",(function(){return n._state.cache.viewUp})),I()(this,"getCurrentSliceNormal",(function(){return n._state.cache.sliceNormal})),I()(this,"getReadOnlyViewPort",(function(){var e=JSON.parse(JSON.stringify(n._state));return Object.freeze(e),e})),this.eventWindow=t,null===this._state?this._state={viewUp:[0,1,0],sliceNormal:[0,0,1]}:this._state=JSON.parse(JSON.stringify(o)),this._state.cache=Fr({},this._state)},Br=ae.a.States;function Gr(e,t,n){return e<t?t:e>n?n:e}function Hr(e,t){t.classHierarchy.push("vtkInteractorStyleMPRSlice"),t.trackballManipulator=Q.a.newInstance({button:1}),t.panManipulator=X.a.newInstance({button:2}),t.zoomManipulator=J.a.newInstance({button:3}),t.scrollManipulator=ee.a.newInstance({scrollEnabled:!0,dragEnabled:!1});var n={sliceNormal:[0,0,0],sliceRange:[0,0],sliceCenter:[]};function r(e){i(e.detail.sliceNormal),a(e.detail.sliceViewUp)}function a(e){var n=t.interactor.getCurrentRenderer().getActiveCamera();n.setViewUp.apply(n,h()(e))}function i(n){var r=t.interactor.getCurrentRenderer().getActiveCamera(),a=h()(n);if(t.volumeActor){B.a.normalize(a);var i=r.getFocalPoint(),o=r.getDistance(),s=r.getViewAngle();if(!function(e){var t=e.getDistance();return"number"==typeof t&&t===Number(t)&&Number.isFinite(t)}(r)){var c=t.volumeActor.getMapper().getBounds(),u=Math.sqrt(B.a.distance2BetweenPoints([c[0],c[2],c[4]],[c[1],c[3],c[5]]));i=[(c[0]+c[1])/2,(c[2]+c[3])/2,(c[4]+c[5])/2],s=90,o=u/(2*Math.tan(s/360*Math.PI))}var d=[i[0]-a[0]*o,i[1]-a[1]*o,i[2]-a[2]*o];r.setPosition.apply(r,d),r.setDistance(o),r.setDirectionOfProjection.apply(r,h()(a)),r.setViewAngle(s),r.setThicknessFromFocalPoint(t.slabThickness),e.setCenterOfRotation(i)}}e.updateScrollManipulator=function(){var n=e.getSliceRange();t.scrollManipulator.removeScrollListener(),t.scrollManipulator.setScrollListener(n[0],n[1],1,e.getSlice,e.scrollToSlice)},e.setViewport=function(e){t.viewportData&&t.viewportData.getEventWindow().removeEventListener(Lr.VIEWPORT_ROTATED,r);t.viewportData=e,t.scrollManipulator.setViewportData&&t.scrollManipulator.setViewportData(e),e&&(i(e.getCurrentSliceNormal()),a(e.getCurrentViewUp()),e.getEventWindow().addEventListener(Lr.VIEWPORT_ROTATED,r))},e.getViewport=function(){return t.viewportData};var o=null,s=null,c=e.setInteractor;function u(n){var r=t.apis,a=t.apiIndex;if(r&&r[a]&&"VIEW2D"===r[a].type){e.startPan();var i=r[a];i.svgWidgets.crosshairsWidget&&i.svgWidgets.crosshairsWidget.updateCrosshairForApi(i),i.svgWidgets.rotatableCrosshairsWidget&&d()}}function d(){var e=t.apis,n=t.apiIndex,r=e[n],a=r.svgWidgets.rotatableCrosshairsWidget,i=r.get("cachedCrosshairWorldPosition");a.moveCrosshairs(i,e,n)}e.setInteractor=function(n){if(c(n),o&&(o.unsubscribe(),o=null),s&&(s.unsubscribe(),s=null),n){var r=n.getCurrentRenderer().getActiveCamera();o=r.onModified((function(){e.updateScrollManipulator(),e.modified()})),s=n.onAnimation((function(){r.setThicknessFromFocalPoint(t.slabThickness)}));var a=t.interactor.getContainer();e.setViewport(new Nr(a))}else e.setViewport(null)},e.handleMiddleButtonPress=U.a.chain(e.handleMiddleButtonPress,u),e.handleRightButtonPress=U.a.chain(e.handleRightButtonPress,u);var l=e.handleMouseMove;function g(n,r){if(t.state===Br.IS_PAN){e.endPan();var a=t.apis[t.apiIndex];a.svgWidgets.crosshairsWidget&&a.svgWidgets.crosshairsWidget.updateCrosshairForApi(a),a.svgWidgets.rotatableCrosshairsWidget&&d()}n()}e.handleMouseMove=function(e){if(l&&l(e),t.apis[t.apiIndex].genericRenderWindow.getRenderer().getActiveCamera().setThicknessFromFocalPoint(t.slabThickness),t.state===Br.IS_PAN){var n=t.apis[t.apiIndex];n.svgWidgets.crosshairsWidget&&n.svgWidgets.crosshairsWidget.updateCrosshairForApi(n),n.svgWidgets.rotatableCrosshairsWidget&&d()}},e.superHandleMiddleButtonRelease=e.handleMiddleButtonRelease,e.handleMiddleButtonRelease=function(t){g(e.superHandleMiddleButtonRelease)},e.superHandleRightButtonRelease=e.handleRightButtonRelease,e.handleRightButtonRelease=function(t){g(e.superHandleRightButtonRelease)},e.setVolumeActor=function(n){t.volumeActor=n;var r=t.interactor.getCurrentRenderer().getActiveCamera();if(n){r.setFreezeFocalPoint(!0);var o=e.getViewport();o&&(i(o.getCurrentSliceNormal()),a(o.getCurrentViewUp())),e.updateScrollManipulator()}else r.setFreezeFocalPoint(!1)},e.getSlice=function(){var n=t.interactor.getCurrentRenderer().getActiveCamera(),r=e.getSliceNormal(),a=H.a.buildFromDegree().identity().rotateFromDirections(r,[1,0,0]),i=n.getFocalPoint();return a.apply(i),i[0]},e.scrollToSlice=function(t){var n=new CustomEvent("vtkscrollevent",{detail:{uid:e.getUid()}});window.dispatchEvent(n);var r=e.setSlice(t),a=e.getOnScroll();a&&a({slicePoint:r})},t.onScroll=function(){var e=t.apis,n=t.apiIndex;if(e&&e[n]&&"VIEW2D"===e[n].type){var r=e[n];if(!r.svgWidgets.crosshairsWidget&&!r.svgWidgets.rotatableCrosshairsWidget)return;var a=r.genericRenderWindow.getRenderer(),i=r.get("cachedCrosshairWorldPosition");if(void 0===i)return;var o=ne.a.newInstance();o.setCoordinateSystemToWorld(),o.setValue.apply(o,h()(i));var s=o.getComputedDoubleDisplayValue(a),c=ne.a.newInstance();c.setCoordinateSystemToDisplay(),c.setValue(s[0],s[1],0);for(var u=c.getComputedWorldValue(a),d=a.getActiveCamera().getDirectionOfProjection(),l=r.getSlabThickness()/2,g=0;g<u.length;g++)u[g]+=l*d[g];r.svgWidgets.crosshairsWidget&&r.svgWidgets.crosshairsWidget.moveCrosshairs(u,e,n),r.svgWidgets.rotatableCrosshairsWidget&&r.svgWidgets.rotatableCrosshairsWidget.moveCrosshairs(u,e,n)}},e.setSlice=function(r){var a=t.interactor.getCurrentRenderer().getActiveCamera();if(t.volumeActor){var i=e.getSliceRange(),o=t.volumeActor.getMapper().getBounds(),s=Gr.apply(void 0,[r].concat(h()(i))),c=[0,0,0];if(n.sliceCenter.length){var u=a.getFocalPoint();B.a.subtract(u,n.sliceCenter,c)}var d=[(o[0]+o[1])/2,(o[2]+o[3])/2,(o[4]+o[5])/2],l=a.getDistance(),g=a.getDirectionOfProjection();B.a.normalize(g);var p=(i[1]+i[0])/2,f=[d[0]-g[0]*p,d[1]-g[1]*p,d[2]-g[2]*p],v=[f[0]+g[0]*s,f[1]+g[1]*s,f[2]+g[2]*s];n.sliceCenter=[].concat(v);var m=[v[0]-g[0]*l,v[1]-g[1]*l,v[2]-g[2]*l];return B.a.add(v,c,v),B.a.add(m,c,m),a.setPosition.apply(a,m),a.setFocalPoint.apply(a,v),v}},e.getSliceRange=function(){if(t.volumeActor){var r=e.getSliceNormal();if(r[0]===n.sliceNormal[0]&&r[1]===n.sliceNormal[1]&&r[2]===n.sliceNormal[2])return n.sliceRange;var a=function(e){return[[e[0],e[2],e[4]],[e[0],e[2],e[5]],[e[0],e[3],e[4]],[e[0],e[3],e[5]],[e[1],e[2],e[4]],[e[1],e[2],e[5]],[e[1],e[3],e[4]],[e[1],e[3],e[5]]]}(t.volumeActor.getMapper().getBounds()),i=H.a.buildFromDegree().identity().rotateFromDirections(r,[1,0,0]);a.forEach((function(e){return i.apply(e)}));for(var o=1/0,s=-1/0,c=0;c<8;c++){var u=a[c][0];u>s&&(s=u),u<o&&(o=u)}return n.sliceNormal=r,n.sliceRange=[o,s],n.sliceRange}return[0,0]},e.getSliceNormal=function(){return t.volumeActor&&t.interactor?t.interactor.getCurrentRenderer().getActiveCamera().getDirectionOfProjection():[0,0,0]},e.setSliceNormal=function(){for(var t=e.getViewport(),n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];t&&t.setOrientation(r,t.getCurrentViewUp()),i(r)},e.getViewUp=function(){return t.volumeActor&&t.interactor?t.interactor.getCurrentRenderer().getActiveCamera().getViewUp():[0,0,0]},e.setViewUp=function(){for(var t=e.getViewport(),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t&&t.setOrientation(t.getSliceNormal(),r),a(r)},e.setSliceOrientation=function(t,n){var r=e.getViewport();r&&r.setOrientation(t,n),i(t),a(n)},e.setSlabThickness=function(e){t.slabThickness=e,t.interactor.getCurrentRenderer().getActiveCamera().setThicknessFromFocalPoint(e)},e.setUid=function(e){t.uid=e},e.getUid=function(){return t.uid},e.removeAllMouseManipulators(),e.addMouseManipulator(t.trackballManipulator),e.addMouseManipulator(t.panManipulator),e.addMouseManipulator(t.zoomManipulator),e.addMouseManipulator(t.scrollManipulator),e.updateScrollManipulator()}var _r={slabThickness:.1,uid:""};function zr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,_r,n),z.a.extend(e,t,n),U.a.setGet(e,t,["onScroll"]),U.a.get(e,t,["slabThickness","volumeActor","apis","apiIndex"]),Hr(e,t)}var Yr=U.a.newInstance(zr,"vtkInteractorStyleMPRSlice"),Qr=Object.assign({newInstance:Yr,extend:zr});var Kr=n(26),Xr=n.n(Kr),Zr=n(27),Jr=n.n(Zr),$r=U.a.vtkErrorMacro,ea=1;function ta(e,t){var n,r;t.classHierarchy.push("vtkSVGWidgetManager"),t.widgetId="vtkSVGWidgetManager-".concat(ea++),t.svgRootNode=(n=t.widgetId,(r=document.createElement("svg")).setAttribute("id",n),r.setAttribute("style","position: absolute; top: 0; left: 0; width: 100%; height: 100%;"),r.setAttribute("version","1.1"),r.setAttribute("xmlns","http://www.w3.org/2000/svg"),r),t.widgets=[],e.setRenderer=function(n){var r=n.getRenderWindow().getInteractor();t.openGLRenderWindow=r.getView(),e.setContainer(t.openGLRenderWindow.getReferenceByName("el"))},e.setContainer=function(n){t.container&&t.container!==n&&(t.svgRootNode.parentNode===t.container?t.container.removeChild(t.svgRootNode):$r("Error: SVG parent node does not match container")),t.container!==n&&(t.container=n,t.container&&t.container.appendChild(t.svgRootNode),e.modified())},e.getSize=function(){return t.openGLRenderWindow.getSize()},e.addWidget=function(n){-1===t.widgets.indexOf(n)&&t.widgets.push(n),e.render()},e.removeWidget=function(n){var r=n.getWidgetId(),a=t.svgRootNode.querySelector("#".concat(r));t.svgRootNode.removeChild(a);var i=t.widgets.indexOf(n);-1!==i&&t.widgets.splice(i,1),e.render()},e.render=function(){t.svgRootNode&&requestAnimationFrame((function(){var n=t.scale,r=e.getSize(),a=d()(r,2),i=a[0],o=a[1];t.svgRootNode.setAttribute("viewBox","0 0 ".concat(i*n," ").concat(o*n)),t.svgRootNode.setAttribute("width","".concat(i*n)),t.svgRootNode.setAttribute("height","".concat(o*n));for(var s=0;s<t.widgets.length;s++)t.widgets[s].render(t.svgRootNode,t.scale)}))}}var na={scale:.5};function ra(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,na,n),U.a.obj(e,t),U.a.get(e,t,["container"]),U.a.setGet(e,t,["scale"]),ta(e,t)}var aa={newInstance:U.a.newInstance(ra,"vtkSVGWidgetManager"),extend:ra};var ia={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function oa(e){return function(t){var n=t||{},r=n.width?String(n.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}var sa={date:oa({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:oa({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:oa({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},ca={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function ua(e){return function(t,n){var r,a=n||{};if("formatting"===(a.context?String(a.context):"standalone")&&e.formattingValues){var i=e.defaultFormattingWidth||e.defaultWidth,o=a.width?String(a.width):i;r=e.formattingValues[o]||e.formattingValues[i]}else{var s=e.defaultWidth,c=a.width?String(a.width):e.defaultWidth;r=e.values[c]||e.values[s]}return r[e.argumentCallback?e.argumentCallback(t):t]}}function da(e){return function(t,n){var r=String(t),a=n||{},i=a.width,o=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],s=r.match(o);if(!s)return null;var c,u=s[0],d=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth];return c="[object Array]"===Object.prototype.toString.call(d)?function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n}(d,(function(e){return e.test(r)})):function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n]))return n}(d,(function(e){return e.test(r)})),c=e.valueCallback?e.valueCallback(c):c,{value:c=a.valueCallback?a.valueCallback(c):c,rest:r.slice(u.length)}}}var la,ha={code:"en-US",formatDistance:function(e,t,n){var r;return n=n||{},r="string"==typeof ia[e]?ia[e]:1===t?ia[e].one:ia[e].other.replace("{{count}}",t),n.addSuffix?n.comparison>0?"in "+r:r+" ago":r},formatLong:sa,formatRelative:function(e,t,n,r){return ca[e]},localize:{ordinalNumber:function(e,t){var n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:ua({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:ua({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return Number(e)-1}}),month:ua({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:ua({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:ua({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(la={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}},function(e,t){var n=String(e),r=t||{},a=n.match(la.matchPattern);if(!a)return null;var i=a[0],o=n.match(la.parsePattern);if(!o)return null;var s=la.valueCallback?la.valueCallback(o[0]):o[0];return{value:s=r.valueCallback?r.valueCallback(s):s,rest:n.slice(i.length)}}),era:da({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:da({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:da({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:da({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:da({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function ga(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function pa(e){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function fa(e,t){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");return function(e,t){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var n=pa(e).getTime(),r=ga(t);return new Date(n+r)}(e,-ga(t))}function va(e,t){if(null==e)throw new TypeError("assign requires that input parameter not be null or undefined");for(var n in t=t||{})t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function ma(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}}function wa(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}}var ya={p:wa,P:function(e,t){var n,r=e.match(/(P+)(p+)?/),a=r[1],i=r[2];if(!i)return ma(e,t);switch(a){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;case"PPPP":default:n=t.dateTime({width:"full"})}return n.replace("{{date}}",ma(a,t)).replace("{{time}}",wa(i,t))}},ba=6e4;function Ma(e){var t=new Date(e.getTime()),n=Math.ceil(t.getTimezoneOffset());t.setSeconds(0,0);var r=t.getTime()%ba;return n*ba+r}var Sa=["D","DD"],Ca=["YY","YYYY"];function ka(e){return-1!==Sa.indexOf(e)}function xa(e){return-1!==Ca.indexOf(e)}function Ia(e){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` for formatting years; see: https://git.io/fxCyr");if("YY"===e)throw new RangeError("Use `yy` instead of `YY` for formatting years; see: https://git.io/fxCyr");if("D"===e)throw new RangeError("Use `d` instead of `D` for formatting days of the month; see: https://git.io/fxCyr");if("DD"===e)throw new RangeError("Use `dd` instead of `DD` for formatting days of the month; see: https://git.io/fxCyr")}function Ra(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=t||{},r=n.locale,a=r&&r.options&&r.options.weekStartsOn,i=null==a?0:ga(a),o=null==n.weekStartsOn?i:ga(n.weekStartsOn);if(!(o>=0&&o<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var s=pa(e),c=s.getUTCDay(),u=(c<o?7:0)+c-o;return s.setUTCDate(s.getUTCDate()-u),s.setUTCHours(0,0,0,0),s}function Wa(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=pa(e,t),r=n.getUTCFullYear(),a=t||{},i=a.locale,o=i&&i.options&&i.options.firstWeekContainsDate,s=null==o?1:ga(o),c=null==a.firstWeekContainsDate?s:ga(a.firstWeekContainsDate);if(!(c>=1&&c<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var u=new Date(0);u.setUTCFullYear(r+1,0,c),u.setUTCHours(0,0,0,0);var d=Ra(u,t),l=new Date(0);l.setUTCFullYear(r,0,c),l.setUTCHours(0,0,0,0);var h=Ra(l,t);return n.getTime()>=d.getTime()?r+1:n.getTime()>=h.getTime()?r:r-1}function Pa(e,t,n){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var r=n||{},a=r.locale,i=a&&a.options&&a.options.weekStartsOn,o=null==i?0:ga(i),s=null==r.weekStartsOn?o:ga(r.weekStartsOn);if(!(s>=0&&s<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var c=pa(e),u=ga(t),d=((u%7+7)%7<s?7:0)+u-c.getUTCDay();return c.setUTCDate(c.getUTCDate()+d),c}function Ta(e){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var t=pa(e),n=t.getUTCDay(),r=(n<1?7:0)+n-1;return t.setUTCDate(t.getUTCDate()-r),t.setUTCHours(0,0,0,0),t}function Da(e){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var t=pa(e),n=t.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(n+1,0,4),r.setUTCHours(0,0,0,0);var a=Ta(r),i=new Date(0);i.setUTCFullYear(n,0,4),i.setUTCHours(0,0,0,0);var o=Ta(i);return t.getTime()>=a.getTime()?n+1:t.getTime()>=o.getTime()?n:n-1}var Aa=6048e5;function Ea(e){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var t=pa(e),n=Ta(t).getTime()-function(e){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var t=Da(e),n=new Date(0);return n.setUTCFullYear(t,0,4),n.setUTCHours(0,0,0,0),Ta(n)}(t).getTime();return Math.round(n/Aa)+1}var Oa=6048e5;function ja(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=pa(e),r=Ra(n,t).getTime()-function(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=t||{},r=n.locale,a=r&&r.options&&r.options.firstWeekContainsDate,i=null==a?1:ga(a),o=null==n.firstWeekContainsDate?i:ga(n.firstWeekContainsDate),s=Wa(e,t),c=new Date(0);return c.setUTCFullYear(s,0,o),c.setUTCHours(0,0,0,0),Ra(c,t)}(n,t).getTime();return Math.round(r/Oa)+1}var qa=36e5,La=6e4,Va=1e3,Fa={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Ua=/^([+-])(\d{2})(\d{2})?|Z/,Na=/^([+-])(\d{2})(\d{2})|Z/,Ba=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,Ga=/^([+-])(\d{2}):(\d{2})|Z/,Ha=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function _a(e,t,n){var r=t.match(e);if(!r)return null;var a=parseInt(r[0],10);return{value:n?n(a):a,rest:t.slice(r[0].length)}}function za(e,t){var n=t.match(e);if(!n)return null;if("Z"===n[0])return{value:0,rest:t.slice(1)};var r="+"===n[1]?1:-1,a=n[2]?parseInt(n[2],10):0,i=n[3]?parseInt(n[3],10):0,o=n[5]?parseInt(n[5],10):0;return{value:r*(a*qa+i*La+o*Va),rest:t.slice(n[0].length)}}function Ya(e,t){return _a(Fa.anyDigitsSigned,e,t)}function Qa(e,t,n){switch(e){case 1:return _a(Fa.singleDigit,t,n);case 2:return _a(Fa.twoDigits,t,n);case 3:return _a(Fa.threeDigits,t,n);case 4:return _a(Fa.fourDigits,t,n);default:return _a(new RegExp("^\\d{1,"+e+"}"),t,n)}}function Ka(e,t,n){switch(e){case 1:return _a(Fa.singleDigitSigned,t,n);case 2:return _a(Fa.twoDigitsSigned,t,n);case 3:return _a(Fa.threeDigitsSigned,t,n);case 4:return _a(Fa.fourDigitsSigned,t,n);default:return _a(new RegExp("^-?\\d{1,"+e+"}"),t,n)}}function Xa(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Za(e,t){var n,r=t>0,a=r?t:1-t;if(a<=50)n=e||100;else{var i=a+50;n=e+100*Math.floor(i/100)-(e>=i%100?100:0)}return r?n:1-n}var Ja=[31,28,31,30,31,30,31,31,30,31,30,31],$a=[31,29,31,30,31,30,31,31,30,31,30,31];function ei(e){return e%400==0||e%4==0&&e%100!=0}var ti={G:{priority:140,parse:function(e,t,n,r){switch(t){case"G":case"GG":case"GGG":return n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"});case"GGGGG":return n.era(e,{width:"narrow"});case"GGGG":default:return n.era(e,{width:"wide"})||n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"})}},set:function(e,t,n,r){return t.era=n,e.setUTCFullYear(n,0,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["R","u","t","T"]},y:{priority:130,parse:function(e,t,n,r){var a=function(e){return{year:e,isTwoDigitYear:"yy"===t}};switch(t){case"y":return Qa(4,e,a);case"yo":return n.ordinalNumber(e,{unit:"year",valueCallback:a});default:return Qa(t.length,e,a)}},validate:function(e,t,n){return t.isTwoDigitYear||t.year>0},set:function(e,t,n,r){var a=e.getUTCFullYear();if(n.isTwoDigitYear){var i=Za(n.year,a);return e.setUTCFullYear(i,0,1),e.setUTCHours(0,0,0,0),e}var o="era"in t&&1!==t.era?1-n.year:n.year;return e.setUTCFullYear(o,0,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","u","w","I","i","e","c","t","T"]},Y:{priority:130,parse:function(e,t,n,r){var a=function(e){return{year:e,isTwoDigitYear:"YY"===t}};switch(t){case"Y":return Qa(4,e,a);case"Yo":return n.ordinalNumber(e,{unit:"year",valueCallback:a});default:return Qa(t.length,e,a)}},validate:function(e,t,n){return t.isTwoDigitYear||t.year>0},set:function(e,t,n,r){var a=Wa(e,r);if(n.isTwoDigitYear){var i=Za(n.year,a);return e.setUTCFullYear(i,0,r.firstWeekContainsDate),e.setUTCHours(0,0,0,0),Ra(e,r)}var o="era"in t&&1!==t.era?1-n.year:n.year;return e.setUTCFullYear(o,0,r.firstWeekContainsDate),e.setUTCHours(0,0,0,0),Ra(e,r)},incompatibleTokens:["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},R:{priority:130,parse:function(e,t,n,r){return Ka("R"===t?4:t.length,e)},set:function(e,t,n,r){var a=new Date(0);return a.setUTCFullYear(n,0,4),a.setUTCHours(0,0,0,0),Ta(a)},incompatibleTokens:["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},u:{priority:130,parse:function(e,t,n,r){return Ka("u"===t?4:t.length,e)},set:function(e,t,n,r){return e.setUTCFullYear(n,0,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["G","y","Y","R","w","I","i","e","c","t","T"]},Q:{priority:120,parse:function(e,t,n,r){switch(t){case"Q":case"QQ":return Qa(t.length,e);case"Qo":return n.ordinalNumber(e,{unit:"quarter"});case"QQQ":return n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(e,{width:"wide",context:"formatting"})||n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,n){return t>=1&&t<=4},set:function(e,t,n,r){return e.setUTCMonth(3*(n-1),1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},q:{priority:120,parse:function(e,t,n,r){switch(t){case"q":case"qq":return Qa(t.length,e);case"qo":return n.ordinalNumber(e,{unit:"quarter"});case"qqq":return n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(e,{width:"wide",context:"standalone"})||n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,n){return t>=1&&t<=4},set:function(e,t,n,r){return e.setUTCMonth(3*(n-1),1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},M:{priority:110,parse:function(e,t,n,r){var a=function(e){return e-1};switch(t){case"M":return _a(Fa.month,e,a);case"MM":return Qa(2,e,a);case"Mo":return n.ordinalNumber(e,{unit:"month",valueCallback:a});case"MMM":return n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(e,{width:"wide",context:"formatting"})||n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,n){return t>=0&&t<=11},set:function(e,t,n,r){return e.setUTCMonth(n,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]},L:{priority:110,parse:function(e,t,n,r){var a=function(e){return e-1};switch(t){case"L":return _a(Fa.month,e,a);case"LL":return Qa(2,e,a);case"Lo":return n.ordinalNumber(e,{unit:"month",valueCallback:a});case"LLL":return n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(e,{width:"wide",context:"standalone"})||n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,n){return t>=0&&t<=11},set:function(e,t,n,r){return e.setUTCMonth(n,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]},w:{priority:100,parse:function(e,t,n,r){switch(t){case"w":return _a(Fa.week,e);case"wo":return n.ordinalNumber(e,{unit:"week"});default:return Qa(t.length,e)}},validate:function(e,t,n){return t>=1&&t<=53},set:function(e,t,n,r){return Ra(function(e,t,n){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var r=pa(e),a=ga(t),i=ja(r,n)-a;return r.setUTCDate(r.getUTCDate()-7*i),r}(e,n,r),r)},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","i","t","T"]},I:{priority:100,parse:function(e,t,n,r){switch(t){case"I":return _a(Fa.week,e);case"Io":return n.ordinalNumber(e,{unit:"week"});default:return Qa(t.length,e)}},validate:function(e,t,n){return t>=1&&t<=53},set:function(e,t,n,r){return Ta(function(e,t){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var n=pa(e),r=ga(t),a=Ea(n)-r;return n.setUTCDate(n.getUTCDate()-7*a),n}(e,n,r),r)},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]},d:{priority:90,parse:function(e,t,n,r){switch(t){case"d":return _a(Fa.date,e);case"do":return n.ordinalNumber(e,{unit:"date"});default:return Qa(t.length,e)}},validate:function(e,t,n){var r=ei(e.getUTCFullYear()),a=e.getUTCMonth();return r?t>=1&&t<=$a[a]:t>=1&&t<=Ja[a]},set:function(e,t,n,r){return e.setUTCDate(n),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","w","I","D","i","e","c","t","T"]},D:{priority:90,parse:function(e,t,n,r){switch(t){case"D":case"DD":return _a(Fa.dayOfYear,e);case"Do":return n.ordinalNumber(e,{unit:"date"});default:return Qa(t.length,e)}},validate:function(e,t,n){return ei(e.getUTCFullYear())?t>=1&&t<=366:t>=1&&t<=365},set:function(e,t,n,r){return e.setUTCMonth(0,n),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]},E:{priority:90,parse:function(e,t,n,r){switch(t){case"E":case"EE":case"EEE":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,n){return t>=0&&t<=6},set:function(e,t,n,r){return(e=Pa(e,n,r)).setUTCHours(0,0,0,0),e},incompatibleTokens:["D","i","e","c","t","T"]},e:{priority:90,parse:function(e,t,n,r){var a=function(e){var t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return Qa(t.length,e,a);case"eo":return n.ordinalNumber(e,{unit:"day",valueCallback:a});case"eee":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeeee":return n.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,n){return t>=0&&t<=6},set:function(e,t,n,r){return(e=Pa(e,n,r)).setUTCHours(0,0,0,0),e},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},c:{priority:90,parse:function(e,t,n,r){var a=function(e){var t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return Qa(t.length,e,a);case"co":return n.ordinalNumber(e,{unit:"day",valueCallback:a});case"ccc":return n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"ccccc":return n.day(e,{width:"narrow",context:"standalone"});case"cccccc":return n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return n.day(e,{width:"wide",context:"standalone"})||n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,n){return t>=0&&t<=6},set:function(e,t,n,r){return(e=Pa(e,n,r)).setUTCHours(0,0,0,0),e},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]},i:{priority:90,parse:function(e,t,n,r){var a=function(e){return 0===e?7:e};switch(t){case"i":case"ii":return Qa(t.length,e);case"io":return n.ordinalNumber(e,{unit:"day"});case"iii":return n.day(e,{width:"abbreviated",context:"formatting",valueCallback:a})||n.day(e,{width:"short",context:"formatting",valueCallback:a})||n.day(e,{width:"narrow",context:"formatting",valueCallback:a});case"iiiii":return n.day(e,{width:"narrow",context:"formatting",valueCallback:a});case"iiiiii":return n.day(e,{width:"short",context:"formatting",valueCallback:a})||n.day(e,{width:"narrow",context:"formatting",valueCallback:a});case"iiii":default:return n.day(e,{width:"wide",context:"formatting",valueCallback:a})||n.day(e,{width:"abbreviated",context:"formatting",valueCallback:a})||n.day(e,{width:"short",context:"formatting",valueCallback:a})||n.day(e,{width:"narrow",context:"formatting",valueCallback:a})}},validate:function(e,t,n){return t>=1&&t<=7},set:function(e,t,n,r){return(e=function(e,t){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var n=ga(t);n%7==0&&(n-=7);var r=pa(e),a=((n%7+7)%7<1?7:0)+n-r.getUTCDay();return r.setUTCDate(r.getUTCDate()+a),r}(e,n,r)).setUTCHours(0,0,0,0),e},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},a:{priority:80,parse:function(e,t,n,r){switch(t){case"a":case"aa":case"aaa":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,n,r){return e.setUTCHours(Xa(n),0,0,0),e},incompatibleTokens:["b","B","H","K","k","t","T"]},b:{priority:80,parse:function(e,t,n,r){switch(t){case"b":case"bb":case"bbb":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,n,r){return e.setUTCHours(Xa(n),0,0,0),e},incompatibleTokens:["a","B","H","K","k","t","T"]},B:{priority:80,parse:function(e,t,n,r){switch(t){case"B":case"BB":case"BBB":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,n,r){return e.setUTCHours(Xa(n),0,0,0),e},incompatibleTokens:["a","b","t","T"]},h:{priority:70,parse:function(e,t,n,r){switch(t){case"h":return _a(Fa.hour12h,e);case"ho":return n.ordinalNumber(e,{unit:"hour"});default:return Qa(t.length,e)}},validate:function(e,t,n){return t>=1&&t<=12},set:function(e,t,n,r){var a=e.getUTCHours()>=12;return a&&n<12?e.setUTCHours(n+12,0,0,0):a||12!==n?e.setUTCHours(n,0,0,0):e.setUTCHours(0,0,0,0),e},incompatibleTokens:["H","K","k","t","T"]},H:{priority:70,parse:function(e,t,n,r){switch(t){case"H":return _a(Fa.hour23h,e);case"Ho":return n.ordinalNumber(e,{unit:"hour"});default:return Qa(t.length,e)}},validate:function(e,t,n){return t>=0&&t<=23},set:function(e,t,n,r){return e.setUTCHours(n,0,0,0),e},incompatibleTokens:["a","b","h","K","k","t","T"]},K:{priority:70,parse:function(e,t,n,r){switch(t){case"K":return _a(Fa.hour11h,e);case"Ko":return n.ordinalNumber(e,{unit:"hour"});default:return Qa(t.length,e)}},validate:function(e,t,n){return t>=0&&t<=11},set:function(e,t,n,r){return e.getUTCHours()>=12&&n<12?e.setUTCHours(n+12,0,0,0):e.setUTCHours(n,0,0,0),e},incompatibleTokens:["a","b","h","H","k","t","T"]},k:{priority:70,parse:function(e,t,n,r){switch(t){case"k":return _a(Fa.hour24h,e);case"ko":return n.ordinalNumber(e,{unit:"hour"});default:return Qa(t.length,e)}},validate:function(e,t,n){return t>=1&&t<=24},set:function(e,t,n,r){var a=n<=24?n%24:n;return e.setUTCHours(a,0,0,0),e},incompatibleTokens:["a","b","h","H","K","t","T"]},m:{priority:60,parse:function(e,t,n,r){switch(t){case"m":return _a(Fa.minute,e);case"mo":return n.ordinalNumber(e,{unit:"minute"});default:return Qa(t.length,e)}},validate:function(e,t,n){return t>=0&&t<=59},set:function(e,t,n,r){return e.setUTCMinutes(n,0,0),e},incompatibleTokens:["t","T"]},s:{priority:50,parse:function(e,t,n,r){switch(t){case"s":return _a(Fa.second,e);case"so":return n.ordinalNumber(e,{unit:"second"});default:return Qa(t.length,e)}},validate:function(e,t,n){return t>=0&&t<=59},set:function(e,t,n,r){return e.setUTCSeconds(n,0),e},incompatibleTokens:["t","T"]},S:{priority:30,parse:function(e,t,n,r){return Qa(t.length,e,(function(e){return Math.floor(e*Math.pow(10,3-t.length))}))},set:function(e,t,n,r){return e.setUTCMilliseconds(n),e},incompatibleTokens:["t","T"]},X:{priority:10,parse:function(e,t,n,r){switch(t){case"X":return za(Ua,e);case"XX":return za(Na,e);case"XXXX":return za(Ba,e);case"XXXXX":return za(Ha,e);case"XXX":default:return za(Ga,e)}},set:function(e,t,n,r){return t.timestampIsSet?e:new Date(e.getTime()-n)},incompatibleTokens:["t","T","x"]},x:{priority:10,parse:function(e,t,n,r){switch(t){case"x":return za(Ua,e);case"xx":return za(Na,e);case"xxxx":return za(Ba,e);case"xxxxx":return za(Ha,e);case"xxx":default:return za(Ga,e)}},set:function(e,t,n,r){return t.timestampIsSet?e:new Date(e.getTime()-n)},incompatibleTokens:["t","T","X"]},t:{priority:40,parse:function(e,t,n,r){return Ya(e)},set:function(e,t,n,r){return[new Date(1e3*n),{timestampIsSet:!0}]},incompatibleTokens:"*"},T:{priority:20,parse:function(e,t,n,r){return Ya(e)},set:function(e,t,n,r){return[new Date(n),{timestampIsSet:!0}]},incompatibleTokens:"*"}},ni=10,ri=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ai=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ii=/^'([^]*?)'?$/,oi=/''/g,si=/\S/,ci=/[a-zA-Z]/;function ui(e,t,n,r){if(arguments.length<3)throw new TypeError("3 arguments required, but only "+arguments.length+" present");var a=String(e),i=String(t),o=r||{},s=o.locale||ha;if(!s.match)throw new RangeError("locale must contain match property");var c=s.options&&s.options.firstWeekContainsDate,u=null==c?1:ga(c),d=null==o.firstWeekContainsDate?u:ga(o.firstWeekContainsDate);if(!(d>=1&&d<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var l=s.options&&s.options.weekStartsOn,h=null==l?0:ga(l),g=null==o.weekStartsOn?h:ga(o.weekStartsOn);if(!(g>=0&&g<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(""===i)return""===a?pa(n):new Date(NaN);var p,f={firstWeekContainsDate:d,weekStartsOn:g,locale:s},v=[{priority:ni,set:di,index:0}],m=i.match(ai).map((function(e){var t=e[0];return"p"===t||"P"===t?(0,ya[t])(e,s.formatLong,f):e})).join("").match(ri),w=[];for(p=0;p<m.length;p++){var y=m[p];!o.useAdditionalWeekYearTokens&&xa(y)&&Ia(y),!o.useAdditionalDayOfYearTokens&&ka(y)&&Ia(y);var b=y[0],M=ti[b];if(M){var S=M.incompatibleTokens;if(Array.isArray(S)){for(var C=void 0,k=0;k<w.length;k++){var x=w[k].token;if(-1!==S.indexOf(x)||x===b){C=w[k];break}}if(C)throw new RangeError("The format string mustn't contain `".concat(C.fullToken,"` and `").concat(y,"` at the same time"))}else if("*"===M.incompatibleTokens&&w.length)throw new RangeError("The format string mustn't contain `".concat(y,"` and any other token at the same time"));w.push({token:b,fullToken:y});var I=M.parse(a,y,s.match,f);if(!I)return new Date(NaN);v.push({priority:M.priority,set:M.set,validate:M.validate,value:I.value,index:v.length}),a=I.rest}else{if(b.match(ci))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");if("''"===y?y="'":"'"===b&&(y=y.match(ii)[1].replace(oi,"'")),0!==a.indexOf(y))return new Date(NaN);a=a.slice(y.length)}}if(a.length>0&&si.test(a))return new Date(NaN);var R=v.map((function(e){return e.priority})).sort((function(e,t){return t-e})).filter((function(e,t,n){return n.indexOf(e)===t})).map((function(e){return v.filter((function(t){return t.priority===e})).reverse()})).map((function(e){return e[0]})),W=pa(n);if(isNaN(W))return new Date(NaN);var P=fa(W,Ma(W)),T={};for(p=0;p<R.length;p++){var D=R[p];if(D.validate&&!D.validate(P,D.value,f))return new Date(NaN);var A=D.set(P,T,D.value,f);A[0]?(P=A[0],va(T,A[1])):P=A}return P}function di(e,t){if(t.timestampIsSet)return e;var n=new Date(0);return n.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),n.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),n}function li(e,t){for(var n=e<0?"-":"",r=Math.abs(e).toString();r.length<t;)r="0"+r;return n+r}var hi={y:function(e,t){var n=e.getUTCFullYear(),r=n>0?n:1-n;return li("yy"===t?r%100:r,t.length)},M:function(e,t){var n=e.getUTCMonth();return"M"===t?String(n+1):li(n+1,2)},d:function(e,t){return li(e.getUTCDate(),t.length)},a:function(e,t){var n=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":case"aaa":return n.toUpperCase();case"aaaaa":return n[0];case"aaaa":default:return"am"===n?"a.m.":"p.m."}},h:function(e,t){return li(e.getUTCHours()%12||12,t.length)},H:function(e,t){return li(e.getUTCHours(),t.length)},m:function(e,t){return li(e.getUTCMinutes(),t.length)},s:function(e,t){return li(e.getUTCSeconds(),t.length)},S:function(e,t){var n=t.length,r=e.getUTCMilliseconds();return li(Math.floor(r*Math.pow(10,n-3)),t.length)}},gi=864e5;var pi="midnight",fi="noon",vi="morning",mi="afternoon",wi="evening",yi="night";function bi(e,t){var n=e>0?"-":"+",r=Math.abs(e),a=Math.floor(r/60),i=r%60;if(0===i)return n+String(a);var o=t||"";return n+String(a)+o+li(i,2)}function Mi(e,t){return e%60==0?(e>0?"-":"+")+li(Math.abs(e)/60,2):Si(e,t)}function Si(e,t){var n=t||"",r=e>0?"-":"+",a=Math.abs(e);return r+li(Math.floor(a/60),2)+n+li(a%60,2)}var Ci={G:function(e,t,n){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){var r=e.getUTCFullYear(),a=r>0?r:1-r;return n.ordinalNumber(a,{unit:"year"})}return hi.y(e,t)},Y:function(e,t,n,r){var a=Wa(e,r),i=a>0?a:1-a;return"YY"===t?li(i%100,2):"Yo"===t?n.ordinalNumber(i,{unit:"year"}):li(i,t.length)},R:function(e,t){return li(Da(e),t.length)},u:function(e,t){return li(e.getUTCFullYear(),t.length)},Q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return li(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return li(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){var r=e.getUTCMonth();switch(t){case"M":case"MM":return hi.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return li(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){var a=ja(e,r);return"wo"===t?n.ordinalNumber(a,{unit:"week"}):li(a,t.length)},I:function(e,t,n){var r=Ea(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):li(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getUTCDate(),{unit:"date"}):hi.d(e,t)},D:function(e,t,n){var r=function(e){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var t=pa(e),n=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var r=n-t.getTime();return Math.floor(r/gi)+1}(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):li(r,t.length)},E:function(e,t,n){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){var a=e.getUTCDay(),i=(a-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return li(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){var a=e.getUTCDay(),i=(a-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return li(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,n){var r=e.getUTCDay(),a=0===r?7:r;switch(t){case"i":return String(a);case"ii":return li(a,t.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){var r,a=e.getUTCHours();switch(r=12===a?fi:0===a?pi:a/12>=1?"pm":"am",t){case"b":case"bb":case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){var r,a=e.getUTCHours();switch(r=a>=17?wi:a>=12?mi:a>=4?vi:yi,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){var r=e.getUTCHours()%12;return 0===r&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return hi.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getUTCHours(),{unit:"hour"}):hi.H(e,t)},K:function(e,t,n){var r=e.getUTCHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):li(r,t.length)},k:function(e,t,n){var r=e.getUTCHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):li(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):hi.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):hi.s(e,t)},S:function(e,t){return hi.S(e,t)},X:function(e,t,n,r){var a=(r._originalDate||e).getTimezoneOffset();if(0===a)return"Z";switch(t){case"X":return Mi(a);case"XXXX":case"XX":return Si(a);case"XXXXX":case"XXX":default:return Si(a,":")}},x:function(e,t,n,r){var a=(r._originalDate||e).getTimezoneOffset();switch(t){case"x":return Mi(a);case"xxxx":case"xx":return Si(a);case"xxxxx":case"xxx":default:return Si(a,":")}},O:function(e,t,n,r){var a=(r._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+bi(a,":");case"OOOO":default:return"GMT"+Si(a,":")}},z:function(e,t,n,r){var a=(r._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+bi(a,":");case"zzzz":default:return"GMT"+Si(a,":")}},t:function(e,t,n,r){var a=r._originalDate||e;return li(Math.floor(a.getTime()/1e3),t.length)},T:function(e,t,n,r){return li((r._originalDate||e).getTime(),t.length)}},ki=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,xi=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ii=/^'([^]*?)'?$/,Ri=/''/g,Wi=/[a-zA-Z]/;function Pi(e,t,n){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var r=String(t),a=n||{},i=a.locale||ha,o=i.options&&i.options.firstWeekContainsDate,s=null==o?1:ga(o),c=null==a.firstWeekContainsDate?s:ga(a.firstWeekContainsDate);if(!(c>=1&&c<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var u=i.options&&i.options.weekStartsOn,d=null==u?0:ga(u),l=null==a.weekStartsOn?d:ga(a.weekStartsOn);if(!(l>=0&&l<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!i.localize)throw new RangeError("locale must contain localize property");if(!i.formatLong)throw new RangeError("locale must contain formatLong property");var h=pa(e);if(!function(e){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var t=pa(e);return!isNaN(t)}(h))throw new RangeError("Invalid time value");var g=fa(h,Ma(h)),p={firstWeekContainsDate:c,weekStartsOn:l,locale:i,_originalDate:h};return r.match(xi).map((function(e){var t=e[0];return"p"===t||"P"===t?(0,ya[t])(e,i.formatLong,p):e})).join("").match(ki).map((function(e){if("''"===e)return"'";var t=e[0];if("'"===t)return e.match(Ii)[1].replace(Ri,"'");var n=Ci[t];if(n)return!a.useAdditionalWeekYearTokens&&xa(e)&&Ia(e),!a.useAdditionalDayOfYearTokens&&ka(e)&&Ia(e),n(g,e,i.localize,p);if(t.match(Wi))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return e})).join("")}function Ti(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))}var Di=function(e){if(e)return e.replace("^",", ").replace(/\^/g," ").trim()},Ai=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MMM D, YYYY";if(e)try{return Pi(ui(e,"yyyyMMdd",new Date),t)}catch(e){}},Ei=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"HH:mm:ss";if(e){try{return Pi(ui(e.toString().substring(0,"HHmmss.SSS".length),"HHmmss.SSS",new Date(0)),t)}catch(e){}return Pi(parsedDateTime,t)}},Oi=(n(64),Di),ji=Ai,qi=Ei,Li=function(e){function t(){return p()(this,t),w()(this,b()(t).apply(this,arguments))}return k()(t,e),v()(t,[{key:"render",value:function(){var e=this.props,t=e.studyDate,n=e.studyTime,r=e.studyDescription,a=e.patientName,i=e.patientId,o=e.seriesNumber,s=e.seriesDescription,c=e.voi,u=e.orientation,d=e.rotation,l=e.neswMetadata,h=e.slice,g=c.windowWidth,p=c.windowCenter,f="W: ".concat(g.toFixed(0)," L: ").concat(p.toFixed(0)),v=d?": ".concat(d.theta.toFixed(1)," : ").concat(d.phi.toFixed(1)):null,m="number"==typeof h?"Slice ".concat(h):"";return W.a.createElement("div",{className:"ViewportOverlay"},W.a.createElement("div",{className:"top-left overlay-element"},W.a.createElement("div",null,Oi(a)),W.a.createElement("div",null,i)),W.a.createElement("div",{className:"top-center overlay-element"},W.a.createElement("div",null,l.n)),W.a.createElement("div",{className:"top-right overlay-element"},W.a.createElement("div",null,r),W.a.createElement("div",null,ji(t)," ",qi(n))),W.a.createElement("div",{className:"center-left overlay-element"},W.a.createElement("div",null,l.w)),W.a.createElement("div",{className:"center-right overlay-element"},W.a.createElement("div",null,l.e)),W.a.createElement("div",{className:"bottom-right overlay-element"},W.a.createElement("div",null,f),W.a.createElement("div",null,v),W.a.createElement("div",null,u),W.a.createElement("div",null,m)),W.a.createElement("div",{className:"bottom-center overlay-element"},W.a.createElement("div",null,l.s)),W.a.createElement("div",{className:"bottom-left overlay-element"},W.a.createElement("div",null,o>=0?"Ser: ".concat(o):""),W.a.createElement("div",null,W.a.createElement("div",null,s))))}}]),t}(R.PureComponent);I()(Li,"propTypes",{voi:T.a.object.isRequired,orientation:T.a.string,rotation:T.a.object,neswMetadata:T.a.object,slice:T.a.number,studyDate:T.a.string,studyTime:T.a.string,studyDescription:T.a.string,patientName:T.a.string,patientId:T.a.string,seriesNumber:T.a.string,seriesDescription:T.a.string}),I()(Li,"defaultProps",{voi:{windowWidth:0,windowCenter:0},neswMetadata:{n:"",s:"",e:"",w:""}});var Vi=Li,Fi=n(28);function Ui(e){var t=e,n=function(){t&&(t.unsubscribe(),t=null)};return{sub:function(e){n(),t=e},unsubscribe:n}}var Ni=n(29),Bi=n.n(Ni),Gi=n(30),Hi=n.n(Gi),_i=n(40),zi=n.n(_i),Yi=n(41),Qi=n.n(Yi),Ki=n(42),Xi=n.n(Ki),Zi=n(43),Ji=n.n(Zi),$i=function(e,t,n){if(t)for(var r=Math.min(256,t.length),a=0;a<r;a++){var i=t[a];e.cfun.addRGBPoint(a,i[0]/255,i[1]/255,i[2]/255);var o=i[3]/255*n;e.ofun.addPointLong(a,o,.5,1)}};function eo(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=n.colorLUT,o=n.globalOpacity,s=n.visible,c=n.renderOutline,u=n.outlineThickness;if(void 0===s&&(s=!1),void 0===o&&(o=1),void 0===u&&(u=3),t)r=t;else{(r=Bi.a.newInstance(e.get("spacing","origin","direction"))).setDimensions(e.getDimensions()),r.computeTransforms();var d=new Uint8Array(e.getNumberOfPoints()),l=Hi.a.newInstance({numberOfComponents:1,values:d});r.getPointData().setScalars(l)}var h=Qi.a.newInstance();if(a){var g=.7*Math.sqrt(r.getSpacing().map((function(e){return e*e})).reduce((function(e,t){return e+t}),0));h.setSampleDistance(g)}var p={actor:zi.a.newInstance(),mapper:h,cfun:Xi.a.newInstance(),ofun:Ji.a.newInstance()};return p.actor.setMapper(p.mapper),p.actor.setVisibility(s),p.ofun.addPointLong(0,0,.5,1),p.ofun.addPointLong(1,1,.5,1),i?$i(p,i,o):(p.cfun.addRGBPoint(1,1,0,0),p.cfun.addRGBPoint(2,0,1,0),p.cfun.addRGBPoint(3,0,1,1),p.ofun.addPointLong(1,.5,.5,1)),p.actor.getProperty().setRGBTransferFunction(0,p.cfun),p.actor.getProperty().setScalarOpacity(0,p.ofun),p.actor.getProperty().setInterpolationTypeToNearest(),c&&(p.actor.getProperty().setUseLabelOutline(!0),p.actor.getProperty().setLabelOutlineThickness(u)),p.ofun.setClamping(!1),p.actor.getProperty().setScalarOpacityUnitDistance(0,.1),p.actor.getProperty().setUseGradientOpacity(0,!1),p}var to=A.a.importInternal("util/throttle"),no=360/(2*Math.PI),ro=function(e){function t(e){var n;return p()(this,t),n=w()(this,b()(t).call(this,e)),I()(S()(n),"getVOI",(function(e){var t=e.getProperty().getRGBTransferFunction(0).getMappingRange(),n=Math.abs(t[1]-t[0]);return{windowCenter:t[0]+n/2,windowWidth:n}})),n.genericRenderWindow=null,n.widgetManager=V.a.newInstance(),n.container=W.a.createRef(),n.subs={interactor:Ui(),data:Ui(),labelmap:Ui(),paint:Ui(),paintStart:Ui(),paintEnd:Ui()},n.interactorStyleSubs=[],n.state={voi:n.getVOI(e.volumes[0]),rotation:{theta:0,phi:0}},n.apiProperties={},n}return k()(t,e),v()(t,[{key:"updatePaintbrush",value:function(){var e=this.paintWidget.getWidgetState().getHandle();if("function"==typeof e.rotateFromDirections){var t=this.paintWidget.getManipulator(),n=this.paintRenderer.getActiveCamera(),r=n.getDirectionOfProjection();t.setNormal.apply(t,h()(r)),t.setOrigin.apply(t,h()(n.getFocalPoint())),e.rotateFromDirections(e.getDirection(),r)}}},{key:"componentDidMount",value:function(){var e=this,t=Ti();this.genericRenderWindow=O.a.newInstance({background:[0,0,0]}),this.genericRenderWindow.setContainer(this.container.current);var n,r,a=[],i=[];this.renderer=this.genericRenderWindow.getRenderer(),this.renderWindow=this.genericRenderWindow.getRenderWindow();var o=this.genericRenderWindow.getOpenGLRenderWindow();this.paintRenderer=q.a.newInstance(),this.renderWindow.addRenderer(this.paintRenderer),this.renderWindow.setNumberOfLayers(2),this.paintRenderer.setLayer(1),this.paintRenderer.setInteractive(!1),o.buildPass(!0);var s=Qr.newInstance();this.renderWindow.getInteractor().setInteractorStyle(s);var c=function(){var t=e.renderer.getActiveCamera(),n=e.paintRenderer.getActiveCamera(),r=t.getReferenceByName("position"),a=t.getReferenceByName("focalPoint"),i=t.getReferenceByName("viewUp"),o=t.getReferenceByName("viewAngle");n.set({position:r,focalPoint:a,viewUp:i,viewAngle:o})};if(this.renderWindow.getInteractor().onAnimation(c),c(),this.widgetManager.disablePicking(),this.widgetManager.setRenderer(this.paintRenderer),this.paintWidget=Jr.a.newInstance(),this.paintWidget.setRadius(5),this.paintFilter=Xr.a.newInstance(),this.paintFilter.setLabel(1),this.paintFilter.setRadius(5),this.componentDidUpdate({}),this.labelmap&&this.labelmap.actor&&this.renderer.addVolume(this.labelmap.actor),this.props.actors&&(a=a.concat(this.props.actors)),this.labelmap&&this.labelmap.actor&&(a=a.concat(this.labelmap.actor)),this.props.volumes&&(i=i.concat(this.props.volumes)),r=[this.paintFilter],n=[this.paintWidget],this.throttledUpdateRotationOverlay=to(this.updateRotationOverlay,16,{trailing:!0}),this.props.orientation){var u=this.props.orientation;this.setOrientation(u.sliceNormal,u.viewUp)}else s.setSliceNormal(0,0,1);this.renderer.getActiveCamera().setParallelProjection(!0),this.renderer.resetCamera(),s.setVolumeActor(this.props.volumes[0]);var d=s.getSliceRange();s.setSlice((d[0]+d[1])/2),s.onModified((function(){e.updatePaintbrush()})),this.updatePaintbrush();var l=aa.newInstance();l.setRenderer(this.renderer),l.setScale(1),this.svgWidgetManager=l,this.genericRenderWindow.resize();var h=this.updateVOI.bind(this),g=this.getOrientation.bind(this),p=this.setOrientation.bind(this),f=this.resetOrientation.bind(this),v=this.getViewUp.bind(this),m=this.getSliceNormal.bind(this),w=this.setInteractorStyle.bind(this),y=this.getSlabThickness.bind(this),b=this.setSlabThickness.bind(this),M=this.addSVGWidget.bind(this),S=this.getApiProperty.bind(this),C=this.setApiProperty.bind(this),k=this.setSegmentRGB.bind(this),x=this.setSegmentRGBA.bind(this),I=this.setSegmentAlpha.bind(this),R=this.updateImage.bind(this),W=this.setSegmentVisibility.bind(this),P=this.setGlobalOpacity.bind(this),T=this.setVisibility.bind(this),D=this.setOutlineThickness.bind(this),A=this.setOutlineRendering.bind(this),E=this.requestNewSegmentation.bind(this);if(this.svgWidgets={},this.props.onCreated){var j={uid:t,genericRenderWindow:this.genericRenderWindow,widgetManager:this.widgetManager,svgWidgetManager:this.svgWidgetManager,addSVGWidget:M,container:this.container.current,widgets:n,svgWidgets:this.svgWidgets,filters:r,actors:a,volumes:i,_component:this,updateImage:R,updateVOI:h,getOrientation:g,setOrientation:p,resetOrientation:f,getViewUp:v,getSliceNormal:m,setInteractorStyle:w,getSlabThickness:y,setSlabThickness:b,setSegmentRGB:k,setSegmentRGBA:x,setSegmentAlpha:I,setSegmentVisibility:W,setGlobalOpacity:P,setVisibility:T,setOutlineThickness:D,setOutlineRendering:A,requestNewSegmentation:E,get:S,set:C,type:"VIEW2D"};this.props.onCreated(j)}}},{key:"getViewUp",value:function(){return this.genericRenderWindow.getRenderWindow().getInteractor().getInteractorStyle().getViewUp()}},{key:"getSliceNormal",value:function(){return this.genericRenderWindow.getRenderWindow().getInteractor().getInteractorStyle().getSliceNormal()}},{key:"setOrientation",value:function(e,t){var n=this.genericRenderWindow.getRenderWindow().getInteractor().getInteractorStyle();this.updateRotationRelativeToOrientation(e),n.setSliceOrientation(e,t)}},{key:"resetOrientation",value:function(){var e=this.props.orientation||{sliceNormal:[0,0,1],viewUp:[0,-1,0]};this.setOrientation(e.sliceNormal,e.viewUp);var t=this.genericRenderWindow.getRenderWindow().getInteractor().getInteractorStyle(),n=t.getSliceRange();t.setSlice((n[0]+n[1])/2)}},{key:"getApiProperty",value:function(e){return this.apiProperties[e]}},{key:"setApiProperty",value:function(e,t){this.apiProperties[e]=t}},{key:"addSVGWidget",value:function(e,t){var n=this.svgWidgetManager;n.addWidget(e),n.render(),this.svgWidgets[t]=e}},{key:"getSlabThickness",value:function(){var e=this.genericRenderWindow.getRenderWindow().getInteractor().getInteractorStyle();if(e.getSlabThickness)return e.getSlabThickness()}},{key:"setSlabThickness",value:function(e){var t=this.genericRenderWindow.getRenderWindow(),n=t.getInteractor().getInteractorStyle();if(n.setSlabThickness&&(n.setSlabThickness(e),this.props.paintFilterLabelMapImageData)){var r=this.labelmap.actor;!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-5;return Math.abs(e-t)<n}(e,.1)?r.setVisibility(!1):r.getVisibility()!==this.props.labelmapRenderingOptions.visible&&r.setVisibility(this.props.labelmapRenderingOptions.visible)}t.render()}},{key:"updateImage",value:function(){this.genericRenderWindow.getRenderWindow().render()}},{key:"setInteractorStyle",value:function(e){for(var t,n=this,r=e.istyle,a=e.callbacks,i=void 0===a?{}:a,o=e.configuration,s=void 0===o?{}:o,c=this.props.volumes,u=this.genericRenderWindow.getRenderWindow(),d=u.getInteractor().getInteractorStyle();this.interactorStyleSubs.length;)this.interactorStyleSubs.pop().unsubscribe();d.getViewport&&r.getViewport&&(t=d.getViewport());var l=this.getSlabThickness(),h=u.getInteractor();h.setInteractorStyle(r),r.setInteractor(h),t&&r.setViewport(t),r.getVolumeActor()!==c[0]&&(l&&r.setSlabThickness&&r.setSlabThickness(l),r.setVolumeActor(c[0])),Object.keys(i).forEach((function(e){if("function"==typeof r[e]){var t=r[e](i[e]);t&&"function"==typeof t.unsubscribe&&n.interactorStyleSubs.push(t)}})),s&&r.set(s),u.render()}},{key:"updateVOI",value:function(e,t){this.setState({voi:{windowWidth:e,windowCenter:t}})}},{key:"updateRotationOverlay",value:function(e,t){this.setState({rotation:{theta:e,phi:t}})}},{key:"updateRotationRelativeToOrientation",value:function(e){var t=this.props.orientation.sliceNormal,n=[Math.acos(t[2]),Math.atan2(t[1],t[0])],r=n[0],a=n[1],i=[Math.acos(e[2]),Math.atan2(e[1],e[0])],o=i[0],s=i[1],c=(o*=no)-(r*=no),u=(s*=no)-(a*=no);c>180?c-=180:c<0&&(c=180-Math.abs(c)),u>=360?u-=360:u<0&&(u=360-Math.abs(u)),this.throttledUpdateRotationOverlay(c,u)}},{key:"getOrientation",value:function(){return this.props.orientation}},{key:"setSegmentRGBA",value:function(e,t){var n=d()(t,4),r=n[0],a=n[1],i=n[2],o=n[3];this.setSegmentRGB(e,[r,a,i]),this.setSegmentAlpha(e,o)}},{key:"setGlobalOpacity",value:function(e){var t=this.labelmap,n=this.props.labelmapRenderingOptions.colorLUT;$i(t,n,e)}},{key:"setVisibility",value:function(e){this.labelmap.actor.setVisibility(e)}},{key:"setOutlineThickness",value:function(e){this.labelmap.actor.getProperty().setLabelOutlineThickness(e)}},{key:"setOutlineRendering",value:function(e){this.labelmap.actor.getProperty().setUseLabelOutline(e)}},{key:"requestNewSegmentation",value:function(){this.props.labelmapRenderingOptions.onNewSegmentationRequested()}},{key:"setSegmentRGB",value:function(e,t){var n=d()(t,3),r=n[0],a=n[1],i=n[2];this.labelmap.cfun.addRGBPoint(e,r/255,a/255,i/255)}},{key:"setSegmentVisibility",value:function(e,t){this.setSegmentAlpha(e,t?255:0)}},{key:"setSegmentAlpha",value:function(e,t){var n=this.labelmap,r=this.props.labelmapRenderingOptions.globalOpacity;void 0===r&&(r=1);var a=t/255*r;n.ofun.addPointLong(e,a,.5,1)}},{key:"componentDidUpdate",value:function(e){var t=this;if(e.volumes!==this.props.volumes&&(this.props.volumes.forEach((function(e){e.isA("vtkVolume")||console.warn("Data to <Vtk2D> is not vtkVolume data")})),this.props.volumes.length&&this.props.volumes.forEach(this.renderer.addVolume),this.renderWindow.render()),!e.paintFilterBackgroundImageData&&this.props.paintFilterBackgroundImageData?(this.subs.data.sub(this.props.paintFilterBackgroundImageData.onModified((function(){t.genericRenderWindow.resize(),t.renderWindow.render()}))),this.paintFilter.setBackgroundImage(this.props.paintFilterBackgroundImageData)):e.paintFilterBackgroundImageData&&!this.props.paintFilterBackgroundImageData&&(this.paintFilter.setBackgroundImage(null),this.subs.data.unsubscribe()),e.paintFilterLabelMapImageData!==this.props.paintFilterLabelMapImageData&&this.props.paintFilterLabelMapImageData){if(this.subs.labelmap.unsubscribe(),this.labelmap&&this.labelmap.actor&&(this.renderer.removeVolume(this.labelmap.actor),this.api)){var n=this.api.actors,r=n.findIndex((function(e){return e===t.labelmap.actor}));-1!==r&&n.splice(r,1)}var a=this.props.paintFilterLabelMapImageData,i=eo(this.props.paintFilterBackgroundImageData,a,this.props.labelmapRenderingOptions);this.labelmap=i,this.props.labelmapRenderingOptions.segmentsDefaultProperties.forEach((function(e,n){e&&t.setSegmentVisibility(n,e.visible)})),this.labelmap&&this.labelmap.actor&&(this.renderer.addVolume(this.labelmap.actor),this.api&&(this.api.actors=this.api.actors.concat(this.labelmap.actor))),i.mapper.setInputConnection(this.paintFilter.getOutputPort()),this.paintFilter.setLabelMap(a),this.subs.labelmap.sub(a.onModified((function(){i.mapper.modified(),t.renderWindow.render()}))),this.genericRenderWindow.resize()}e.labelmapRenderingOptions&&e.labelmapRenderingOptions.visible!==this.props.labelmapRenderingOptions.visible&&this.labelmap.actor.setVisibility(e.labelmapRenderingOptions.visible),e.painting!==this.props.painting&&(this.props.painting?(this.viewWidget=this.widgetManager.addWidget(this.paintWidget,Fi.ViewTypes.SLICE),this.subs.paintStart.sub(this.viewWidget.onStartInteractionEvent((function(){t.paintFilter.startStroke(),t.paintFilter.addPoint(t.paintWidget.getWidgetState().getTrueOrigin()),t.props.onPaintStart&&t.props.onPaintStart()}))),this.subs.paint.sub(this.viewWidget.onInteractionEvent((function(){t.viewWidget.getPainting()&&(t.paintFilter.addPoint(t.paintWidget.getWidgetState().getTrueOrigin()),t.props.onPaint&&t.props.onPaint())}))),this.subs.paintEnd.sub(this.viewWidget.onEndInteractionEvent((function(){var e=t.paintFilter.endStroke();t.props.onPaintEnd&&e.then((function(e){t.props.onPaintEnd(e)}))}))),this.widgetManager.grabFocus(this.paintWidget),this.widgetManager.enablePicking(),this.genericRenderWindow.resize()):this.viewWidget&&(this.widgetManager.releaseFocus(),this.widgetManager.removeWidget(this.paintWidget),this.widgetManager.disablePicking(),this.subs.paintStart.unsubscribe(),this.subs.paint.unsubscribe(),this.subs.paintEnd.unsubscribe(),this.viewWidget=null,this.genericRenderWindow.resize()))}},{key:"componentWillUnmount",value:function(){var e=this;Object.keys(this.subs).forEach((function(t){e.subs[t].unsubscribe()})),this.props.onDestroyed&&this.props.onDestroyed(),this.genericRenderWindow.delete()}},{key:"render",value:function(){if(!this.props.volumes||!this.props.volumes.length)return null;var e={width:"100%",height:"100%",position:"relative"},t=this.state.voi,n=this.props.showRotation?this.state.rotation:null;return W.a.createElement("div",{style:e},W.a.createElement("div",{ref:this.container,style:e}),W.a.createElement(Vi,c()({},this.props.dataDetails,{voi:t,rotation:n})))}}]),t}(R.Component);I()(ro,"propTypes",{volumes:T.a.array.isRequired,actors:T.a.array,painting:T.a.bool.isRequired,paintFilterBackgroundImageData:T.a.object,paintFilterLabelMapImageData:T.a.object,onPaint:T.a.func,onPaintStart:T.a.func,onPaintEnd:T.a.func,dataDetails:T.a.object,onCreated:T.a.func,onDestroyed:T.a.func,orientation:T.a.object,labelmapRenderingOptions:T.a.object,showRotation:T.a.bool}),I()(ro,"defaultProps",{painting:!1,labelmapRenderingOptions:{visible:!0,renderOutline:!0,segmentsDefaultProperties:[],onNewSegmentationRequested:function(){}},showRotation:!1});var ao=n(15),io=n.n(ao),oo=n(21),so=n.n(oo),co=n(44),uo=n.n(co),lo=n(45),ho=n.n(lo),go=n(46),po=n.n(go),fo=n(24),vo=n.n(fo),mo=n(25),wo=n.n(mo),yo=n(31),bo=n.n(yo),Mo=(n(69),function(e){function t(e){var n,r,a;return p()(this,t),n=w()(this,b()(t).call(this,e)),I()(S()(n),"getVOI",(function(e){return{windowCenter:e.getProperty().getColorLevel(),windowWidth:e.getProperty().getColorWindow()}})),n.genericRenderWindow=null,n.widgetManager=V.a.newInstance(),n.container=W.a.createRef(),n.subs={interactor:Ui(),data:Ui(),labelmap:Ui()},n.interactorStyleSubs=[],window.surfaceSettings&&(r=window.surfaceSettings.radius,a=window.surfaceSettings.nsides),n.state={voi:n.getVOI(e.actor),freezeSlice:!1,radius:r||.3,nsides:a||5},n.apiProperties={},n.resetCutActorsCache(),n}return k()(t,e),v()(t,[{key:"resetCutActorsCache",value:function(){var e=this;this.cutActorsCache={},[io.a.SlicingMode.I,io.a.SlicingMode.J,io.a.SlicingMode.K].forEach((function(t){return e.cutActorsCache[t]={}}))}},{key:"setupActors",value:function(e,t,n,r,a){var i=this;e.getMapper().setSlicingMode(a),e.getMapper().setSlice(r),this.replaceCutActors(),n.onModified((function(){var e=n.getSlice();i.setState({slice:e},i.replaceCutActors)}))}},{key:"replaceCutActors",value:function(){var e=this;this.cutActors&&this.cutActors.length>0&&this.cutActors.forEach(this.renderer.removeActor),this.cutActors=[];var t=this.props,n=t.polyData,r=t.actor,a=t.colors;if(n&&0!==n.length){var i=this.state,o=i.sliceMode,s=i.slice,c=(i.radius,i.nsides,bo.a.getCenter(r.getMapper().getBoundsForSlice()));if(this.cutActorsCache[o][s])this.cutActors=this.cutActorsCache[o][s];else{var u=[1,0,0];switch(o){case io.a.SlicingMode.I:u=[1,0,0];break;case io.a.SlicingMode.J:u=[0,1,0];break;case io.a.SlicingMode.K:u=[0,0,1]}n.forEach((function(t,n){var r=c.map((function(e){return Math.ceil(e)})),i=ho.a.newInstance();i.setOrigin.apply(i,h()(r)),i.setNormal.apply(i,h()(u));var o=uo.a.newInstance();o.setCutFunction(i),o.setInputData(t);var s=vo.a.newInstance();s.setInputConnection(o.getOutputPort());var d=wo.a.newInstance();d.setMapper(s);var l=d.getProperty();l.setRepresentation(po.a.Representation.SURFACE),l.setLighting(!1),l.setColor.apply(l,h()(a[n])),l.setOpacity(a[n][3]),e.cutActors.push(d)})),this.cutActorsCache[o][s]=h()(this.cutActors)}this.cutActors.forEach(this.renderer.addActor),this.updateImage()}}},{key:"componentDidMount",value:function(){var e=this,t=Ti();this.genericRenderWindow=O.a.newInstance({background:[0,0,0]}),this.genericRenderWindow.setContainer(this.container.current),this.renderWindow=this.genericRenderWindow.getRenderWindow();var n,r=this.props,a=r.orientation,i=r.planeMap,o=r.actor;switch(i[a].plane){case 0:n=io.a.SlicingMode.I;break;case 1:n=io.a.SlicingMode.J;break;case 2:n=io.a.SlicingMode.K}var s=this.props.labelmapActors?this.props.labelmapActors[n]:[],c=this.genericRenderWindow.getRenderer();this.renderer=c,this.renderWindow=this.genericRenderWindow.getRenderWindow(),this.genericRenderWindow.getOpenGLRenderWindow().buildPass(!0);var u=so.a.newInstance();u.setInteractionMode("IMAGE_SLICING"),this.renderWindow.getInteractor().setInteractorStyle(u);var d=this.renderWindow.getInteractor();this.updateCameras=function(){var e=this.renderer.getActiveCamera();this.state.freezeSlice||o.getMapper().setSliceFromCamera(e)}.bind(this),d.onAnimation(this.updateCameras),this.widgetManager.disablePicking(),this.widgetManager.setRenderer(c);var l=aa.newInstance();l.setRenderer(this.renderer),l.setScale(1),this.svgWidgetManager=l,c.addActor(o),s&&s.forEach(c.addActor),o.onModified((function(){e.updateImage()}));var h,g,p=o.getMapper(),f=p.getInputData(),v=f.getDimensions()[i[a].plane],m=Math.floor(v/2),w=i[a].flip;switch(a){case"Sagittal":h=[0,0,1],g={n:"S",s:"I",e:"P",w:"A"};break;case"Coronal":h=[0,0,1],g={n:"S",s:"I",e:"R",w:"L"};break;case"Axial":h=[0,-1,0],g={n:"A",s:"P",e:"R",w:"L"}}this.renderer.getActiveCamera().setParallelProjection(!0),this.setCamera(n,w,h,c,f),this.setState({slice:m,neswMetadata:g,sliceMode:n},(function(){e.setupActors(o,s,p,m,n)})),c.resetCamera(),this.updateCameras(),this.genericRenderWindow.resize(),this.renderWindow.render();var y=this.updateVOI.bind(this),b=this.getOrientation.bind(this),M=this.setInteractorStyle.bind(this),S=this.addSVGWidget.bind(this),C=this.getApiProperty.bind(this),k=this.setApiProperty.bind(this),x=this.setCamera.bind(this),I=this.updateImage.bind(this),R=this.getSliceNormal.bind(this),W=this.requestNewSegmentation.bind(this),P=this.updateSegmentationConfig.bind(this),T=this.updateSurfaceConfig.bind(this),D=this.updateSurfaceParams.bind(this),A=this.setInterpolationType.bind(this),E=this.setFreezeSlice.bind(this);if(this.svgWidgets={},this.props.onCreated){var j={uid:t,genericRenderWindow:this.genericRenderWindow,widgetManager:this.widgetManager,svgWidgetManager:this.svgWidgetManager,addSVGWidget:S,container:this.container.current,widgets:[],svgWidgets:this.svgWidgets,filters:[],actor:o,sliceMode:n,_component:this,updateImage:I,updateVOI:y,getOrientation:b,setInteractorStyle:M,getSliceNormal:R,requestNewSegmentation:W,updateSegmentationConfig:P,updateSurfaceConfig:T,updateSurfaceParams:D,setInterpolationType:A,setCamera:x,get:C,set:k,setFreezeSlice:E,type:"VIEW2D"};this.props.onCreated(j)}}},{key:"componentDidUpdate",value:function(e){var t=this.state,n=t.slice,r=t.sliceMode,a=this.props,i=a.actor,o=a.labelmapActors,s=a.polyData,c=a.colors,u=!1,d=this.renderer;i!==e.actor&&(d.removeActor(e.actor),d.addActor(i),u=!0);var l=i.getMapper(),h=e.labelmapActors?e.labelmapActors[r]:[],g=o?o[r]:[];h!==g&&(g.length>0||h.length>0)&&(h&&h.forEach(d.removeActor),g.forEach(d.addActor),u=!0),s!==e.polyData&&(s.length>0||e.polyData.length>0)&&(u=!0),c!==e.colors&&(this.resetCutActorsCache(),this.replaceCutActors()),u&&(this.setupActors(i,g,l,n,r),d.resetCamera(),this.genericRenderWindow.resize(),this.updateCameras(),this.updateImage())}},{key:"getApiProperty",value:function(e){return this.apiProperties[e]}},{key:"setApiProperty",value:function(e,t){this.apiProperties[e]=t}},{key:"addSVGWidget",value:function(e,t){var n=this.svgWidgetManager;n.addWidget(e),n.render(),this.svgWidgets[t]=e}},{key:"updateImage",value:function(){this.genericRenderWindow.getRenderWindow().render()}},{key:"requestNewSegmentation",value:function(){this.props.labelmapRenderingOptions.onNewSegmentationRequested()}},{key:"updateSegmentationConfig",value:function(){this.props.labelmapRenderingOptions.onUpdateSegmentationConfig()}},{key:"updateSurfaceConfig",value:function(){this.props.onUpdateSurfaceConfig()}},{key:"updateSurfaceParams",value:function(){var e=this,t=window.surfaceSettings,n=t.radius,r=t.nsides;this.setState({radius:n,nsides:r},(function(){e.resetCutActorsCache(),e.replaceCutActors()}))}},{key:"setInterpolationType",value:function(e){this.props.actor.getProperty().setInterpolationType(e),this.updateImage()}},{key:"setInteractorStyle",value:function(e){for(var t,n=this,r=e.istyle,a=e.callbacks,i=void 0===a?{}:a,o=e.configuration,s=void 0===o?{}:o,c=this.props.actor,u=this.genericRenderWindow.getRenderWindow(),d=u.getInteractor().getInteractorStyle();this.interactorStyleSubs.length;)this.interactorStyleSubs.pop().unsubscribe();d.getViewport&&r.getViewport&&(t=d.getViewport());var l=u.getInteractor();l.setInteractorStyle(r),r.setInteractor(l),t&&r.setViewport(t),r.getImageActor&&r.getImageActor()!==c&&r.setImageActor(c),u.render(),Object.keys(i).forEach((function(e){if("function"==typeof r[e]){var t=r[e](i[e]);t&&"function"==typeof t.unsubscribe&&n.interactorStyleSubs.push(t)}})),s&&r.set(s),u.render()}},{key:"updateVOI",value:function(e,t){var n=this.props.actor,r=this.genericRenderWindow.getRenderWindow();n.getProperty().setColorWindow(e),n.getProperty().setColorLevel(t),r.render(),this.setState({voi:{windowWidth:e,windowCenter:t}})}},{key:"getOrientation",value:function(){return this.props.orientation}},{key:"setCamera",value:function(e,t,n,r,a){var i=[0,0,0],o=[0,0,0],s=[0,0,0];a.indexToWorldVec3(i,s),i[e]=t?-1:1,a.indexToWorldVec3(i,o),r.getActiveCamera().set({focalPoint:s,position:o,viewUp:n}),r.resetCamera()}},{key:"getSliceNormal",value:function(){return this.genericRenderWindow.getRenderWindow().getInteractor().getInteractorStyle().getSliceNormal()}},{key:"setFreezeSlice",value:function(e){this.setState({freezeSlice:e})}},{key:"componentWillUnmount",value:function(){var e=this;Object.keys(this.subs).forEach((function(t){e.subs[t].unsubscribe()})),this.props.onDestroyed&&this.props.onDestroyed(),this.genericRenderWindow.delete()}},{key:"render",value:function(){var e={width:"100%",height:"100%",position:"relative"},t=this.state.voi;return W.a.createElement("div",{style:e},W.a.createElement("div",{ref:this.container,style:e}),W.a.createElement(Vi,c()({},this.props.dataDetails,{voi:t,orientation:this.props.orientation,neswMetadata:this.state.neswMetadata,slice:this.state.slice})))}}]),t}(R.Component));I()(Mo,"propTypes",{actor:T.a.object,polyData:T.a.array,colors:T.a.array,labelmapActors:T.a.object,dataDetails:T.a.object,onCreated:T.a.func,onDestroyed:T.a.func,orientation:T.a.string.isRequired,orientationName:T.a.string,labelmapRenderingOptions:T.a.object,planeMap:T.a.object,onUpdateSurfaceConfig:T.a.func});var So=function(e){function t(e){var n;return p()(this,t),(n=w()(this,b()(t).call(this,e))).genericRenderWindow=null,n.widgetManager=V.a.newInstance(),n.container=W.a.createRef(),n.subs={interactor:Ui(),data:Ui(),labelmap:Ui(),paint:Ui(),paintStart:Ui(),paintEnd:Ui()},n}return k()(t,e),v()(t,[{key:"componentDidMount",value:function(){this.genericRenderWindow=O.a.newInstance({background:[0,0,0]}),this.genericRenderWindow.setContainer(this.container.current);var e,t,n=[],r=[];if(this.renderer=this.genericRenderWindow.getRenderer(),this.renderWindow=this.genericRenderWindow.getRenderWindow(),this.widgetManager.disablePicking(),this.widgetManager.setRenderer(this.renderer),this.paintWidget=Jr.a.newInstance(),this.paintWidget.setRadius(5),this.paintFilter=Xr.a.newInstance(),this.paintFilter.setLabel(1),this.paintFilter.setRadius(5),this.componentDidUpdate({}),this.props.actors&&(n=n.concat(this.props.actors)),this.labelmap&&this.labelmap.actor&&(n=n.concat(this.labelmap.actor)),this.props.volumes&&(r=r.concat(this.props.volumes)),t=[this.paintFilter],e=[this.paintWidget],this.labelmap&&this.labelmap.actor&&this.renderer.addVolume(this.labelmap.actor),this.renderer.resetCamera(),this.renderer.updateLightsGeometryToFollowCamera(),this.genericRenderWindow.resize(),this.props.onCreated){var a={genericRenderWindow:this.genericRenderWindow,widgetManager:this.widgetManager,container:this.container.current,widgets:e,filters:t,actors:n,volumes:r,type:"VIEW3D",_component:this};this.props.onCreated(a)}}},{key:"componentDidUpdate",value:function(e){var t=this;if(console.time("View3D componentDidUpdate"),e.volumes!==this.props.volumes&&(this.props.volumes.forEach((function(e){e.isA("vtkVolume")||console.warn("Data to <Vtk2D> is not vtkVolume data")})),this.props.volumes.length&&this.props.volumes.forEach(this.renderer.addVolume),this.renderWindow.render()),e.actors!==this.props.actors&&this.props.actors&&(this.props.actors.forEach((function(e){e.isA("vtkActor")||console.warn("Data to <Vtk2D> is not vtkActor data")})),this.props.actors.length&&this.props.actors.forEach(this.renderer.addActor),this.renderWindow.render()),!e.paintFilterBackgroundImageData&&this.props.paintFilterBackgroundImageData?(this.subs.data.sub(this.props.paintFilterBackgroundImageData.onModified((function(){return t.renderWindow.render()}))),this.paintFilter.setBackgroundImage(this.props.paintFilterBackgroundImageData)):e.paintFilterBackgroundImageData&&!this.props.paintFilterBackgroundImageData&&(this.paintFilter.setBackgroundImage(null),this.subs.data.unsubscribe()),e.paintFilterLabelMapImageData!==this.props.paintFilterLabelMapImageData&&this.props.paintFilterLabelMapImageData){this.subs.labelmap.unsubscribe();var n=this.props.paintFilterLabelMapImageData,r=eo(this.props.paintFilterBackgroundImageData,n,this.props.labelmapRenderingOptions,!1);this.labelmap=r,r.mapper.setInputConnection(this.paintFilter.getOutputPort()),this.paintFilter.setLabelMap(n),this.subs.labelmap.sub(n.onModified((function(){r.mapper.modified(),t.renderWindow.render()})))}e.painting!==this.props.painting&&(this.props.painting?(console.time("turnOnPainting"),this.viewWidget=this.widgetManager.addWidget(this.paintWidget,Fi.ViewTypes.VOLUME),this.subs.paintStart.sub(this.viewWidget.onStartInteractionEvent((function(){t.paintFilter.startStroke(),t.paintFilter.addPoint(t.paintWidget.getWidgetState().getTrueOrigin()),t.props.onPaintStart&&t.props.onPaintStart()}))),this.subs.paint.sub(this.viewWidget.onInteractionEvent((function(){t.viewWidget.getPainting()&&(t.paintFilter.addPoint(t.paintWidget.getWidgetState().getTrueOrigin()),t.props.onPaint&&t.props.onPaint())}))),this.subs.paintEnd.sub(this.viewWidget.onEndInteractionEvent((function(){var e=t.paintFilter.endStroke();t.props.onPaintEnd&&e.then((function(e){t.props.onPaintEnd(e)}))}))),this.widgetManager.grabFocus(this.paintWidget),this.widgetManager.enablePicking(),console.timeEnd("turnOnPainting")):this.viewWidget&&(console.time("turnOffPainting"),this.widgetManager.releaseFocus(),this.widgetManager.removeWidget(this.paintWidget),this.widgetManager.disablePicking(),this.subs.paintStart.unsubscribe(),this.subs.paint.unsubscribe(),this.subs.paintEnd.unsubscribe(),this.viewWidget=null,console.timeEnd("turnOffPainting"))),console.timeEnd("View3D componentDidUpdate")}},{key:"componentWillUnmount",value:function(){var e=this;Object.keys(this.subs).forEach((function(t){e.subs[t].unsubscribe()})),this.props.onDestroyed&&this.props.onDestroyed(),this.genericRenderWindow.delete()}},{key:"render",value:function(){if(!this.props.volumes&&!this.props.actors)return null;var e={width:"100%",height:"100%",position:"relative"},t={windowCenter:0,windowWidth:0};if(this.pipeline){var n=this.props.volumes[0].getProperty().getRGBTransferFunction(0).getMappingRange(),r=n[0]+n[1];t={windowCenter:n[0]+r/2,windowWidth:r}}return W.a.createElement("div",{style:e},W.a.createElement("div",{ref:this.container,style:e}),W.a.createElement(Vi,c()({},this.props.dataDetails,{voi:t})))}}]),t}(R.Component);I()(So,"propTypes",{volumes:T.a.array,actors:T.a.array,painting:T.a.bool.isRequired,paintFilterBackgroundImageData:T.a.object,paintFilterLabelMapImageData:T.a.object,onPaint:T.a.func,onPaintStart:T.a.func,onPaintEnd:T.a.func,sliceNormal:T.a.array.isRequired,dataDetails:T.a.object,onCreated:T.a.func,onDestroyed:T.a.func,labelmapRenderingOptions:T.a.object}),I()(So,"defaultProps",{painting:!1,sliceNormal:[0,0,1],labelmapRenderingOptions:{visible:!0,renderOutline:!1}});var Co=n(34),ko=n.n(Co),xo=n(47),Io=n.n(xo),Ro={Surf:"Surface mesh",MC:"DICOM-SEG marching cubes"},Wo=function(e){function t(e){var n;p()(this,t),n=w()(this,b()(t).call(this,e)),I()(S()(n),"getActorsForDisplay",(function(e){return e?n.actorMap[e]:[]})),n.genericRenderWindow=null,n.widgetManager=V.a.newInstance(),n.container=W.a.createRef(),n.subs={interactor:Ui()},n.interactorStyleSubs=[],n.apiProperties={};var r=n.setActorMapAndDisplay();return n.state={display:r,loading:!0},n}return k()(t,e),v()(t,[{key:"setOrUpdateActors",value:function(e){if(e!==this.state.display){if(e){var t=this.getActorsForDisplay(this.state.display);t.length&&t.forEach(this.renderer.removeActor)}else e=this.state.display;var n=this.getActorsForDisplay(e);n.length&&n.forEach(this.renderer.addActor);var r=this.props.planeMap,a=[0,0,0];a[r.Sagittal.plane]=r.Sagittal.flip?-1:1;var i=[0,0,0];i[r.Axial.plane]=r.Axial.flip?-1:1;var o=this.renderer.getActiveCamera();o.setDirectionOfProjection(-a[0],-a[1],-a[2]),o.setViewUp.apply(o,i),this.renderer.resetCamera(),this.orientationWidget.updateMarkerOrientation(),this.genericRenderWindow.getRenderWindow().render(),this.setState({loading:!1,display:e})}else this.setState({loading:!1})}},{key:"setActorMapAndDisplay",value:function(){var e;return this.actorMap={},this.props.surfaceActors&&this.props.surfaceActors.length&&(this.actorMap.Surf=this.props.surfaceActors,e="Surf"),this.props.marchingCubesActors&&this.props.marchingCubesActors.length&&(this.actorMap.MC=this.props.marchingCubesActors,e||(e="MC")),e}},{key:"componentDidMount",value:function(){this.genericRenderWindow=O.a.newInstance({background:[0,0,0]}),this.genericRenderWindow.setContainer(this.container.current),this.renderer=this.genericRenderWindow.getRenderer(),this.renderWindow=this.genericRenderWindow.getRenderWindow();var e=this.renderWindow.getInteractor();this.widgetManager.disablePicking(),this.widgetManager.setRenderer(this.renderer),this.axes=Io.a.newInstance(),this.orientationWidget=ko.a.newInstance({actor:this.axes,interactor:e}),this.orientationWidget.setEnabled(!0),this.orientationWidget.setViewportCorner(ko.a.Corners.BOTTOM_RIGHT),this.orientationWidget.setMinPixelSize(50),this.orientationWidget.setMaxPixelSize(500);var t=this.props.planeMap,n=function(e){var n,r,a,i,o,s,c=t[e],u=c.flip;switch(e){case"Sagittal":u?(r="L",n="R"):(r="R",n="L"),i=-90,a=90;break;case"Coronal":u?(r="P",n="A"):(r="A",n="P"),i=0,a=180;break;case"Axial":u?(r="S",n="I"):(r="I",n="S"),i=180,a=0}switch(c.plane){case 0:s=this.axes.setXMinusFaceProperty,o=this.axes.setXPlusFaceProperty;break;case 1:s=this.axes.setYMinusFaceProperty,o=this.axes.setYPlusFaceProperty;break;case 2:s=this.axes.setZMinusFaceProperty,o=this.axes.setZPlusFaceProperty}o({text:n,faceRotation:a}),s({text:r,faceRotation:i})}.bind(this);Object.keys(t).forEach(n),window.addEventListener("resize",this.genericRenderWindow.resize),window.addEventListener("resize",this.orientationWidget.updateViewport),this.setOrUpdateActors(),this.renderer.resetCamera(),this.renderer.updateLightsGeometryToFollowCamera();var r=aa.newInstance();r.setRenderer(this.renderer),r.setScale(1),this.svgWidgetManager=r,this.genericRenderWindow.resize();var a=this.addSVGWidget.bind(this),i=this.setInteractorStyle.bind(this),o=this.getApiProperty.bind(this),s=this.setApiProperty.bind(this),c=this.requestNewSegmentation.bind(this),u=this.updateSegmentationConfig.bind(this),d=this.updateSurfaceConfig.bind(this),l=this.updateImage.bind(this);if(this.svgWidgets={},this.props.onCreated){var h={genericRenderWindow:this.genericRenderWindow,widgetManager:this.widgetManager,svgWidgetManager:this.svgWidgetManager,addSVGWidget:a,setInteractorStyle:i,container:this.container.current,marchingCubesActors:this.props.marchingCubesActors,surfaceActors:this.props.surfaceActors,svgWidgets:this.svgWidgets,get:o,set:s,requestNewSegmentation:c,updateImage:l,updateSegmentationConfig:u,updateSurfaceConfig:d,type:"VIEW3D",_component:this};this.props.onCreated(h)}}},{key:"componentDidUpdate",value:function(e){var t=this;if(e.surfaceActors!==this.props.surfaceActors&&(e.surfaceActors&&e.surfaceActors.length>0||this.props.surfaceActors&&this.props.surfaceActors.length>0)||e.marchingCubesActors!==this.props.marchingCubesActors&&(e.marchingCubesActors&&e.marchingCubesActors.length>0||this.props.marchingCubesActors&&this.props.marchingCubesActors.length>0)){var n=this.setActorMapAndDisplay();this.setState({loading:!0,display:n},(function(){t.setOrUpdateActors(),t.renderer.resetCamera(),t.renderer.updateLightsGeometryToFollowCamera()}))}}},{key:"componentWillUnmount",value:function(){var e=this;Object.keys(this.subs).forEach((function(t){e.subs[t].unsubscribe()})),this.props.onDestroyed&&this.props.onDestroyed(),this.genericRenderWindow.delete()}},{key:"addSVGWidget",value:function(e,t){var n=this.svgWidgetManager;n.addWidget(e),n.render(),this.svgWidgets[t]=e}},{key:"setInteractorStyle",value:function(e){for(var t,n=this,r=e.istyle,a=e.callbacks,i=void 0===a?{}:a,o=e.configuration,s=void 0===o?{}:o,c=this.getActorsForDisplay(this.state.display),u=this.genericRenderWindow.getRenderWindow(),d=u.getInteractor().getInteractorStyle();this.interactorStyleSubs.length;)this.interactorStyleSubs.pop().unsubscribe();d.getViewport&&r.getViewport&&(t=d.getViewport());var l=u.getInteractor();l.setInteractorStyle(r),r.setInteractor(l),t&&r.setViewport(t),r.getActor&&r.getActor()!==c[0]&&r.setActor(c[0]),Object.keys(i).forEach((function(e){if("function"==typeof r[e]){var t=r[e](i[e]);t&&"function"==typeof t.unsubscribe&&n.interactorStyleSubs.push(t)}})),s&&r.set(s),u.render()}},{key:"getApiProperty",value:function(e){return this.apiProperties[e]}},{key:"setApiProperty",value:function(e,t){this.apiProperties[e]=t}},{key:"requestNewSegmentation",value:function(){this.props.labelmapRenderingOptions.onNewSegmentationRequested()}},{key:"updateSegmentationConfig",value:function(){this.props.labelmapRenderingOptions.onUpdateSegmentationConfig()}},{key:"updateSurfaceConfig",value:function(){this.props.onUpdateSurfaceConfig()}},{key:"updateImage",value:function(){this.genericRenderWindow.getRenderWindow().render()}},{key:"render",value:function(){var e=this,t={width:"100%",height:"100%",position:"relative"},n=null;return this.state.display&&Object.keys(this.actorMap).length>1&&(n=W.a.createElement("select",{onChange:function(t){var n=t.target.value;e.setState({loading:!0},(function(){return setTimeout((function(){return e.setOrUpdateActors(n)}),50)}))},defaultValue:this.state.display},Object.keys(this.actorMap).map((function(e){return W.a.createElement("option",{key:e,value:e},Ro[e])})))),W.a.createElement("div",{style:t},W.a.createElement("div",{ref:this.container,style:t}),W.a.createElement("div",{style:{top:"10px",left:"10px",position:"absolute"}},this.state.loading?W.a.createElement("div",{style:{color:"white"}},"Loading..."):n))}}]),t}(R.Component);function Po(e,t){var n=Math.abs(e-t);return{windowWidth:n,windowCenter:e+n/2}}I()(Wo,"propTypes",{marchingCubesActors:T.a.array,surfaceActors:T.a.array,onCreated:T.a.func,onDestroyed:T.a.func,dataDetails:T.a.object,planeMap:T.a.object,labelmapRenderingOptions:T.a.object,onUpdateSurfaceConfig:T.a.func});var To=ae.a.States;var Do={wlStartPos:[0,0],levelScale:1};function Ao(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,Do,n),Qr.extend(e,t,n),U.a.setGet(e,t,["onLevelsChanged","levelScale"]),function(e,t){t.classHierarchy.push("vtkInteractorStyleMPRWindowLevel");var n=e.handleMouseMove;e.handleMouseMove=function(r){var a=[r.position.x,r.position.y];t.state===To.IS_WINDOW_LEVEL&&(e.windowLevelFromMouse(a),e.invokeInteractionEvent({type:"InteractionEvent"})),n&&n(r)},e.windowLevelFromMouse=function(n){var r=t.volumeActor.getMapper().getInputData().getPointData().getScalars().getRange(),a=r[1]-r[0],i=Math.round(a/1024)*e.getLevelScale(),o=Math.round((n[0]-t.wlStartPos[0])*i),s=Math.round((n[1]-t.wlStartPos[1])*i),c=t.levels.windowWidth+o,u=t.levels.windowCenter-s;if(c=Math.max(.01,c),t.windowWidth!==c||t.windowCenter!==u){e.setWindowLevel(c,u),t.wlStartPos[0]=Math.round(n[0]),t.wlStartPos[1]=Math.round(n[1]);var d=e.getOnLevelsChanged();d&&d({windowCenter:u,windowWidth:c})}},e.getWindowLevel=function(){var e=t.volumeActor.getProperty().getRGBTransferFunction(0).getMappingRange().slice();return Po.apply(void 0,h()(e))},e.setWindowLevel=function(e,n){var r=function(e,t){return{lower:t-e/2,upper:t+e/2}}(e,n);t.levels.windowWidth=e,t.levels.windowCenter=n,t.volumeActor.getProperty().getRGBTransferFunction(0).setMappingRange(r.lower,r.upper)};var r=e.handleLeftButtonPress;e.handleLeftButtonPress=function(n){if(t.wlStartPos[0]=n.position.x,t.wlStartPos[1]=n.position.y,n.shiftKey||n.controlKey)r&&r(n);else{var a=t.volumeActor.getProperty();a&&(t.initialMRange=a.getRGBTransferFunction(0).getMappingRange().slice(),t.levels=Po(t.initialMRange[0],t.initialMRange[1]),e.startWindowLevel())}},e.superHandleLeftButtonRelease=e.handleLeftButtonRelease,e.handleLeftButtonRelease=function(){switch(t.state){case To.IS_WINDOW_LEVEL:e.endWindowLevel();break;default:e.superHandleLeftButtonRelease()}}}(e,t)}var Eo=U.a.newInstance(Ao,"vtkInteractorStyleMPRWindowLevel"),Oo=Object.assign({newInstance:Eo,extend:Ao}),jo=ae.a.States;var qo={};function Lo(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,qo,n),Qr.extend(e,t,n),U.a.setGet(e,t,["callback","apis","apiIndex","onScroll"]),function(e,t){function n(n){var r=t.apis,a=t.apiIndex,i=r[a],o=n.position,s=n.pokedRenderer,c=ne.a.newInstance();c.setCoordinateSystemToDisplay(),c.setValue(o.x,o.y,0);for(var u=c.getComputedWorldValue(s),d=s.getActiveCamera().getDirectionOfProjection(),l=i.getSlabThickness()/2,h=0;h<u.length;h++)u[h]+=l*d[h];i.svgWidgets.crosshairsWidget.moveCrosshairs(u,r,a),e.invokeInteractionEvent({type:"InteractionEvent"})}t.classHierarchy.push("vtkInteractorStyleMPRCrosshairs");var r=e.handleMouseMove;e.handleMouseMove=function(e){t.state===jo.IS_WINDOW_LEVEL&&n(e),r&&r(e)};var a=e.handleLeftButtonPress;e.handleLeftButtonPress=function(r){r.shiftKey||r.controlKey?a&&a(r):t.volumeActor&&(n(r),e.startWindowLevel())},e.superHandleLeftButtonRelease=e.handleLeftButtonRelease,e.handleLeftButtonRelease=function(){switch(t.state){case jo.IS_WINDOW_LEVEL:e.endWindowLevel();break;default:e.superHandleLeftButtonRelease()}}}(e,t)}var Vo=U.a.newInstance(Lo,"vtkInteractorStyleMPRCrosshairs"),Fo=Object.assign({newInstance:Vo,extend:Lo}),Uo=ae.a.States,No={ROTATE_CROSSHAIRS:0,MOVE_CROSSHAIRS:1,MOVE_REFERENCE_LINE:2,PAN:3};function Bo(e,t){function n(){var e=t.apis,n=t.apiIndex;e.forEach((function(e,t){if(t!==n){var r=e.svgWidgets.rotatableCrosshairsWidget;if(!r)throw new Error("Must use rotatable crosshair svg widget with this istyle.");var a=r.getReferenceLines();a[0].active=!1,a[1].active=!1}}))}function r(e,t){var n=d()(e.points,2),r=n[0],a=n[1],i=t;return 2*Math.abs((r.x*(a.y-i.y)+a.x*(i.y-r.y)+i.x*(r.y-a.y))/2)/o.distance([r.x,r.y],[a.x,a.y])}function a(e){var n,r=t.operation;switch(r.type){case No.MOVE_CROSSHAIRS:s(e.position,e.pokedRenderer);break;case No.MOVE_REFERENCE_LINE:n=r.snapToLineIndex,s(function(e,n){var r=t.apis,a=t.apiIndex,i=r[a],s=i.svgWidgetManager,c=s.getSize(),u=s.getScale(),d=c[1],l={x:e.x*u,y:d-e.y*u},h=i.svgWidgets.rotatableCrosshairsWidget.getReferenceLines()[n].points,g=[],p=[];o.sub(g,[l.x,l.y],[h[0].x,h[0].y]),o.sub(p,[h[1].x,h[1].y],[h[0].x,h[0].y]);var f=o.distance([h[0].x,h[0].y],[h[1].x,h[1].y]),v=[p[0]/f,p[1]/f],m=o.dot(g,p)/f,w=[h[0].x+v[0]*m,h[0].y+v[1]*m];return{x:w[0]/u,y:(d-w[1])/u}}(e.position,n),e.pokedRenderer);break;case No.ROTATE_CROSSHAIRS:!function(e){var n=t.operation,r=n.prevPosition,a=e.position;if(a.x===r.x&&a.y===r.y)return;var s=t.apis,c=t.apiIndex,u=s[c],d=u.svgWidgets.rotatableCrosshairsWidget.getPoint(),l=[],h=[];o.subtract(l,[r.x,r.y],d),o.subtract(h,[a.x,a.y],d);var g=o.angle(l,h);h[0]*l[1]-h[1]*l[0]>0&&(g*=-1);var p=u.getSliceNormal(),f=[-p[0],-p[1],-p[2]];s.forEach((function(e,t){if(t!==c){var n=e.genericRenderWindow.getRenderWindow().getInteractor().getCurrentRenderer().getActiveCamera(),r=e.get("cachedCrosshairWorldPosition"),a=e.get("initialCachedCrosshairWorldPosition"),i=[];B.a.subtract(r,a,i);var o=[];B.a.add(r,i,o);var s=H.a.buildFromRadian().translate(o[0],o[1],o[2]).rotate(g,f).translate(-o[0],-o[1],-o[2]).matrix;n.applyTransform(s);var u=e.getSliceNormal(),d=e.getViewUp();e.setOrientation(u,d)}})),i(e),s.forEach((function(e){var t=e.genericRenderWindow.getRenderWindow().getInteractor().getCurrentRenderer().getActiveCamera(),n=e.get("cachedCrosshairWorldPosition"),r=t.getFocalPoint(),a=t.getPosition(),i=[];B.a.subtract(r,a,i);var o=[];B.a.subtract(n,a,o);var s=i[0]*i[0]+i[1]*i[1]+i[2]*i[2];B.a.multiplyScalar(i,B.a.dot(o,i)/s);var c=[];B.a.subtract(o,i,c);var u=[];B.a.subtract(n,c,u),t.setFocalPoint(u[0],u[1],u[2])})),n.prevPosition=a}(e)}}function i(e){var n=t.apis,r=t.apiIndex,a=n[r],i=a.svgWidgets.rotatableCrosshairsWidget,o=a.get("cachedCrosshairWorldPosition");i.moveCrosshairs(o,n,r)}function s(n,r){var a=t.apis,i=t.apiIndex,o=a[i],s=ne.a.newInstance();s.setCoordinateSystemToDisplay(),s.setValue(n.x,n.y,0);for(var c=s.getComputedWorldValue(r),u=r.getActiveCamera().getDirectionOfProjection(),d=o.getSlabThickness()/2,l=0;l<c.length;l++)c[l]+=d*u[l];o.svgWidgets.rotatableCrosshairsWidget.moveCrosshairs(c,a,i),e.invokeInteractionEvent({type:"InteractionEvent"})}function c(e,n){var r=t.apis[t.apiIndex],a=r.svgWidgetManager,i=(r.volumes[0],a.getSize()),c=a.getScale(),u=i[1],d=r.genericRenderWindow.getRenderer(),l=r.svgWidgets.rotatableCrosshairsWidget;if(!l)throw new Error("Must use rotatable crosshair svg widget with this istyle.");var h,g=l.getReferenceLines(),p=0===e?1:0,f=l.getPoint(),v=[f[0]*c,u-f[1]*c],m=g[p].points;h=Math.abs(m[0].y-m[1].y)<1?m[0].x<m[1].x?[m[0],m[1]]:[m[1],m[0]]:m[0].y<m[1].y?[m[0],m[1]]:[m[1],m[0]];var w=[];o.subtract(w,[h[1].x,h[1].y],[h[0].x,h[0].y]),o.normalize(w,w),"forwards"===n&&(w[0]*=-1,w[1]*=-1);var y,b,M,S,C=function(e){var n=t.apis,r=t.apiIndex,a=n[r],i=a.volumes,s=a.genericRenderWindow.getRenderer(),c=i[0].getMapper().getInputData().getSpacing().map((function(e){return e*e})).reduce((function(e,t){return e+t}),0),u=ne.a.newInstance();u.setCoordinateSystemToDisplay(),u.setValue(e[0],e[1],0);var d=u.getComputedWorldValue(s);u.setValue(e[0]+1,e[1],0);var l=u.getComputedWorldValue(s),h=o.distance(d,l);return c/h}(f),k=[v[0]+w[0]*C,v[1]+w[1]*C];h[0].x<h[1].x?(y=h[0].x,b=h[1].x):(y=h[1].x,b=h[0].x),h[0].y<h[1].y?(M=h[0].y,S=h[1].y):(M=h[1].y,S=h[0].y),k[0]=Math.min(Math.max(k[0],y),b),k[1]=Math.min(Math.max(k[1],M),S),s({x:k[0]/c,y:(u-k[1])/c},d)}t.classHierarchy.push("vtkInteractorStyleRotatableMPRCrosshairs");var u=e.handleMouseMove;e.handleMouseMove=function(e){t.state===Uo.IS_WINDOW_LEVEL?a(e):function(e){var n,a=t.apis,s=t.apiIndex,c=t.lineGrabDistance,u=a[s],d=e.position,l=[!1,!1],h=[!1,!1],g=u.svgWidgets.rotatableCrosshairsWidget;if(!g)throw new Error("Must use rotatable crosshair svg widget with this istyle.");var p=g.getReferenceLines(),f=g.getPoint(),v=g.getCenterRadius();if(o.distance(f,[d.x,d.y])>v){for(var m=u.svgWidgetManager,w=m.getSize(),y=m.getScale(),b=w[1],M={x:d.x*y,y:b-d.y*y},S=!1,C=0;C<p.length;C++)for(var k=p[C].rotateHandles.points,x=0;x<k.length;x++){if(o.distance([k[x].x,k[x].y],[M.x,M.y])<c){l[C]=!0,S=!0;break}}if(!S){var I=r(p[0],M),R=r(p[1],M);if(I<=c||R<=c)h[I<R?0:1]=!0}}else h[0]=!0,h[1]=!0;p.forEach((function(e,t){var r=h[t],a=l[t],i=e.rotateHandles;e.selected!==r&&(e.selected=r,n=!0),i.selected!==a&&(i.selected=a,n=!0)})),n&&i()}(e),u&&u(e)},e.handleLeftButtonPress=function(i){t.volumeActor&&(!function(e){var a=t.apis,i=t.apiIndex,s=t.lineGrabDistance,c=a[i],u=e.position;n();var d=c.svgWidgets.rotatableCrosshairsWidget;if(!d)throw new Error("Must use rotatable crosshair svg widget with this istyle.");var l=d.getReferenceLines(),h=d.getPoint(),g=d.getCenterRadius();if(o.distance(h,[u.x,u.y])<g)return t.operation={type:No.MOVE_CROSSHAIRS},void l.forEach((function(e){e.selected=!0}));for(var p=c.svgWidgetManager,f=p.getSize(),v=p.getScale(),m=f[1],w={x:u.x*v,y:m-u.y*v},y=0;y<l.length;y++)for(var b=l[y].rotateHandles,M=b.points,S=0;S<M.length;S++){if(o.distance([M[S].x,M[S].y],[w.x,w.y])<s)return t.operation={type:No.ROTATE_CROSSHAIRS,prevPosition:u},b.selected=!0,void(0===y?(l[0].active=!0,l[1].active=!1):(l[0].active=!1,l[1].active=!0))}var C=r(l[0],w),k=r(l[1],w);if(C<=s||k<=s){var x=C<k?0:1;return l[x].selected=!0,l[x].active=!0,l[0===x?1:0].active=!1,void(t.operation={type:No.MOVE_REFERENCE_LINE,snapToLineIndex:0===x?1:0})}l.forEach((function(e){e.active=!1})),n(),t.operation={type:null}}(i),a(i),e.startWindowLevel())},e.superHandleLeftButtonRelease=e.handleLeftButtonRelease,e.handleLeftButtonRelease=function(n){switch(t.state){case Uo.IS_WINDOW_LEVEL:!function(n){t.operation={type:null};var r=t.apis,a=t.apiIndex,o=r[a].svgWidgets.rotatableCrosshairsWidget;if(!o)throw new Error("Must use rotatable crosshair svg widget with this istyle.");o.getReferenceLines().forEach((function(e){e.selected=!1,e.rotateHandles.selected=!1})),i(),e.endWindowLevel()}();break;default:e.superHandleLeftButtonRelease()}};var l=e.scrollToSlice;e.scrollToSlice=function(n){var r,a=t.apis,i=t.apiIndex,o=(t.lineGrabDistance,a[i].svgWidgets.rotatableCrosshairsWidget);if(!o)throw new Error("Must use rotatable crosshair svg widget with this istyle.");if(o.getReferenceLines().forEach((function(e,t){e.active&&(r=t)})),void 0===r)t.disableNormalMPRScroll||l(n);else{var s=e.getSlice()-n;c(r,s>0?"forwards":"backwards")}}}var Go={operation:{type:null},lineGrabDistance:20,disableNormalMPRScroll:!1};function Ho(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,Go,n),Qr.extend(e,t,n),U.a.setGet(e,t,["callback","apis","apiIndex","onScroll","operation","lineGrabDistance","disableNormalMPRScroll"]),Bo(e,t)}var _o=U.a.newInstance(Ho,"vtkInteractorStyleRotatableMPRCrosshairs"),zo=Object.assign({newInstance:_o,extend:Ho}),Yo=n(48),Qo=n.n(Yo),Ko=ae.a.States;var Xo={};function Zo(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,Xo,n),so.a.extend(e,t,n),U.a.setGet(e,t,["callback","apis","apiIndex","imageActor"]),function(e,t){t.classHierarchy.push("vtkInteractorStyleCrosshairsImageMapper"),t.planeManipulator=Qo.a.newInstance(),e.resetCrosshairs=function(){var n=t.apis,r=t.apiIndex;n[r].svgWidgets.crosshairsWidget.moveCrosshairs(e.getSliceCenter(),n,r,!0),e.invokeInteractionEvent({type:"InteractionEvent"})},e.moveCrosshairs=function(n){var r=t.apis,a=t.apiIndex,i=r[a];t.planeManipulator.setNormal(e.getSliceNormal()),t.planeManipulator.setOrigin(e.getSliceCenter());var o=t.planeManipulator.handleEvent(n,i.genericRenderWindow.getOpenGLRenderWindow());i.svgWidgets.crosshairsWidget.moveCrosshairs(o,r,a),e.invokeInteractionEvent({type:"InteractionEvent"})},e.updateCrosshairsAfterScroll=function(){var n=t.apis,r=t.apiIndex,a=n[r],i=a.genericRenderWindow.getRenderer().getActiveCamera();a.actor.getMapper().setSliceFromCamera(i);var o=a.get("cachedCrosshairWorldPosition"),s=e.getSliceNormal().findIndex((function(e){return 1==Math.abs(Math.round(e))}));o[s]=i.getFocalPoint()[s],a.svgWidgets.crosshairsWidget.moveCrosshairs(o,n,r),e.invokeInteractionEvent({type:"InteractionEvent"})};var n=e.handleMouseMove;e.handleMouseMove=function(r){t.state===Ko.IS_ROTATE?e.moveCrosshairs(r):n&&n(r)};var r=e.handleLeftButtonPress;e.handleLeftButtonPress=function(n){!t.imageActor||n.shiftKey||n.controlKey?r&&r(n):(e.moveCrosshairs(n),e.startRotate())};var a=e.handleLeftButtonRelease;e.handleLeftButtonRelease=function(){switch(t.state){case Ko.IS_ROTATE:e.endRotate();break;default:a()}};var i=e.handleMouseWheel;e.handleMouseWheel=function(t){i(t),e.updateCrosshairsAfterScroll()},e.handleKeyPress=function(e){},e.handleKeyDown=function(e){},e.handleKeyUp=function(e){},e.getSliceNormal=function(){return t.interactor.getCurrentRenderer().getActiveCamera().getDirectionOfProjection()},e.getSliceCenter=function(){return bo.a.getCenter(t.imageActor.getBoundsForSlice())},e.setImageActor=function(e){t.imageActor=e;var n=t.interactor.getCurrentRenderer().getActiveCamera();e?n.setFreezeFocalPoint(!0):n.setFreezeFocalPoint(!1)}}(e,t)}var Jo=U.a.newInstance(Zo,"vtkInteractorStyleCrosshairsImageMapper"),$o=Object.assign({newInstance:Jo,extend:Zo}),es=ae.a.States;var ts={rotateStartPos:[0,0]};function ns(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,ts,n),Qr.extend(e,t,n),U.a.setGet(e,t,["onInteractiveRotateChanged"]),function(e,t){t.classHierarchy.push("vtkInteractorStyleMPRRotate"),t.wlStartPos=[0,0];var n=e.handleMouseMove;e.handleMouseMove=function(r){var a=[Math.round(r.position.x),Math.round(r.position.y)],i=r.pokedRenderer;t.state===es.IS_ROTATE&&(e.rotateFromMouse(a,i),e.invokeInteractionEvent({type:"InteractionEvent"})),n&&n(r)},e.rotateFromMouse=function(n,r){var a=t.interactor.getView().getViewportSize(r),i=100/a[0],o=100/a[1],s=-(n[1]-t.rotateStartPos[1])*o,c=-(n[0]-t.rotateStartPos[0])*i;e.getViewport().rotateRelative(s,c),t.rotateStartPos[0]=Math.round(n[0]),t.rotateStartPos[1]=Math.round(n[1]);var u=t.apis,d=t.apiIndex,l=u[d];if(l.svgWidgets.crosshairsWidget||l.svgWidgets.rotatableCrosshairsWidget){var g=l.get("cachedCrosshairWorldPosition");if(void 0!==g){var p=ne.a.newInstance();p.setCoordinateSystemToWorld(),p.setValue.apply(p,h()(g));var f=p.getComputedDoubleDisplayValue(r),v=ne.a.newInstance();v.setCoordinateSystemToDisplay(),v.setValue(f[0],f[1],0);for(var m=v.getComputedWorldValue(r),w=r.getActiveCamera().getDirectionOfProjection(),y=l.getSlabThickness()/2,b=0;b<m.length;b++)m[b]+=y*w[b];l.svgWidgets.crosshairsWidget&&l.svgWidgets.crosshairsWidget.moveCrosshairs(m,u,d),l.svgWidgets.rotatableCrosshairsWidget&&l.svgWidgets.rotatableCrosshairsWidget.moveCrosshairs(m,u,d)}}};var r=e.handleLeftButtonPress;e.handleLeftButtonPress=function(n){(t.rotateStartPos[0]=Math.round(n.position.x),t.rotateStartPos[1]=Math.round(n.position.y),n.shiftKey||n.controlKey)?r&&r(n):t.volumeActor.getProperty()&&e.startRotate()},e.superHandleLeftButtonRelease=e.handleLeftButtonRelease,e.handleLeftButtonRelease=function(){switch(t.state){case es.IS_ROTATE:e.endRotate();break;default:e.superHandleLeftButtonRelease()}}}(e,t)}var rs=U.a.newInstance(ns,"vtkInteractorStyleMPRRotate"),as=Object.assign({newInstance:rs,extend:ns});var is={currentImageNumber:0};function os(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};so.a.extend(e,t,n),Object.assign(t,is,n),U.a.setGet(e,t,["onLevelsChanged","levelScale"]),function(e,t){t.classHierarchy.push("vtkInteractorStyleImageWindowLevel"),e.superWindowLevel=e.windowLevel,e.windowLevel=function(n,r){e.superWindowLevel(n,r);var a=t.currentImageProperty.getColorWindow(),i=t.currentImageProperty.getColorLevel(),o=e.getOnLevelsChanged();o&&o({windowCenter:i,windowWidth:a})},e.handleKeyPress=function(e){},e.handleKeyDown=function(e){},e.handleKeyUp=function(e){}}(e,t)}var ss=U.a.newInstance(os,"vtkInteractorStyleImageWindowLevel"),cs=Object.assign({newInstance:ss,extend:os}),us=n(22),ds=n.n(us),ls=ae.a.States;var hs={};function gs(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,hs,n),ds.a.extend(e,t,n),U.a.setGet(e,t,["apis","apiIndex"]),function(e,t){t.classHierarchy.push("vtkInteractorStyleImagePanZoom"),e.superStartPan=e.startPan,e.startPan=function(){t.apis[t.apiIndex].setFreezeSlice(!0),e.superStartPan()},e.superEndPan=e.endPan,e.endPan=function(){t.apis[t.apiIndex].setFreezeSlice(!1),e.superEndPan()},e.handleLeftButtonPress=function(n){n.shiftKey||n.controlKey?(t.previousTranslation=n.translation,e.startPan()):(t.previousPosition=n.position,e.startDolly())},e.handleLeftButtonRelease=function(n){switch(t.state){case ls.IS_PAN:e.endPan();break;default:e.endDolly()}},e.handleRightButtonPress=function(n){t.previousTranslation=n.translation,e.startPan()},e.handleRightButtonRelease=function(t){e.endPan()},e.handleStartMouseWheel=function(t){e.startSlice(),e.handleMouseWheel(t)},e.handleEndMouseWheel=function(){e.endSlice()},e.handleMouseWheel=function(e){var t=e.pokedRenderer.getActiveCamera(),n=t.getDistance();n+=e.spinY;var r=t.getClippingRange();n<r[0]&&(n=r[0]),n>r[1]&&(n=r[1]),t.setDistance(n)},e.handleKeyPress=function(e){},e.handleKeyDown=function(e){},e.handleKeyUp=function(e){}}(e,t)}var ps=U.a.newInstance(gs,"vtkInteractorStyleImagePanZoom"),fs=Object.assign({newInstance:ps,extend:gs}),vs=1;function ms(e,t){t.classHierarchy.push("vtkSVGCrosshairsWidget"),t.widgetId="vtkSVGCrosshairsWidget-".concat(vs++),e.render=function(e,n){var r=function(e,t){var n=e.querySelector("#".concat(t));return n||((n=document.createElement("g")).setAttribute("id",t),e.appendChild(n)),n}(e,t.widgetId),a=t.point,i=t.strokeColor,o=t.strokeWidth,s=t.strokeDashArray,c=t.padding;if(null!==a[0]&&null!==a[1]){var u=parseInt(e.getAttribute("width"),10),d=parseInt(e.getAttribute("height"),10),l=a.slice();l[0]=a[0]*n,l[1]=d-a[1]*n;var h=[0,d/n/2],g=[u/n/2,0],p=[u/n,d/n/2],f=[u/n/2,d/n];t.display?r.innerHTML='\n      <g id="container" fill-opacity="1" stroke-dasharray="none" stroke="none" stroke-opacity="1" fill="none">\n       <g>\n       \x3c!-- TODO: Why is this <svg> necessary?? </svg> If I don\'t include it, nothing renders !--\x3e\n       <svg version="1.1" viewBox="0 0 '.concat(u," ").concat(d,'" width=').concat(u," height=").concat(d,' style="width: 100%; height: 100%">\n       \x3c!-- Top !--\x3e\n        <line\n          x1="').concat(l[0],'"\n          y1="').concat(g[1],'"\n          x2="').concat(l[0],'"\n          y2="').concat(l[1]-c,'"\n          stroke="').concat(i,'"\n          stroke-dasharray="').concat(s,'"\n          stroke-linecap="round"\n          stroke-linejoin="round"\n          stroke-width="').concat(o,'"\n        ></line>\n        \x3c!-- Right !--\x3e\n        <line\n          x1="').concat(p[0],'"\n          y1="').concat(l[1],'"\n          x2="').concat(l[0]+c,'"\n          y2="').concat(l[1],'"\n          stroke-dasharray="').concat(s,'"\n          stroke="').concat(i,'"\n          stroke-linecap="round"\n          stroke-linejoin="round"\n          stroke-width=').concat(o,'\n        ></line>\n        \x3c!-- Bottom !--\x3e\n        <line\n          x1="').concat(l[0],'"\n          y1="').concat(f[1],'"\n          x2="').concat(l[0],'"\n          y2="').concat(l[1]+c,'"\n          stroke-dasharray="').concat(s,'"\n          stroke="').concat(i,'"\n          stroke-linecap="round"\n          stroke-linejoin="round"\n          stroke-width=').concat(o,'\n        ></line>\n        \x3c!-- Left !--\x3e\n        <line\n          x1="').concat(h[0],'"\n          y1="').concat(l[1],'"\n          x2="').concat(l[0]-c,'"\n          y2="').concat(l[1],'"\n          stroke-dasharray="').concat(s,'"\n          stroke="').concat(i,'"\n          stroke-linecap="round"\n          stroke-linejoin="round"\n          stroke-width=').concat(o,"\n        ></line>\n       </g>\n      </g>\n            "):r.innerHTML=""}},e.resetCrosshairs=function(t,n){var r=t[n];if(r.svgWidgets.crosshairsWidget){var a=r.genericRenderWindow.getRenderer(),i=a.getRenderWindow().getViews()[0].getViewportSize(a),o=ne.a.newInstance();o.setCoordinateSystemToDisplay(),o.setValue(.5*i[0],.5*i[1],0);for(var s=o.getComputedWorldValue(a),c=a.getActiveCamera().getDirectionOfProjection(),u=r.getSlabThickness()/2,d=0;d<s.length;d++)s[d]+=u*c[d];e.moveCrosshairs(s,t)}},e.moveCrosshairs=function(e,t){void 0!==e&&void 0!==t||console.error("worldPos, apis must be defined in order to update crosshairs."),t.forEach((function(t,n){t.set("cachedCrosshairWorldPosition",e);var r=t.genericRenderWindow.getRenderWindow(),a=r.getInteractor().getInteractorStyle(),i=a.getSliceNormal(),o=H.a.buildFromDegree().identity().rotateFromDirections(i,[1,0,0]),s=e.slice();o.apply(s);var c=s[0];a.setSlice(c),r.render();var u=t.genericRenderWindow.getRenderer(),d=ne.a.newInstance();d.setCoordinateSystemToWorld(),d.setValue.apply(d,h()(e));var l=d.getComputedDisplayValue(u),g=t.svgWidgetManager;t.svgWidgets.crosshairsWidget.setPoint(l[0],l[1]),g.render()}))},e.updateCrosshairForApi=function(t){if(t.svgWidgets.crosshairsWidget){var n=t.genericRenderWindow.getRenderer(),r=t.get("cachedCrosshairWorldPosition"),a=ne.a.newInstance();a.setCoordinateSystemToWorld(),a.setValue.apply(a,h()(r));var i=a.getComputedDoubleDisplayValue(n),o=ne.a.newInstance();o.setCoordinateSystemToDisplay(),o.setValue(i[0],i[1],0);for(var s=o.getComputedWorldValue(n),c=n.getActiveCamera().getDirectionOfProjection(),u=t.getSlabThickness()/2,d=0;d<s.length;d++)s[d]+=u*c[d];e.moveCrosshairs(s,[t])}}}var ws={point:[null,null],strokeColor:"#00ff00",strokeWidth:1,strokeDashArray:"",padding:20,display:!0};function ys(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,ws,n),U.a.obj(e,t),U.a.get(e,t,["widgetId"]),U.a.setGet(e,t,["strokeColor","strokeWidth","strokeDashArray","display"]),U.a.setGetArray(e,t,["point","padding"],2),ms(e,t)}var bs={newInstance:U.a.newInstance(ys,"vtkSVGCrosshairsWidget"),extend:ys},Ms=1;function Ss(e,t){t.classHierarchy.push("vtkSVGCrosshairsWidgetImageMapper"),t.widgetId="vtkSVGCrosshairsWidgetImageMapper-".concat(Ms++),e.render=function(e,n){var r=function(e,t){var n=e.querySelector("#".concat(t));return n||((n=document.createElement("g")).setAttribute("id",t),e.appendChild(n)),n}(e,t.widgetId),a=t.point,i=t.strokeColor,o=t.strokeWidth,s=t.strokeDashArray,c=t.padding;if(null!==a[0]&&null!==a[1]){var u=parseInt(e.getAttribute("width"),10),d=parseInt(e.getAttribute("height"),10),l=a.slice();l[0]=a[0]*n,l[1]=d-a[1]*n;var h=[0,d/n/2],g=[u/n/2,0],p=[u/n,d/n/2],f=[u/n/2,d/n];t.display?r.innerHTML='\n      <g id="container" fill-opacity="1" stroke-dasharray="none" stroke="none" stroke-opacity="1" fill="none">\n       <g>\n       \x3c!-- TODO: Why is this <svg> necessary?? </svg> If I don\'t include it, nothing renders !--\x3e\n       <svg version="1.1" viewBox="0 0 '.concat(u," ").concat(d,'" width=').concat(u," height=").concat(d,' style="width: 100%; height: 100%">\n       \x3c!-- Top !--\x3e\n        <line\n          x1="').concat(l[0],'"\n          y1="').concat(g[1],'"\n          x2="').concat(l[0],'"\n          y2="').concat(l[1]-c,'"\n          stroke="').concat(i,'"\n          stroke-dasharray="').concat(s,'"\n          stroke-linecap="round"\n          stroke-linejoin="round"\n          stroke-width="').concat(o,'"\n        ></line>\n        \x3c!-- Right !--\x3e\n        <line\n          x1="').concat(p[0],'"\n          y1="').concat(l[1],'"\n          x2="').concat(l[0]+c,'"\n          y2="').concat(l[1],'"\n          stroke-dasharray="').concat(s,'"\n          stroke="').concat(i,'"\n          stroke-linecap="round"\n          stroke-linejoin="round"\n          stroke-width=').concat(o,'\n        ></line>\n        \x3c!-- Bottom !--\x3e\n        <line\n          x1="').concat(l[0],'"\n          y1="').concat(f[1],'"\n          x2="').concat(l[0],'"\n          y2="').concat(l[1]+c,'"\n          stroke-dasharray="').concat(s,'"\n          stroke="').concat(i,'"\n          stroke-linecap="round"\n          stroke-linejoin="round"\n          stroke-width=').concat(o,'\n        ></line>\n        \x3c!-- Left !--\x3e\n        <line\n          x1="').concat(h[0],'"\n          y1="').concat(l[1],'"\n          x2="').concat(l[0]-c,'"\n          y2="').concat(l[1],'"\n          stroke-dasharray="').concat(s,'"\n          stroke="').concat(i,'"\n          stroke-linecap="round"\n          stroke-linejoin="round"\n          stroke-width=').concat(o,"\n        ></line>\n       </g>\n      </g>\n            "):r.innerHTML=""}},e.moveCrosshairs=function(e,t,n,r){if(void 0!==e&&void 0!==t||console.error("worldPos, apis must be defined in order to update crosshairs."),r){var a=t[n].get("cachedCrosshairWorldPosition");e=a||e}t.forEach((function(t,r){if(t.svgWidgets&&t.svgWidgets.crosshairsWidget){t.set("cachedCrosshairWorldPosition",e);var a=t.genericRenderWindow.getRenderWindow(),i=t.genericRenderWindow.getRenderer(),o=ne.a.newInstance();o.setCoordinateSystemToWorld(),o.setValue.apply(o,h()(e));var s=o.getComputedDisplayValue(i),c=t.svgWidgetManager;if(t.svgWidgets.crosshairsWidget.setPoint(s[0],s[1]),c.render(),"VIEW2D"===t.type&&r!==n){var u=a.getInteractor().getInteractorStyle(),d=i.getActiveCamera(),l=t.actor.getMapper(),g=d.getFocalPoint(),p=u.getSliceCenter(),f=[];N.subtract(g,p,f);var v=l.getSliceAtPosition(e);l.setSlice(v);var m=u.getSliceCenter(),w=[];N.add(m,f,w),d.setFocalPoint.apply(d,w)}a.render()}}))}}var Cs={point:[null,null],strokeColor:"#00ff00",strokeWidth:1,strokeDashArray:"",padding:20,display:!0};function ks(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,Cs,n),U.a.obj(e,t),U.a.get(e,t,["widgetId"]),U.a.setGet(e,t,["strokeColor","strokeWidth","strokeDashArray","display"]),U.a.setGetArray(e,t,["point","padding"],2),Ss(e,t)}var xs={newInstance:U.a.newInstance(ks,"vtkSVGCrosshairsWidgetImageMapper"),extend:ks},Is=1e-6,Rs=1;function Ws(e,t,n){var r=d()(n,2),a=r[0],i=r[1];if(Math.abs(t)<Is)return e<0;var o=e/t;if(t>0){if(o>i)return 0;o>a&&(n[0]=o)}else{if(o<a)return 0;o<i&&(n[1]=o)}return 1}var Ps=1;function Ts(e,t){t.classHierarchy.push("vtkSVGRotatableCrosshairsWidget"),t.widgetId="vtkSVGRotatableCrosshairsWidget-".concat(Ps++),t.calculateReferenceLines=function(e,n){var r=t.strokeColors,i=t.apis;if(null!==n[0]&&null!==n[1]){var s=i[e],c=s.svgWidgetManager,u=c.getSize(),l=d()(u,2),h=l[0],g=l[1],p=c.getScale(),f=n.slice();f[0]=n[0]*p,f[1]=g-n[1]*p;for(var v=h/p,m=g/p,w=Math.min(h,g)/4,y=Math.sqrt(m*m+v*v),b=[],M=i[e].get("cachedCrosshairWorldPosition"),S=s.svgWidgets.rotatableCrosshairsWidget,C=S.getReferenceLines(),k=function(t){if(t!==e){var n=i[t],c=n.getViewUp(),u=n.getSliceNormal(),l=[];a.cross(l,c,u),a.normalize(l,l);var h=[M[0]+1e6*(c[0]+l[0]),M[1]+1e6*(c[1]+l[1]),M[2]+1e6*(c[2]+l[2])],S=s.genericRenderWindow.getRenderer(),k=ne.a.newInstance();k.setCoordinateSystemToWorld(),k.setValue.apply(k,h);var x=k.getComputedDoubleDisplayValue(S),I=[x[0]*p,g-x[1]*p],R=[];o.subtract(R,f,I),o.normalize(R,R);var W=[f[0]+R[0]*y,f[1]+R[1]*y],P=[f[0]-R[0]*y,f[1]-R[1]*y];!function(e,t,n,r,a){var i=d()(e,2),o=i[0],s=i[1],c=d()(t,2),u=c[0]-o,l=c[1]-s;if(void 0===r||void 0===a?(r=e,a=t):(r[0]=e[0],r[1]=e[1],a[0]=t[0],a[1]=t[1]),Math.abs(u)<Is&&Math.abs(l)<Is&&o>=n[0]&&o<=n[2]&&s>=n[1]&&s<=n[3])return Rs;var h=[0,1];if(Ws(n[0]-o,u,h)&&Ws(o-n[2],-u,h)&&Ws(n[1]-s,l,h)&&Ws(s-n[3],-l,h)){var g=h[0],p=h[1];return p<1&&(a[0]=o+p*u,a[1]=s+p*l),g>0&&(r[0]+=g*u,r[1]+=g*l),Rs}}(P,W,[0,0,v,m]);var T=C.find((function(e){return e&&e.apiIndex===t})),D=!1,A=!1,E=!1;T&&(D=T.selected,A=T.rotateHandles.selected,E=T.active);var O={x:f[0]+w*R[0],y:f[1]+w*R[1]},j={x:f[0]-w*R[0],y:f[1]-w*R[1]},q={points:[{x:P[0],y:P[1]},{x:W[0],y:W[1]}],rotateHandles:{selected:A,points:[O,j]},color:r[t],apiIndex:t,selected:D,active:E};b.push(q)}},x=0;x<i.length;x++)k(x);S.setReferenceLines(b[0],b[1])}},e.render=function(e,n){var r=function(e,t){var n=e.querySelector("#".concat(t));return n||((n=document.createElement("g")).setAttribute("id",t),e.appendChild(n)),n}(e,t.widgetId),a=t.point,i=t.strokeColors,o=t.strokeWidth,s=t.strokeDashArray,c=t.rotateHandleRadius,u=t.apis,l=t.apiIndex,h=t.selectedStrokeWidth;if(null!==a[0]&&null!==a[1]){var g=u[l].svgWidgets.rotatableCrosshairsWidget.getReferenceLines(),p=parseInt(e.getAttribute("width"),10),f=parseInt(e.getAttribute("height"),10),v=a.slice();v[0]=a[0]*n,v[1]=f-a[1]*n;var m=d()(g,2),w=m[0],y=m[1],b=w.rotateHandles,M=b.points,S=b.selected,C=y.rotateHandles,k=C.points,x=C.selected,I=t.getSplitReferenceLine(w,v),R=d()(I,2),W=R[0],P=R[1],T=t.getSplitReferenceLine(y,v),D=d()(T,2),A=D[0],E=D[1],O=i[w.apiIndex],j=i[y.apiIndex],q=w.selected||w.active?h:o,L=y.selected||y.active?h:o,V=S?h:o,F=x?h:o,U=w.selected||S?c:0,N=y.selected||x?c:0,B=S?g[0].color:"none",G=x?g[1].color:"none";t.display?r.innerHTML='\n      <g id="container" fill-opacity="1" stroke-dasharray="none" stroke="none" stroke-opacity="1" fill="none">\n       <g>\n       <svg version="1.1" viewBox="0 0 '.concat(p," ").concat(f,'" width=').concat(p," height=").concat(f,' style="width: 100%; height: 100%">\n        <g\n\n          stroke="').concat(O,'"\n          stroke-dasharray="').concat(s,'"\n          stroke-linecap="round"\n          stroke-linejoin="round"\n          stroke-width="').concat(q,'"\n        >\n        \x3c!-- First Line part 1!--\x3e\n          <line\n            x1="').concat(W[0].x,'"\n            y1="').concat(W[0].y,'"\n            x2="').concat(W[1].x,'"\n            y2="').concat(W[1].y,'"\n          ></line>\n          \x3c!-- First Line part 2!--\x3e\n          <line\n            x1="').concat(P[0].x,'"\n            y1="').concat(P[0].y,'"\n            x2="').concat(P[1].x,'"\n            y2="').concat(P[1].y,'"\n          ></line>\n        </g>\n        <g\n          stroke="').concat(g[0].color,'"\n          stroke-dasharray="').concat(s,'"\n          stroke-linecap="round"\n          stroke-linejoin="round"\n          stroke-width="').concat(V,'"\n        >\n            \x3c!--First line rotateHandle 0 --\x3e\n            <circle cx="').concat(M[0].x,'" cy="').concat(M[0].y,'" r="').concat(U,'" fill="').concat(B,'" />\n            \x3c!--First line rotateHandle 1 --\x3e\n            <circle cx="').concat(M[1].x,'" cy="').concat(M[1].y,'" r="').concat(U,'" fill="').concat(B,'" />\n        </g>\n        <g\n          stroke-dasharray="').concat(s,'"\n          stroke="').concat(j,'"\n          stroke-linecap="round"\n          stroke-linejoin="round"\n          stroke-width=').concat(L,'\n        >\n          \x3c!-- Second Line part 1 !--\x3e\n          <line\n            x1="').concat(A[0].x,'"\n            y1="').concat(A[0].y,'"\n            x2="').concat(A[1].x,'"\n            y2="').concat(A[1].y,'"\n          ></line>\n          \x3c!-- Second Line part 2 !--\x3e\n          <line\n            x1="').concat(E[0].x,'"\n            y1="').concat(E[0].y,'"\n            x2="').concat(E[1].x,'"\n            y2="').concat(E[1].y,'"\n          ></line>\n      </g>\n      <g\n        stroke-dasharray="').concat(s,'"\n        stroke="').concat(g[1].color,'"\n        stroke-linecap="round"\n        stroke-linejoin="round"\n        stroke-width=').concat(F,'\n      >\n        \x3c!--Second line rotateHandle 0 --\x3e\n        <circle cx="').concat(k[0].x,'" cy="').concat(k[0].y,'" r="').concat(N,'" fill="').concat(G,'" />\n        \x3c!--Second line rotateHandle 1 --\x3e\n        <circle cx="').concat(k[1].x,'" cy="').concat(k[1].y,'" r="').concat(N,'" fill="').concat(G,'" />\n      </g>\n      <circle cx="').concat(p-20,'" cy="',20,'" r="10" fill="').concat(i[l],'" />\n      </g>\n\n      '):r.innerHTML=""}},t.getSplitReferenceLine=function(e,n){var r=t.centerRadius,a=[];return o.subtract(a,[e.points[1].x,e.points[1].y],[e.points[0].x,e.points[0].y]),o.normalize(a,a),[[{x:n[0]+a[0]*r,y:n[1]+a[1]*r},e.points[1]],[{x:n[0]-a[0]*r,y:n[1]-a[1]*r},e.points[0]]]},e.resetCrosshairs=function(t,n){var r=t[n];if(r.svgWidgets.rotatableCrosshairsWidget){var a=r.genericRenderWindow.getRenderer(),i=a.getRenderWindow().getViews()[0].getViewportSize(a),o=ne.a.newInstance();o.setCoordinateSystemToDisplay(),o.setValue(.5*i[0],.5*i[1],0);for(var s=o.getComputedWorldValue(a),c=a.getActiveCamera().getDirectionOfProjection(),u=r.getSlabThickness()/2,d=0;d<s.length;d++)s[d]+=u*c[d];e.moveCrosshairs(s,t)}},e.moveCrosshairs=function(e,n){void 0!==e&&void 0!==n||console.error("worldPos, apis must be defined in order to update crosshairs."),n.forEach((function(n,r){n.set("cachedCrosshairWorldPosition",e),void 0===n.get("initialCachedCrosshairWorldPosition")&&n.set("initialCachedCrosshairWorldPosition",e);var a=n.genericRenderWindow.getRenderWindow(),i=a.getInteractor().getInteractorStyle(),o=i.getSliceNormal(),s=H.a.buildFromDegree().identity().rotateFromDirections(o,[1,0,0]),c=e.slice();s.apply(c);var u=c[0];i.setSlice(u),a.render();var d=n.genericRenderWindow.getRenderer(),l=ne.a.newInstance();l.setCoordinateSystemToWorld(),l.setValue.apply(l,h()(e));var g=l.getComputedDoubleDisplayValue(d),p=n.svgWidgetManager;n.svgWidgets.rotatableCrosshairsWidget.setPoint(g[0],g[1]),t.calculateReferenceLines(r,g),p.render()}))},e.updateCrosshairForApi=function(t){if(t.svgWidgets.rotatableCrosshairsWidget){var n=t.genericRenderWindow.getRenderer(),r=t.get("cachedCrosshairWorldPosition"),a=ne.a.newInstance();a.setCoordinateSystemToWorld(),a.setValue.apply(a,h()(r));var i=a.getComputedDoubleDisplayValue(n),o=ne.a.newInstance();o.setCoordinateSystemToDisplay(),o.setValue(i[0],i[1],0);for(var s=o.getComputedWorldValue(n),c=n.getActiveCamera().getDirectionOfProjection(),u=t.getSlabThickness()/2,d=0;d<s.length;d++)s[d]+=u*c[d];e.moveCrosshairs(s,[t])}}}var Ds={point:[null,null],apis:[null,null,null],referenceLines:[null,null],strokeColors:["#e83a0e","#ede90c","#07e345"],strokeWidth:1,rotateHandleRadius:5,selectedStrokeWidth:3,centerRadius:20,strokeDashArray:"",display:!0};function As(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,Ds,n),U.a.obj(e,t),U.a.get(e,t,["widgetId"]),U.a.setGet(e,t,["strokeWidth","selectedStrokeWidth","strokeDashArray","display","apiIndex","referenceLines","centerRadius"]),U.a.setGetArray(e,t,["point","referenceLines"],2),U.a.setGetArray(e,t,["apis","strokeColors"],3),Ts(e,t)}var Es={newInstance:U.a.newInstance(As,"vtkSVGRotatableCrosshairsWidget"),extend:As},Os=n(11),js=n.n(Os);var qs=new Map;function Ls(e,t){var n=qs.get(t);if(n)return n;var r,i=function(e){var t=e[0],n=js.a.metaData.get("imagePixelModule",t),r=n.pixelRepresentation,a=n.bitsAllocated,i=n.bitsStored,o=n.highBit,s=n.photometricInterpretation,c=n.samplesPerPixel,u=js.a.metaData.get("voiLutModule",t),d=u.windowWidth,l=u.windowCenter;Array.isArray(d)&&(d=d[0]),Array.isArray(l)&&(l=l[0]);var h=js.a.metaData.get("generalSeriesModule",t).modality,g=new Map;return e.forEach((function(e){var t=js.a.metaData.get("imagePlaneModule",e);g.set(e,t)})),{metaData0:g.values().next().value,metaDataMap:g,imageIds:e,imageMetaData0:{bitsAllocated:a,bitsStored:i,samplesPerPixel:c,highBit:o,photometricInterpretation:s,pixelRepresentation:r,windowWidth:d,windowCenter:l,modality:h}}}(e),o=i.metaData0,s=i.metaDataMap,c=i.imageMetaData0,u=o.rowCosines,d=o.columnCosines,l=a.fromValues.apply(a,h()(u)),g=a.fromValues.apply(a,h()(d)),p=a.cross([],l,g),f=function(e,t){var n=Array.from(t.values()),r=n[0],i=n.map((function(t){var n=a.sub([],r.imagePositionPatient,t.imagePositionPatient);return{distance:a.dot(n,e),dataset:t}}));i.sort((function(e,t){return t.distance-e.distance}));var o=i.map((function(e){return e.dataset})),s=i.map((function(e){return e.distance}));return{spacing:Math.abs(s[1]-s[0]),origin:i[0].dataset.imagePositionPatient,sortedDatasets:o}}(p,s),v=f.spacing,m=f.origin,w=f.sortedDatasets,y=o.columnPixelSpacing,b=o.rowPixelSpacing,M=v,S=o.columns,C=o.rows,k=s.size,x=1===c.pixelRepresentation;if(o.numberOfComponents>1)throw new Error("Multi component image not supported by this plugin.");switch(c.bitsAllocated){case 8:throw x?new Error("8 Bit signed images are not yet supported by this plugin."):new Error("8 Bit unsigned images are not yet supported by this plugin.");case 16:r=new Float32Array(S*C*k)}var I=Hi.a.newInstance({name:"Pixels",numberOfComponents:1,values:r}),R=Bi.a.newInstance(),W=[].concat(h()(l),h()(g),h()(p));R.setDimensions(S,C,k),R.setSpacing(y,b,M),R.setDirection(W),R.setOrigin.apply(R,h()(m)),R.getPointData().setScalars(I);var P={imageIds:e,metaData0:o,imageMetaData0:c,dimensions:[S,C,k],spacing:[y,b,M],origin:m,direction:W,vtkImageData:R,metaDataMap:s,sortedDatasets:w,loaded:!1,subscriptions:{onPixelDataInserted:[],onPixelDataInsertedError:[],onAllPixelDataInserted:[]},onPixelDataInserted:function(e){P.subscriptions.onPixelDataInserted.push(e)},onPixelDataInsertedError:function(e){P.subscriptions.onPixelDataInsertedError.push(e)},onAllPixelDataInserted:function(e){P.subscriptions.onAllPixelDataInserted.push(e)},_publishPixelDataInserted:function(e){P.subscriptions.onPixelDataInserted.forEach((function(t){t(e)}))},_publishAllPixelDataInserted:function(){P.subscriptions.onAllPixelDataInserted.forEach((function(e){e()})),P.isLoading=!1,P.loaded=!0,P.vtkImageData.modified(),P.subscriptions={onPixelDataInserted:[],onPixelDataInsertedError:[],onAllPixelDataInserted:[]}},_publishPixelDataInsertedError:function(e){P.subscriptions.onPixelDataInsertedError.forEach((function(t){t(e)}))}};return qs.set(t,P),P}function Vs(e){return parseFloat(".".concat(e))}function Fs(e){if(!e.loaded&&!e.isLoading){var t,n=e.imageIds,r=e.vtkImageData,a=e.metaDataMap,i=e.sortedDatasets,o=n[0],s=js.a.metaData.get("generalSeriesModule",o),c=s&&s.modality;"PT"===c&&(t=function(e){var t=js.a.metaData.get("generalSeriesModule",e),n=js.a.metaData.get("patientStudyModule",e);if(!n)throw new Error("patientStudyModule metadata is required");var r=n.patientWeight;if(!r)throw new Error("patientWeight must be present in patientStudyModule for modality PT");var a=js.a.metaData.get("petIsotopeModule",e);if(!a)throw new Error("petSequenceModule metadata is required");var i=a.radiopharmaceuticalInfo,o=i.radiopharmaceuticalStartTime,s=i.radionuclideTotalDose,c=i.radionuclideHalfLife,u=t.seriesTime;if(!(o&&s&&c&&u))throw new Error("The required radiopharmaceutical information was not present.");var d=Vs(u.fractionalSeconds||0)+u.seconds+60*u.minutes+60*u.hours*60-(Vs(o.fractionalSeconds)+o.seconds+60*o.minutes+60*o.hours*60);return{patientWeight:r,correctedDose:s*Math.exp(-d*Math.log(2)/c)}}(o)),e.isLoading=!0,r.getPointData().getScalars().getData()[0]=1;var u={max:Number.NEGATIVE_INFINITY,min:Number.POSITIVE_INFINITY},d=n.length,l=0,h=Math.min(d/10,20),g=h;!function(e,t,n){var r=function(e){D.requestPoolManager.addRequest({},e,Us,Ns,t,n)},a=e.length,i=Math.ceil(a/2),o=i-1;for(;o>=0;)r(e[o--]),i<a&&r(e[i++]);D.stackPrefetch.setConfiguration({maxSimultaneousRequests:7}),D.requestPoolManager.startGrabbing()}(n,(function(n){var o=a.get(n.imageId).imagePositionPatient,s=i.findIndex((function(e){return e.imagePositionPatient===o})),p=function(e,t,n,r,a){for(var i=e.getPointData().getScalars().getData(),o=function(e,t,n){var r=t.slope,a=t.intercept;if("PT"===e){var i=n.patientWeight,o=n.correctedDose;return function(e){return 1e3*(e*r+a)*i/o}}return function(e){return e*r+a}}(r,n,a),s=n.getPixelData(),c=s.length,u=o(s[0]),d=u,l=0;l<s.length;l++){var h=l+t*c,g=o(s[l]);g>u?u=g:g<d&&(d=g),i[h]=g}return{min:d,max:u}}(r,s,n,c,t),f=p.max,v=p.min;f>u.max&&(u.max=f),v<u.min&&(u.min=v),r.getPointData().getScalars().setRange(u,1),++l>g&&(l/d>.5&&(h=Math.min(d/5,50)),g+=h,r.modified()),e._publishPixelDataInserted(l),l===d&&e._publishAllPixelDataInserted()}),(function(t){l++,e._publishPixelDataInsertedError(t),l===d&&e._publishAllPixelDataInserted()}))}}var Us="prefetch",Ns=!1;var Bs=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e){for(var n=e.getProperty().getRGBTransferFunction(0),r=n.getSize(),a=0;a<r;a++){var i=[];n.getNodeValue(a,i),i[1]=1-i[1],i[2]=1-i[2],i[3]=1-i[3],n.setNodeValue(a,i)}t instanceof Function?t():t&&t.render&&t.render()}},Gs=n(32),Hs=n.n(Gs),_s=(n(70),n(71),n(72),function(){function e(t,n,r,a){p()(this,e),this.x=t,this.y=n,this.z=r,this.width=a,this.lines=[Hs.a.newInstance(),Hs.a.newInstance(),Hs.a.newInstance()],this.actors=[wo.a.newInstance(),wo.a.newInstance(),wo.a.newInstance()],this.mappers=[vo.a.newInstance(),vo.a.newInstance(),vo.a.newInstance()],this.lines[0].setPoint1([t-a,n,r]),this.lines[1].setPoint1([t,n-a,r]),this.lines[2].setPoint1([t,n,r-a]),this.lines[0].setPoint2([t+a,n,r]),this.lines[1].setPoint2([t,n+a,r]),this.lines[2].setPoint2([t,n,r+a]),this.actors[0].getProperty().setColor(255,0,0),this.actors[1].getProperty().setColor(0,255,0),this.actors[2].getProperty().setColor(0,0,255);for(var i=0;i<3;i++)this.actors[i].setMapper(this.mappers[i]),this.mappers[i].setInputConnection(this.lines[i].getOutputPort())}return v()(e,[{key:"setPoint",value:function(e,t,n){this.x=e,this.y=t,this.z=n,this.lines[0].setPoint1([this.x-this.width,this.y,this.z]),this.lines[1].setPoint1([this.x,this.y-this.width,this.z]),this.lines[2].setPoint1([this.x,this.y,this.z-this.width]),this.lines[0].setPoint2([this.x+this.width,this.y,this.z]),this.lines[1].setPoint2([this.x,this.y+this.width,this.z]),this.lines[2].setPoint2([this.x,this.y,this.z+this.width])}},{key:"setWidth",value:function(e){this.width=e,this.lines[0].setPoint1([this.x-this.width,this.y,this.z]),this.lines[1].setPoint1([this.x,this.y-this.width,this.z]),this.lines[2].setPoint1([this.x,this.y,this.z-this.width]),this.lines[0].setPoint2([this.x+this.width,this.y,this.z]),this.lines[1].setPoint2([this.x,this.y+this.width,this.z]),this.lines[2].setPoint2([this.x,this.y,this.z+this.width])}}]),e}()),zs=(n(73),n(49)),Ys=n.n(zs);var Qs={};function Ks(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,Qs,n),ds.a.extend(e,t,n),U.a.setGet(e,t,["apis","apiIndex","crosshairs","crosshairList","actor","actors","hardwareSelector"]),function(e,t){t.classHierarchy.push("vtkInteractorStyle3DCrosshairs");var n=Object.assign({},e),r=new _s(0,0,0,0);e.setCrosshairs(r),e.moveCrosshairs=function(n){var r=t.apis[t.apiIndex],a=n.position,i=r.genericRenderWindow.getRenderer(),o=e.getHardwareSelector();if(o.captureBuffers()){var s=o.generateSelection(a.x,a.y,a.x,a.y);o.releasePixBuffers(),i.getRenderWindow().render();var c=s[0].getProperties().worldPosition;t.apis.forEach((function(e,t){e.genericRenderWindow.getRenderWindow().getInteractor().getInteractorStyle().updateCrosshairs(c)}))}},e.updateCrosshairs=function(t){var n;(n=e.getCrosshairs()).setPoint.apply(n,h()(t)),e.getApis()[e.getApiIndex()].genericRenderWindow.getRenderWindow().render()},e.setActor=function(r){n.setActor(r);var a=t.interactor.getCurrentRenderer(),i=r.getBounds(),o=2*Math.max(Math.abs(i[1]-i[0]),Math.abs(i[3]-i[2]),Math.abs(i[5]-i[4])),s=r.getCenter(),c=e.getCrosshairs();c.actors.forEach(a.addActor),c.setPoint.apply(c,h()(s)),c.setWidth(o)},e.onConfigSet=function(){var r=e.getApis(),a=e.getApiIndex();n.setActors(r[a].actors);var i=t.apis[t.apiIndex],o=i.genericRenderWindow.getRenderer(),s=i.genericRenderWindow.getOpenGLRenderWindow(),c=s.getSize(),u=Ys.a.newInstance({captureZValues:!0});u.setFieldAssociation(0),u.attach(s,o),u.setArea.apply(u,[0,0].concat(h()(c))),e.setHardwareSelector(u)},e.setApis=function(t){n.setApis(t),e.getApiIndex()&&e.onConfigSet()},e.setApiIndex=function(t){n.setApiIndex(t),e.getApis()&&e.onConfigSet()},e.handleLeftButtonPress=function(r){r.shiftKey||r.altKey||r.controlKey?n.handleLeftButtonPress(r):(e.moveCrosshairs(r),t.movingCrosshairs=!0)},e.handleLeftButtonRelease=function(e){t.movingCrosshairs=!1,n.handleLeftButtonRelease(e)},e.handleMouseMove=function(r){r.shiftKey||r.altKey||r.controlKey||!t.movingCrosshairs?n.handleMouseMove(r):e.moveCrosshairs(r)},e.toggleCrosshairs=function(){var n=e.getCrosshairs(),r=t.interactor.getCurrentRenderer();n.actors.forEach((function(e,t){r.getActors().includes(e)?r.removeActor(e):r.addActor(e)})),r.getRenderWindow().render()},e.toggleCrosshairSlices=function(){var e=t.interactor.getCurrentRenderer();t.apis.forEach((function(t,n){if("VIEW2D"==t.type){var r=t.actors[0];e.getActors().includes(r)?e.removeActor(r):e.addActor(r)}})),e.getRenderWindow().render()},e.handleRightButtonPress=n.handleLeftButtonPress,e.handleRightButtonRelease=n.handleLeftButtonRelease}(e,t)}var Xs={newInstance:U.a.newInstance(Ks,"vtkInteractorStyle3DCrosshairs"),extend:Ks},Zs=ae.a.States;var Js={};function $s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,Js,n),ds.a.extend(e,t,n),U.a.setGet(e,t,["apis","apiIndex","crosshairs","imageActor","actors"]),function(e,t){t.classHierarchy.push("vtkInteractorStyle2DCrosshairs");var n=Object.assign({},e),r=new _s(0,0,0,0);e.setCrosshairs(r),e.moveCrosshairs=function(n){var r=t.apis[t.apiIndex],a=n.position,i=ne.a.newInstance();i.setCoordinateSystemToDisplay(),i.setValue(a.x,a.y,a.z);var o=i.getComputedWorldValue(r.genericRenderWindow.getRenderer()),s=e.getImageActor().getMapper(),c=s.getSlicingMode();o[c]=s.getBoundsForSlice(s.getSlice())[2*c],t.apis.forEach((function(e,t){e.genericRenderWindow.getRenderWindow().getInteractor().getInteractorStyle().updateCrosshairs(o)}))},e.updateCrosshairs=function(t){var n,r=h()(t),a=e.getApis()[e.getApiIndex()],i=e.getImageActor().getMapper(),o=i.getSliceAtPosition(r);i.setSlice(o),r[i.getSlicingMode()]+=1,(n=e.getCrosshairs()).setPoint.apply(n,h()(r)),a.genericRenderWindow.getRenderWindow().render()},e.setImageActor=function(r){n.setImageActor(r);var a=t.interactor.getCurrentRenderer(),i=r.getBounds(),o=2*Math.max(Math.abs(i[1]-i[0]),Math.abs(i[3]-i[2]),Math.abs(i[5]-i[4])),s=r.getCenter();s[r.getMapper().getSlicingMode()]+=1;var c=e.getCrosshairs();c.actors.forEach(a.addActor),c.setWidth(o),c.setPoint.apply(c,h()(s))},e.handleLeftButtonPress=function(r){r.shiftKey||r.altKey||r.controlKey?n.handleLeftButtonPress(r):(e.moveCrosshairs(r),t.movingCrosshairs=!0)},e.handleLeftButtonRelease=function(e){t.movingCrosshairs=!1,n.handleLeftButtonRelease(e)},e.handleRightButtonPress=function(n){t.previousPosition=n.position,e.startDolly()},e.handleRightButtonRelease=function(n){switch(t.state){case Zs.IS_PAN:e.endPan();break;default:e.endDolly()}},e.handleMouseMove=function(r){r.shiftKey||r.altKey||r.controlKey||!t.movingCrosshairs?n.handleMouseMove(r):e.moveCrosshairs(r)},e.handleMouseWheel=function(n){var r=e.getImageActor().getMapper(),a=r.getSlice()+n.spinY;r.setSlice(a);var i=[e.getCrosshairs().x,e.getCrosshairs().y,e.getCrosshairs().z],o=r.getSlicingMode();i[o]=r.getBoundsForSlice(r.getSlice())[2*o],t.apis.forEach((function(e,t){e.genericRenderWindow.getRenderWindow().getInteractor().getInteractorStyle().updateCrosshairs(i)}))},e.handleStartMouseWheel=function(){},e.handleEndMouseWheel=function(){},e.toggleCrosshairs=function(){var n=e.getCrosshairs(),r=t.interactor.getCurrentRenderer();n.actors.forEach((function(e,t){r.getActors().includes(e)?r.removeActor(e):r.addActor(e)})),r.getRenderWindow().render()}}(e,t)}var ec={newInstance:U.a.newInstance($s,"vtkInteractorStyle2DCrosshairs"),extend:$s};n.d(t,"View2D",(function(){return ro})),n.d(t,"View2DImageMapper",(function(){return Mo})),n.d(t,"View3D",(function(){return So})),n.d(t,"View3DSurfaceMC",(function(){return Wo})),n.d(t,"ViewportOverlay",(function(){return Vi})),n.d(t,"ViewportData",(function(){return Nr})),n.d(t,"VTKAxis",(function(){return _s})),n.d(t,"getImageData",(function(){return Ls})),n.d(t,"loadImageData",(function(){return Fs})),n.d(t,"vtkInteractorStyleMPRWindowLevel",(function(){return Oo})),n.d(t,"vtkInteractorStyleMPRCrosshairs",(function(){return Fo})),n.d(t,"vtkInteractorStyleRotatableMPRCrosshairs",(function(){return zo})),n.d(t,"vtkInteractorStyleCrosshairsImageMapper",(function(){return $o})),n.d(t,"vtkInteractorStyleMPRRotate",(function(){return as})),n.d(t,"vtkInteractorStyleMPRSlice",(function(){return Qr})),n.d(t,"vtkInteractorStyleImageWindowLevel",(function(){return cs})),n.d(t,"vtkInteractorStyleImagePanZoom",(function(){return fs})),n.d(t,"vtkInteractorStyle3D4UpCrosshairs",(function(){return Xs})),n.d(t,"vtkInteractorStyle2D4UpCrosshairs",(function(){return ec})),n.d(t,"vtkSVGWidgetManager",(function(){return aa})),n.d(t,"vtkSVGCrosshairsWidget",(function(){return bs})),n.d(t,"vtkSVGRotatableCrosshairsWidget",(function(){return Es})),n.d(t,"vtkSVGCrosshairsWidgetImageMapper",(function(){return xs})),n.d(t,"invertVolume",(function(){return Bs})),n.d(t,"EVENTS",(function(){return Lr}));t.default=ro}])}));
//# sourceMappingURL=index.umd.min.js.map